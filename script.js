function An(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function U(e){try{return localStorage.getItem(e)}catch(t){return null}}function Y(e,t){try{localStorage.setItem(e,t)}catch(n){}}function rt(e,t){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(function(){t&&(t.textContent="Copied!")}).catch(function(){Ce(e,t)}):Ce(e,t)}function Ce(e,t){var n=document.createElement("textarea");n.value=e,n.style.cssText="position:fixed;opacity:0",document.body.appendChild(n),n.select();try{document.execCommand("copy"),t&&(t.textContent="Copied!")}catch(a){}document.body.removeChild(n)}var Le=0;function Q(){Le=window.pageYOffset||document.documentElement.scrollTop,document.body.style.top=-Le+"px",document.body.classList.add("modal-open")}function D(){document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo(0,Le)}Object.assign(window,{safeGetItem:U,safeCopy:rt,fallbackCopy:Ce,unlockScroll:D});const it="rzp_test_1DP5mmOlF5G5ag",st="+919121004999",ct="AMOGHA CAFE & RESTAURANT",se=500,ce=49;var j=[{name:"Bronze",min:0,color:"#cd7f32",icon:"ü•â"},{name:"Silver",min:500,color:"#c0c0c0",icon:"ü•à"},{name:"Gold",min:1e3,color:"#D4A017",icon:"ü•á"}],Ne=[{days:[1,2,3,4,5],startHour:14,endHour:17,discount:15,label:"Happy Hour ‚Äî 15% OFF!",categories:["beverages"]},{days:[0,1,2,3,4,5,6],startHour:22,endHour:23,discount:20,label:"Late Night Deal ‚Äî 20% OFF!",categories:["all"]}],pe={Raita:40,"Mirchi ka Salan":50,"Veg Manchurian":169,"Paneer 65":189,"Chicken 65":200,"Chicken Hot Wings":220,"Veg Spring Rolls":149,"Chicken Lollipop":230,"Paneer Butter Masala":199,"Dal Tadka":149,"Butter Chicken":249,"Chicken Curry":219,"Mutton Curry":319,"Gongura Chicken":239,"Veg Dum Biryani":199,"Chicken Dum Biryani":249,"Chicken 65 Biryani":249,"Mutton Dum Biryani":349,"Egg Biryani":199,"Paneer Biryani":229,"Paneer Tikka":209,"Chicken Seekh Kebab":229,"Tandoori Chicken":269,"Mutton Seekh Kebab":289,"Veg Hakka Noodles":169,"Chicken Hakka Noodles":199,"Egg Noodles":179,"Schezwan Noodles":189,"Veg Fried Rice":169,"Chicken Fried Rice":199,"Egg Fried Rice":179,"Schezwan Fried Rice":189,"Butter Naan":40,"Garlic Naan":50,"Tandoori Roti":30,"Butter Roti":35,"Laccha Paratha":45,Tea:30,Coffee:40,"Hot Chocolate":60,Lassi:50,Buttermilk:35,"Fresh Lime Soda":45},Ae={en:{home:"Home",about:"About",menu:"Menu",specials:"Specials",gallery:"Gallery",reviews:"Reviews",contact:"Contact",signIn:"Sign In",orderNow:"Order Online",reserveTable:"Reserve Table",addToOrder:"Add to Order",yourOrder:"Your Order",clearCart:"Clear Cart",checkout:"Proceed to Checkout",orderSummary:"Order Summary",yourDetails:"Your Details",payment:"Payment",orderPlaced:"Order Placed!",thankYou:"Thank you! Your order has been received.",fullName:"Full Name",phoneNumber:"Phone Number",deliveryAddress:"Delivery Address",specialInstructions:"Special Instructions (Optional)",ourStory:"Our Story",whyChooseUs:"Why Choose Us?",ourMission:"Our Mission",search:"Search menu...",all:"All",veg:"Veg",nonVeg:"Non-Veg"},hi:{home:"‡§π‡•ã‡§Æ",about:"‡§π‡§Æ‡§æ‡§∞‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç",menu:"‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç",specials:"‡§∏‡•ç‡§™‡•á‡§∂‡§≤",gallery:"‡§ó‡•à‡§≤‡§∞‡•Ä",reviews:"‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ",contact:"‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï",signIn:"‡§∏‡§æ‡§á‡§® ‡§á‡§®",orderNow:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡§∞‡•á‡§Ç",reserveTable:"‡§ü‡•á‡§¨‡§≤ ‡§¨‡•Å‡§ï ‡§ï‡§∞‡•á‡§Ç",addToOrder:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",yourOrder:"‡§Ü‡§™‡§ï‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞",clearCart:"‡§ï‡§æ‡§∞‡•ç‡§ü ‡§ñ‡§æ‡§≤‡•Ä ‡§ï‡§∞‡•á‡§Ç",checkout:"‡§ö‡•á‡§ï‡§Ü‡§â‡§ü ‡§ï‡§∞‡•á‡§Ç",orderSummary:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂",yourDetails:"‡§Ü‡§™‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",payment:"‡§≠‡•Å‡§ó‡§§‡§æ‡§®",orderPlaced:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ!",thankYou:"‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! ‡§Ü‡§™‡§ï‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§Æ‡§ø‡§≤ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§",fullName:"‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ",phoneNumber:"‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞",deliveryAddress:"‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§™‡§§‡§æ",specialInstructions:"‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",ourStory:"‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ï‡§π‡§æ‡§®‡•Ä",whyChooseUs:"‡§π‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§ö‡•Å‡§®‡•á‡§Ç?",ourMission:"‡§π‡§Æ‡§æ‡§∞‡§æ ‡§Æ‡§ø‡§∂‡§®",search:"‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç ‡§ñ‡•ã‡§ú‡•á‡§Ç...",all:"‡§∏‡§≠‡•Ä",veg:"‡§∂‡§æ‡§ï‡§æ‡§π‡§æ‡§∞‡•Ä",nonVeg:"‡§Æ‡§æ‡§Ç‡§∏‡§æ‡§π‡§æ‡§∞‡•Ä"},te:{home:"‡∞π‡±ã‡∞Æ‡±ç",about:"‡∞Æ‡∞æ ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø",menu:"‡∞Æ‡±Ü‡∞®‡±Ç",specials:"‡∞∏‡±ç‡∞™‡±Ü‡∞∑‡∞≤‡±ç",gallery:"‡∞ó‡±ç‡∞Ø‡∞æ‡∞≤‡∞∞‡±Ä",reviews:"‡∞∏‡∞Æ‡±Ä‡∞ï‡±ç‡∞∑‡∞≤‡±Å",contact:"‡∞∏‡∞Ç‡∞™‡±ç‡∞∞‡∞¶‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø",signIn:"‡∞∏‡±à‡∞®‡±ç ‡∞á‡∞®‡±ç",orderNow:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",reserveTable:"‡∞ü‡±á‡∞¨‡±Å‡∞≤‡±ç ‡∞¨‡±Å‡∞ï‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",addToOrder:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç‚Äå‡∞≤‡±ã ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø",yourOrder:"‡∞Æ‡±Ä ‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç",clearCart:"‡∞ï‡∞æ‡∞∞‡±ç‡∞ü‡±ç ‡∞ñ‡∞æ‡∞≥‡±Ä ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",checkout:"‡∞ö‡±Ü‡∞ï‡±ç ‡∞Ö‡∞µ‡±Å‡∞ü‡±ç",orderSummary:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞∏‡∞æ‡∞∞‡∞æ‡∞Ç‡∞∂‡∞Ç",yourDetails:"‡∞Æ‡±Ä ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å",payment:"‡∞ö‡±Ü‡∞≤‡±ç‡∞≤‡∞ø‡∞Ç‡∞™‡±Å",orderPlaced:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞Ø‡∞ø‡∞Ç‡∞¶‡∞ø!",thankYou:"‡∞ß‡∞®‡±ç‡∞Ø‡∞µ‡∞æ‡∞¶‡∞æ‡∞≤‡±Å! ‡∞Æ‡±Ä ‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞Ö‡∞Ç‡∞¶‡∞ø‡∞Ç‡∞¶‡∞ø.",fullName:"‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞ø ‡∞™‡±á‡∞∞‡±Å",phoneNumber:"‡∞´‡±ã‡∞®‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç",deliveryAddress:"‡∞°‡±Ü‡∞≤‡∞ø‡∞µ‡∞∞‡±Ä ‡∞ö‡∞ø‡∞∞‡±Å‡∞®‡∞æ‡∞Æ‡∞æ",specialInstructions:"‡∞™‡±ç‡∞∞‡∞§‡±ç‡∞Ø‡±á‡∞ï ‡∞∏‡±Ç‡∞ö‡∞®‡∞≤‡±Å (‡∞ê‡∞ö‡±ç‡∞õ‡∞ø‡∞ï‡∞Ç)",ourStory:"‡∞Æ‡∞æ ‡∞ï‡∞•",whyChooseUs:"‡∞Æ‡∞Æ‡±ç‡∞Æ‡∞≤‡±ç‡∞®‡∞ø ‡∞é‡∞Ç‡∞¶‡±Å‡∞ï‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞µ‡∞æ‡∞≤‡∞ø?",ourMission:"‡∞Æ‡∞æ ‡∞≤‡∞ï‡±ç‡∞∑‡±ç‡∞Ø‡∞Ç",search:"‡∞Æ‡±Ü‡∞®‡±Ç ‡∞µ‡±Ü‡∞§‡∞ï‡∞Ç‡∞°‡∞ø...",all:"‡∞Ö‡∞®‡±ç‡∞®‡±Ä",veg:"‡∞∂‡∞æ‡∞ï‡∞æ‡∞π‡∞æ‡∞∞‡∞Ç",nonVeg:"‡∞Æ‡∞æ‡∞Ç‡∞∏‡∞æ‡∞π‡∞æ‡∞∞‡∞Ç"}},lt={"Chicken Dum Biryani":["Raita","Mirchi ka Salan","Buttermilk"],"Chicken 65 Biryani":["Raita","Mirchi ka Salan","Fresh Lime Soda"],"Veg Dum Biryani":["Raita","Dal Tadka","Lassi"],"Mutton Dum Biryani":["Raita","Mirchi ka Salan","Buttermilk"],"Egg Biryani":["Raita","Buttermilk"],"Paneer Biryani":["Raita","Dal Tadka"],"Butter Chicken":["Butter Naan","Garlic Naan","Laccha Paratha"],"Paneer Butter Masala":["Butter Naan","Garlic Naan","Tandoori Roti"],"Chicken Curry":["Butter Naan","Butter Roti","Veg Fried Rice"],"Mutton Curry":["Butter Naan","Laccha Paratha"],"Gongura Chicken":["Butter Naan","Tandoori Roti"],"Dal Tadka":["Butter Naan","Tandoori Roti","Veg Fried Rice"],"Chicken 65":["Chicken Dum Biryani","Fresh Lime Soda"],"Paneer 65":["Veg Dum Biryani","Lassi"],"Veg Manchurian":["Veg Hakka Noodles","Veg Fried Rice"],"Chicken Hot Wings":["Fresh Lime Soda","Chicken Hakka Noodles"],"Chicken Lollipop":["Chicken Dum Biryani","Fresh Lime Soda"],"Veg Hakka Noodles":["Veg Manchurian","Veg Spring Rolls"],"Chicken Hakka Noodles":["Chicken 65","Fresh Lime Soda"]};function M(){return window.db}function N(){try{const e=U("amoghaUser");return e?JSON.parse(e):null}catch(e){return null}}function Z(e){Y("amoghaUser",JSON.stringify(e));var t=M();e&&e.phone&&typeof t<"u"&&t&&!window._notifListenerActive&&(window._notifListenerActive=!0,t.collection("notifications").where("userPhone","==",e.phone).where("read","==",!1).onSnapshot(function(n){n.docChanges().forEach(function(a){if(a.type==="added"){var r=a.doc.data();typeof sendPushNotification=="function"&&sendPushNotification(r.title,r.body),a.doc.ref.update({read:!0})}})},function(n){console.error("Notification listener error:",n)}))}function dt(){const e=N();if(e){confirm("Signed in as "+(e.name||"Guest")+"\n\nDo you want to sign out?")&&Oe();return}document.getElementById("auth-modal").style.display="block",Q(),qe("signup")}function K(){document.getElementById("auth-modal").style.display="none",D(),document.getElementById("signup-name").value="",document.getElementById("signup-phone").value="",document.getElementById("signup-password").value="",document.getElementById("signin-phone").value="",document.getElementById("signin-password").value="",document.getElementById("signup-msg").textContent="",document.getElementById("signup-msg").className="auth-msg",document.getElementById("signin-msg").textContent="",document.getElementById("signin-msg").className="auth-msg",document.getElementById("forgot-phone").value="",document.getElementById("forgot-name").value="",document.getElementById("forgot-new-password").value="",document.getElementById("forgot-confirm-password").value="",document.getElementById("forgot-msg").textContent="",document.getElementById("forgot-msg").className="auth-msg",document.getElementById("forgot-step-1").style.display="",document.getElementById("forgot-step-2").style.display="none",ye=null}function qe(e){document.querySelectorAll(".auth-view").forEach(t=>t.classList.remove("active")),document.getElementById("auth-"+e).classList.add("active")}function ut(){var e=document.getElementById("signup-name").value.trim(),t=document.getElementById("signup-phone").value.trim(),n=document.getElementById("signup-password").value,a=document.getElementById("signup-msg");if(!e){a.textContent="Please enter your name.",a.className="auth-msg error";return}if(!/^\d{10}$/.test(t)){a.textContent="Please enter a valid 10-digit phone number.",a.className="auth-msg error";return}if(!/^\d{4}$/.test(n)){a.textContent="Please enter a 4-digit PIN.",a.className="auth-msg error";return}a.textContent="Creating account...",a.className="auth-msg";var r=M();if(typeof r>"u"||!r){a.textContent="Service unavailable. Please refresh and try again.",a.className="auth-msg error";return}r.collection("users").doc(t).get().then(function(o){if(o.exists){a.textContent="This phone number is already registered. Please sign in.",a.className="auth-msg error";return}var i={name:e,phone:t,pin:n,usedWelcomeBonus:!1,createdAt:new Date().toISOString()};return r.collection("users").doc(t).set(i).then(function(){try{Z(i),he(i),ue(),K(),B("Welcome, "+(e||"Guest")+"! 25% off applied to your first order!");var s=document.getElementById("signup-referral"),l=s?s.value.trim():"";l&&setTimeout(function(){typeof applyReferralAtSignup=="function"&&applyReferralAtSignup(l)},2e3)}catch(c){console.error("SignUp UI error:",c),K(),B("Account created successfully!")}})}).catch(function(o){console.error("SignUp error:",o);var i=o.code==="permission-denied"?"Access denied. Please contact support.":"Connection error. Please check your internet and try again.";a.textContent=i+" ("+(o.code||o.message||"unknown")+")",a.className="auth-msg error"})}function mt(){var e=document.getElementById("signin-phone").value.trim(),t=document.getElementById("signin-password").value,n=document.getElementById("signin-msg");if(!/^\d{10}$/.test(e)){n.textContent="Please enter a valid 10-digit phone number.",n.className="auth-msg error";return}if(!/^\d{4}$/.test(t)){n.textContent="Please enter your 4-digit PIN.",n.className="auth-msg error";return}n.textContent="Signing in...",n.className="auth-msg";var a=M();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(e).get().then(function(r){if(!r.exists){n.textContent="No account found with this number. Please sign up.",n.className="auth-msg error";return}var o=r.data();if((o.pin||o.password)!==t){n.textContent="Incorrect PIN. Please try again.",n.className="auth-msg error";return}try{Z(o),he(o),ue(),K();var i=o.name||"Guest",s=o.usedWelcomeBonus?"":" Your 25% welcome bonus is still active!";B("Welcome back, "+i+"!"+s)}catch(l){console.error("SignIn UI error:",l),K(),B("Signed in successfully!")}}).catch(function(r){console.error("SignIn error:",r),n.textContent="Connection error. Please check your internet and try again.",n.className="auth-msg error"})}var ye=null;function ft(){var e=document.getElementById("forgot-phone").value.trim(),t=document.getElementById("forgot-name").value.trim(),n=document.getElementById("forgot-msg");if(!/^\d{10}$/.test(e)){n.textContent="Please enter a valid 10-digit phone number.",n.className="auth-msg error";return}if(!t){n.textContent="Please enter your registered name.",n.className="auth-msg error";return}n.textContent="Verifying...",n.className="auth-msg";var a=M();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(e).get().then(function(r){if(!r.exists){n.textContent="No account found with this phone number.",n.className="auth-msg error";return}var o=r.data();if(o.name.toLowerCase()!==t.toLowerCase()){n.textContent="Name does not match our records.",n.className="auth-msg error";return}ye=e,n.textContent="",n.className="auth-msg",document.getElementById("forgot-step-1").style.display="none",document.getElementById("forgot-step-2").style.display="block"}).catch(function(r){console.error("Forgot password error:",r),n.textContent=r.code==="permission-denied"?"Access denied. Please contact support.":"Network error. Please check your connection and try again.",n.className="auth-msg error"})}function vt(){var e=document.getElementById("forgot-new-password").value,t=document.getElementById("forgot-confirm-password").value,n=document.getElementById("forgot-msg");if(!/^\d{4}$/.test(e)){n.textContent="Please enter a 4-digit PIN.",n.className="auth-msg error";return}if(e!==t){n.textContent="PINs do not match.",n.className="auth-msg error";return}n.textContent="Resetting PIN...",n.className="auth-msg";var a=M();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(ye).update({pin:e}).then(function(){ye=null,n.textContent="",n.className="auth-msg",K(),B("PIN reset successful! Please sign in.")}).catch(function(){n.textContent="Something went wrong. Please try again.",n.className="auth-msg error"})}function Oe(){try{localStorage.removeItem("amoghaUser")}catch(t){}const e=document.getElementById("signin-btn");e.className="signin-nav-btn",e.innerHTML='<svg class="signin-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg><span id="signin-text">Sign In</span>',ue(),typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget(),B("You have been signed out.")}function he(e){const t=document.getElementById("signin-btn");if(!(!t||!e)){var n=e.name||"Guest",a=n.split(" ").filter(function(r){return r.length>0}).map(function(r){return r[0]}).join("").toUpperCase().slice(0,2)||"G";t.className="signin-nav-btn signed-in",t.innerHTML='<span class="user-avatar">'+a+'</span><span id="signin-text">'+n.split(" ")[0]+"</span>",typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget()}}function pt(e,t){var n=document.getElementById(e),a=t.querySelector(".eye-open"),r=t.querySelector(".eye-closed");n.type==="password"?(n.type="text",a.style.display="none",r.style.display=""):(n.type="password",a.style.display="",r.style.display="none")}function B(e){var t=document.getElementById("auth-toast");t||(t=document.createElement("div"),t.id="auth-toast",document.body.appendChild(t)),t.textContent=e,t.classList.remove("visible"),t.offsetWidth,t.classList.add("visible"),setTimeout(function(){t.classList.remove("visible")},4e3)}function ue(){var e=document.getElementById("carousel-greeting");if(e){var t=N();t&&t.name?e.textContent="Hey "+t.name.split(" ")[0]+", ":e.textContent=""}}function yt(){try{const e=U("amoghaUser");e&&he(JSON.parse(e)),ue()}catch(e){console.error("Auth restore error:",e)}window.addEventListener("click",function(e){var t=document.getElementById("auth-modal");e.target===t&&K()}),setTimeout(function(){var e=document.getElementById("signup-form");if(!(!e||e.dataset.refEnhanced==="true")){e.dataset.refEnhanced="true";var t=e.querySelector(".password-field");if(t){var n=document.createElement("input");n.type="text",n.id="signup-referral",n.placeholder="Referral Code (Optional)",n.maxLength=20,n.style.textTransform="uppercase",t.after(n)}}},1e3),setTimeout(function(){var e=document.getElementById("signin-btn");if(e){var t=document.createElement("div");t.id="user-dropdown",t.className="user-dropdown",t.innerHTML='<button onclick="openMyOrders(); closeUserDropdown();">My Orders</button><button onclick="openReferralModal(); closeUserDropdown();">Refer a Friend</button><button onclick="openLoyaltyModal(); closeUserDropdown();">Loyalty Points</button><button onclick="openAuthModal(); closeUserDropdown();">Sign Out</button>',e.parentElement.style.position="relative",e.parentElement.appendChild(t),e.addEventListener("click",function(n){var a=N();a&&(n.preventDefault(),n.stopPropagation(),t.classList.toggle("visible"))}),document.addEventListener("click",function(n){e.parentElement.contains(n.target)||t.classList.remove("visible")})}},1e3)}function gt(){var e=document.getElementById("user-dropdown");e&&e.classList.remove("visible")}Object.assign(window,{openAuthModal:dt,closeAuthModal:K,switchAuthView:qe,handleSignUp:ut,handleSignIn:mt,handleForgotPassword:ft,handleResetPassword:vt,signOut:Oe,updateSignInUI:he,togglePassword:pt,showAuthToast:B,updateCarouselGreeting:ue,closeUserDropdown:gt});let L=[];var ae=[];function ht(){try{var e=localStorage.getItem("addons_cache");if(e){var t=JSON.parse(e);if(t.ts&&Date.now()-t.ts<6e5&&t.data){ae.push(...t.data);return}}}catch(a){}var n=M();n&&n.collection("addons").where("active","==",!0).orderBy("sortOrder").get().then(function(a){a.forEach(function(r){ae.push(r.data())});try{localStorage.setItem("addons_cache",JSON.stringify({ts:Date.now(),data:ae}))}catch(r){}}).catch(function(){})}var _=null,$=[];function bt(){try{const t=U("amoghaCart");if(t){var e=JSON.parse(t);L.length=0,e.forEach(function(n){L.push(n)}),X()}}catch(t){L.length=0}}function ee(){Y("amoghaCart",JSON.stringify(L))}function X(){const e=L.reduce((n,a)=>n+a.quantity,0);var t=document.getElementById("cart-count");t&&(t.textContent=e)}function ie(e,t,n){L.length===0&&!N()&&xt();var a="medium";if(n){var r=n.closest(".menu-item-card");if(r){var o=r.querySelector(".spice-level.active");o&&(a=o.textContent.trim().toLowerCase())}}if(ae.length>0){_={name:e,price:parseFloat(t),spiceLevel:a,btnEl:n},$.length=0,wt(e,parseFloat(t));return}Ie(e,parseFloat(t),a,[])}function Ie(e,t,n,a){var r=a.map(function(i){return i.name}).sort().join(","),o=L.find(function(i){var s=(i.addons||[]).map(function(l){return l.name}).sort().join(",");return i.name===e&&i.spiceLevel===n&&s===r});o?o.quantity++:L.push({name:e,price:t,quantity:1,spiceLevel:n,addons:a||[]}),X(),ee(),te(e),ne()}function wt(e,t){var n=document.getElementById("addon-picker-overlay"),a=document.getElementById("addon-item-name"),r=document.getElementById("addon-sheet-list");a.textContent=e+" ‚Äî ‚Çπ"+t,r.innerHTML=ae.map(function(o,i){return'<div class="addon-option" data-idx="'+i+'" onclick="toggleAddonOption(this, '+i+')"><div class="addon-checkbox"></div><div class="addon-option-info"><div class="addon-option-name">'+o.name+'</div><div class="addon-option-cat">'+(o.category||"")+'</div></div><div class="addon-option-price">+‚Çπ'+o.price+"</div></div>"}).join(""),Re(),n.style.display="flex"}function Et(e,t){e.classList.toggle("selected");var n=ae[t],a=e.querySelector(".addon-checkbox");if(e.classList.contains("selected"))$.push({name:n.name,price:n.price}),a.textContent="‚úì";else{var r=$.findIndex(function(o){return o.name===n.name});r!==-1&&$.splice(r,1),a.textContent=""}Re()}function Re(){if(_){var e=$.reduce(function(n,a){return n+a.price},0),t=_.price+e;document.getElementById("addon-total").textContent="Total: ‚Çπ"+t}}function Ct(){document.getElementById("addon-picker-overlay").style.display="none",_&&(Ie(_.name,_.price,_.spiceLevel,[]),_=null,$.length=0)}function Lt(){if(_){var e=_,t=$.slice();_=null,$.length=0,document.getElementById("addon-picker-overlay").style.display="none",Ie(e.name,e.price,e.spiceLevel,t)}}function It(e){var t=e.closest(".add-to-cart")||e,n=document.createElement("span");n.className="atc-checkmark",n.textContent="‚úì",t.appendChild(n),setTimeout(function(){n.remove()},800)}function xt(){var e=document.getElementById("signin-prompt");e||(e=document.createElement("div"),e.id="signin-prompt",e.innerHTML='<div class="signin-prompt-content"><span class="signin-prompt-icon">üéâ</span><div class="signin-prompt-text"><strong>Sign up & get 25% OFF!</strong><span>Create an account to unlock your welcome bonus</span></div><button class="signin-prompt-btn" onclick="closeSignInPrompt(); openAuthModal();">Sign Up</button><button class="signin-prompt-close" onclick="closeSignInPrompt()">&times;</button></div>',document.body.appendChild(e)),e.classList.remove("visible"),e.offsetWidth,e.classList.add("visible"),setTimeout(function(){De()},8e3)}function De(){var e=document.getElementById("signin-prompt");e&&e.classList.remove("visible")}function te(e){document.querySelectorAll(".add-to-cart").forEach(t=>{if(t.dataset.item===e){const n=L.find(r=>r.name===e),a=n?n.quantity:0;a>0&&!t.classList.contains("has-qty")?(t.classList.add("has-qty"),t.innerHTML='<span class="qty-minus" data-item="'.concat(e,'">‚àí</span><span class="qty-count">').concat(a,'</span><span class="qty-plus" data-item="').concat(e,'">+</span>')):a>0?t.querySelector(".qty-count").textContent=a:(t.classList.remove("has-qty"),t.innerHTML="Add to Order")}})}function Bt(){L.forEach(e=>te(e.name))}function ne(){let e=document.getElementById("floating-cart");e||(e=document.createElement("div"),e.id="floating-cart",e.innerHTML='\n            <div class="fc-header">\n                <span class="fc-title">Your Order</span>\n                <span class="fc-close" onclick="closeFloatingCart()">&times;</span>\n            </div>\n            <div class="fc-items"></div>\n            <div class="fc-footer">\n                <span class="fc-total"></span>\n                <button class="fc-checkout" onclick="document.getElementById(\'cart-icon\').click(); closeFloatingCart();">View Cart</button>\n            </div>\n        ',document.body.appendChild(e));const t=e.querySelector(".fc-items"),n=e.querySelector(".fc-total");if(L.length===0){e.classList.remove("visible"),ge();return}let a="",r=0;L.forEach(o=>{const i=o.price*o.quantity;r+=i,a+='<div class="fc-item"><span>'.concat(o.name," x").concat(o.quantity,"</span><span>‚Çπ").concat(i,"</span></div>")}),t.innerHTML=a,n.textContent="Total: ‚Çπ".concat(r),e.classList.add("visible"),ge()}function ge(e){var t=document.getElementById("cart-fab");t||(t=document.createElement("div"),t.id="cart-fab",t.className="cart-fab",t.innerHTML='<svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg><span class="cart-fab-badge">0</span>',t.addEventListener("click",function(){var r=document.getElementById("cart-icon");r&&r.click()}),document.body.appendChild(t));var n=t.querySelector(".cart-fab-badge"),a=L.reduce(function(r,o){return r+o.quantity},0);a>0?(n.textContent=a,t.classList.add("visible"),t.classList.remove("pop"),t.offsetWidth,t.classList.add("pop")):t.classList.remove("visible")}function St(){const e=document.getElementById("floating-cart");e&&e.classList.remove("visible")}function me(){const e=document.getElementById("cart-items");if(!e)return;if(L.length===0){e.innerHTML='<div class="empty-cart">Your cart is empty</div>';var t=document.getElementById("subtotal-amount"),n=document.getElementById("total-amount");t&&(t.textContent="0.00"),n&&(n.textContent="0.00");return}let a="",r=0;L.forEach((c,f)=>{const g=(c.addons||[]).reduce((x,k)=>x+k.price,0),h=(c.price+g)*c.quantity;r+=h;const C=c.spiceLevel&&c.spiceLevel!=="medium"?' <span style="font-size:0.7rem;color:#e67e22">('+c.spiceLevel+")</span>":"",w=(c.addons||[]).map(x=>'<span style="font-size:0.7rem;color:var(--gold,#D4A017)">+ '+x.name+" ‚Çπ"+x.price+"</span>").join(" ");a+='\n            <div class="cart-item">\n                <div class="cart-item-info">\n                    <div class="cart-item-name">'.concat(c.name).concat(C,"</div>\n                    ").concat(w?'<div style="margin-top:2px">'+w+"</div>":"",'\n                    <div class="cart-item-price">‚Çπ').concat((c.price+g).toFixed(2),'</div>\n                </div>\n                <div class="cart-item-quantity">\n                    <button class="qty-btn" onclick="updateQuantity(').concat(f,', -1)">-</button>\n                    <span>').concat(c.quantity,'</span>\n                    <button class="qty-btn" onclick="updateQuantity(').concat(f,', 1)">+</button>\n                </div>\n                <button class="remove-item" onclick="removeItem(').concat(f,')">Remove</button>\n            </div>\n        ')}),e.innerHTML=a;const o=r>=se?0:ce,i=r+o;var s=document.getElementById("subtotal-amount"),l=document.getElementById("total-amount");s&&(s.textContent=r.toFixed(2)),l&&(l.textContent=i.toFixed(2))}function kt(e,t){const n=L[e].name;L[e].quantity+=t,L[e].quantity<=0&&L.splice(e,1),X(),ee(),me(),te(n),ne()}function Mt(e){const t=L[e].name;L.splice(e,1),X(),ee(),me(),te(t),ne()}function He(){if(confirm("Are you sure you want to clear your cart?")){const e=L.map(t=>t.name);L.length=0,X(),ee(),me(),e.forEach(t=>te(t)),ne(),document.getElementById("cart-modal").style.display="none",D()}}function Tt(){var e=document.getElementById("cart-icon"),t=document.getElementById("cart-modal");e&&e.addEventListener("click",o=>{o.preventDefault(),me(),t&&(t.style.display="block"),Q()});var n=document.querySelectorAll(".close");n.forEach(o=>{o.addEventListener("click",()=>{if(!o.closest("#auth-modal")){t&&(t.style.display="none");var i=document.getElementById("reservation-modal");i&&(i.style.display="none"),D()}})}),window.addEventListener("click",o=>{o.target===t&&(t.style.display="none",D()),o.target===document.getElementById("reservation-modal")&&(document.getElementById("reservation-modal").style.display="none",D())}),document.addEventListener("click",o=>{if(o.target.classList.contains("qty-plus")){const i=o.target.dataset.item,s=o.target.closest(".add-to-cart");ie(i,s.dataset.price);return}if(o.target.classList.contains("qty-minus")){const i=o.target.dataset.item,s=L.find(l=>l.name===i);s&&(s.quantity--,s.quantity<=0&&L.splice(L.indexOf(s),1),X(),ee(),te(i),ne());return}if(o.target.classList.contains("add-to-cart")&&!o.target.classList.contains("has-qty")){const i=o.target.dataset.item,s=o.target.dataset.price;ie(i,s),It(o.target)}});var a=document.getElementById("clear-cart");a&&a.addEventListener("click",He);var r=document.getElementById("checkout");r&&r.addEventListener("click",function(){typeof window.checkout=="function"&&window.checkout()})}Object.assign(window,{addToCart:ie,updateQuantity:kt,removeItem:Mt,clearCart:He,closeAddonPicker:Ct,toggleAddonOption:Et,confirmAddonSelection:Lt,closeFloatingCart:St,closeSignInPrompt:De});var T=null,R=null,Fe=500;function xe(){var e=L.reduce(function(o,i){return o+i.price*i.quantity},0),t=e>=se?0:ce,n=0,a=e+t;if(T&&(T.type==="percent"?n=Math.floor(e*T.discount/100):T.type==="flat"&&(n=T.discount),n=Math.min(n,e),a=e-n+t),R&&R.balance>0){var r=Math.min(R.balance,a);a=Math.max(0,a-r)}return{subtotal:e,deliveryFee:t,discount:n,total:a}}function Nt(e,t){return e?e.active?e.expiresAt&&new Date(e.expiresAt)<new Date?{valid:!1,reason:"This coupon has expired."}:e.usageLimit&&e.usedCount>=e.usageLimit?{valid:!1,reason:"This coupon has reached its usage limit."}:e.minOrder&&t<e.minOrder?{valid:!1,reason:"Minimum order ‚Çπ"+e.minOrder+" required."}:{valid:!0}:{valid:!1,reason:"This coupon is no longer active."}:{valid:!1,reason:"No coupon"}}function _e(e,t){if(!e)return 0;var n=e.type==="percent"?t*e.discount/100:e.discount;return e.maxDiscount&&e.type==="percent"&&(n=Math.min(n,e.maxDiscount)),n=Math.min(n,t),n}function At(){if(L.length===0){B("Your cart is empty!");return}if(!N()){document.getElementById("cart-modal").style.display="none",D(),typeof window.openAuthModal=="function"&&window.openAuthModal(),B("Please sign in to continue with your order");return}document.getElementById("cart-modal").style.display="none",Q(),Ue()}function Ue(){var e=L.reduce(function(h,C){return h+C.price*C.quantity},0),t=e>=se?0:ce,n=e+t,a="";L.forEach(function(h){a+='<div class="co-item"><span>'+h.name+" x"+h.quantity+"</span><span>‚Çπ"+h.price*h.quantity+"</span></div>"}),document.getElementById("checkout-items").innerHTML=a,document.getElementById("co-subtotal").textContent="‚Çπ"+e,document.getElementById("co-delivery").textContent=t===0?"FREE":"‚Çπ"+t,document.getElementById("co-total").textContent="‚Çπ"+n;var r=document.getElementById("loyalty-redeem-btn");if(r){var o=N();if(o&&o.loyaltyPoints>=100){var i=Math.floor(o.loyaltyPoints/100)*10;r.textContent="Redeem "+o.loyaltyPoints+" pts (‚Çπ"+i+" off)",r.style.display="block"}else r.style.display="none"}be(1),document.getElementById("checkout-modal").style.display="block";var s=N(),l=document.getElementById("coupon-code"),c=document.getElementById("coupon-msg");if(s&&!s.usedWelcomeBonus){T={discount:25,type:"percent",label:"25% off (Welcome Bonus!)"},l.value="WELCOME25",c.textContent="Welcome bonus applied! You get 25% off!",c.className="coupon-msg success";var f=e*.25;f=Math.min(f,e);var g=e-f+t;document.getElementById("co-total").textContent="‚Çπ"+g.toFixed(0)}else T=null,l.value="",c.textContent="",c.className="coupon-msg"}function Pt(){document.getElementById("checkout-modal").style.display="none",D(),document.getElementById("co-name").value="",document.getElementById("co-phone").value="",document.getElementById("co-address").value="",document.getElementById("co-notes").value=""}function be(e){document.querySelectorAll(".checkout-step").forEach(function(t){t.classList.remove("active")}),document.getElementById("checkout-step-"+e).classList.add("active"),e===3&&we()}function we(){var e=xe(),t=e.total,n="‚Çπ"+t.toFixed(0);document.getElementById("pay-total").textContent=n;var a=document.getElementById("cod-total");a&&(a.textContent=n),We("razorpay")}function We(e){["razorpay","cod"].forEach(function(t){var n=document.getElementById("tab-"+t),a=document.getElementById("pay-panel-"+t);n&&n.classList.toggle("active",t===e),a&&a.classList.toggle("active",t===e)})}function qt(){var e=document.getElementById("co-name").value.trim(),t=document.getElementById("co-phone").value.trim(),n=document.getElementById("co-address").value.trim();if(!e||!t||!n){B("Please fill in all required fields.");return}if(t.length<10){B("Please enter a valid phone number.");return}var a=window.getScheduleInfo?window.getScheduleInfo():null;if(a&&(!a.date||!a.time)){B("Please select both date and time for scheduled order.");return}be(3)}function Ot(){if(typeof Razorpay>"u"){B("Payment gateway loading... please try again");return}var e=xe(),t=document.getElementById("co-name").value.trim(),n=document.getElementById("co-phone").value.trim(),a={key:it,amount:Math.round(e.total*100),currency:"INR",name:ct,description:"Food Order - Amogha Cafe",image:window.location.origin+"/amogha-logo.png",handler:function(i){var s=i.razorpay_payment_id;Be("Razorpay",s,"paid")},prefill:{name:t,contact:n,method:"upi"},method:{upi:!0,card:!0,netbanking:!0,wallet:!0},config:{display:{blocks:{upi:{name:"Pay via UPI",instruments:[{method:"upi",flows:["qrcode","collect","intent"]}]}},sequence:["block.upi"],preferences:{show_default_blocks:!0}}},notes:{items:L.map(function(i){return i.name+" x"+i.quantity}).join(", ")},theme:{color:"#D4A017",backdrop_color:"rgba(8,6,4,0.85)"},modal:{ondismiss:function(){var i=document.getElementById("razorpay-pay-btn");i&&(i.disabled=!1,i.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Pay Now')}}},r=document.getElementById("razorpay-pay-btn");r&&(r.disabled=!0,r.innerHTML="Opening payment...");try{var o=new Razorpay(a);o.on("payment.failed",function(i){B("Payment failed: "+(i.error.description||"Please try again"));var s=document.getElementById("razorpay-pay-btn");s&&(s.disabled=!1,s.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Retry Payment')}),o.open()}catch(i){B("Error opening payment: "+i.message),r&&(r.disabled=!1,r.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Pay Now')}}function Rt(){Be("Cash on Delivery",null,"cod-pending")}function Be(e,t,n){var a=M();if(typeof a>"u"||!a){B("Service unavailable. Please refresh and try again.");return}var r=document.getElementById("co-name").value.trim(),o=document.getElementById("co-phone").value.trim(),i=document.getElementById("co-address").value.trim(),s=document.getElementById("co-notes").value.trim(),l=xe();document.getElementById("confirm-detail").textContent="Payment: "+e+(t?" (Ref: "+t+")":"")+" | Total: ‚Çπ"+l.total.toFixed(0);var c="*New Order - Amogha Cafe*\n\n";c+="*Customer:* "+r+"\n*Phone:* "+o+"\n*Address:* "+i+"\n",s&&(c+="*Notes:* "+s+"\n"),c+="\n*Items:*\n",L.forEach(function(w){c+="- "+w.name+" x"+w.quantity+" = ‚Çπ"+w.price*w.quantity+"\n"}),c+="\n*Subtotal:* ‚Çπ"+l.subtotal,c+="\n*Delivery:* "+(l.deliveryFee===0?"FREE":"‚Çπ"+l.deliveryFee),c+="\n*Total:* ‚Çπ"+l.total.toFixed(0),c+="\n*Payment:* "+e,t&&(c+="\n*Payment Ref:* "+t);var f="https://wa.me/"+st+"?text="+encodeURIComponent(c);document.getElementById("whatsapp-link").href=f,be(4);var g=N(),h={customer:r,phone:o,address:i,notes:s,items:L.map(function(w){return{name:w.name,qty:w.quantity,price:w.price,spiceLevel:w.spiceLevel||"medium",addons:w.addons||[]}}),subtotal:l.subtotal,deliveryFee:l.deliveryFee,total:l.total,payment:e,paymentRef:t||null,paymentStatus:n,paymentVerifiedAt:t?new Date().toISOString():null,status:"pending",createdAt:new Date().toISOString(),userId:g?g.phone:null},C=L.map(function(w){return w.name});a.collection("orders").add(h).then(function(w){var x=window.location.origin+"/track/index.html?id="+w.id,k=document.getElementById("order-tracking-link");if(k&&(k.innerHTML='<div style="margin-top:1rem;padding:1rem;background:rgba(212,160,23,0.08);border:1px solid rgba(212,160,23,0.15);border-radius:12px;text-align:center"><p style="font-size:0.82rem;color:#a09080;margin-bottom:0.5rem">Track your order in real-time:</p><a href="'+x+'" target="_blank" rel="noopener noreferrer" style="color:#D4A017;font-weight:600;font-size:0.9rem;word-break:break-all">'+x+"</a><br><button onclick=\"safeCopy('"+x+'\',this)" style="margin-top:0.6rem;padding:0.4rem 1rem;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.78rem">Copy Link</button></div>'),g&&!g.usedWelcomeBonus&&T&&T.label&&T.label.indexOf("Welcome")!==-1&&(g.usedWelcomeBonus=!0,Z(g),a.collection("users").doc(g.phone).update({usedWelcomeBonus:!0}).catch(function(A){console.error("Bonus update error:",A)})),T=null,R&&R.code){var V=Math.min(R.balance,h.total);a.collection("giftCards").doc(R.code).update({balance:firebase.firestore.FieldValue.increment(-V),redeemedAt:new Date().toISOString()}).catch(function(A){console.error("Gift card deduction error:",A)}),R=null}L.length=0,X(),ee(),C.forEach(function(A){te(A)}),ne(),typeof launchConfetti=="function"&&launchConfetti(),typeof awardLoyaltyPoints=="function"&&awardLoyaltyPoints(h.total),g&&a&&a.collection("referrals").where("refereePhone","==",g.phone).where("redeemed","==",!1).limit(1).get().then(function(A){if(!A.empty){var W=A.docs[0],q=W.data().referrerPhone;a.collection("users").doc(q).get().then(function(H){if(H.exists){var J=(H.data().loyaltyPoints||0)+100;a.collection("users").doc(q).update({loyaltyPoints:J}).catch(function(d){console.error("Referrer points error:",d)})}}),W.ref.update({redeemed:!0}).catch(function(H){console.error("Referral redeem error:",H)})}}).catch(function(A){console.error("Referral lookup error:",A)}),typeof scheduleReviewPrompt=="function"&&scheduleReviewPrompt(h.items.map(function(A){return{name:A.name}})),typeof sendPushNotification=="function"&&sendPushNotification("Order Placed!","Your order from Amogha has been placed successfully.")}).catch(function(w){console.error("Order save error:",w),B("Order failed to save. Please try again or check your connection.")})}function Dt(){var e=document.getElementById("coupon-code"),t=document.getElementById("coupon-msg"),n=e.value.trim().toUpperCase(),a={AMOGHA20:{discount:20,type:"percent",label:"20% off"},WELCOME50:{discount:50,type:"flat",label:"‚Çπ50 off"},FIRST10:{discount:10,type:"percent",label:"10% off"},WELCOME25:{discount:25,type:"percent",label:"25% off (Welcome Bonus!)"}};function r(i){T=i,t.textContent="Coupon applied! "+i.label,t.className="coupon-msg success";var s=L.reduce((g,h)=>g+h.price*h.quantity,0),l=s>=se?0:ce,c=_e(i,s),f=s-c+l;document.getElementById("co-total").textContent="‚Çπ"+f.toFixed(0)}var o=M();o?o.collection("coupons").doc(n).get().then(function(i){if(i.exists){var s=i.data(),l=L.reduce((f,g)=>f+g.price*g.quantity,0),c=Nt(s,l);if(!c.valid){t.textContent=c.reason,t.className="coupon-msg error",T=null;return}r(s),o.collection("coupons").doc(n).update({usedCount:firebase.firestore.FieldValue.increment(1)})}else a[n]?r(a[n]):(T=null,t.textContent="Invalid coupon code. Please check and try again.",t.className="coupon-msg error")}).catch(function(){a[n]?r(a[n]):(T=null,t.textContent="Invalid coupon code.",t.className="coupon-msg error")}):a[n]?r(a[n]):(T=null,t.textContent="Invalid coupon code. Please check and try again.",t.className="coupon-msg error")}function Ht(){T=null;var e=document.getElementById("coupon-code"),t=document.getElementById("coupon-msg");e&&(e.value=""),t&&(t.textContent="",t.className="coupon-msg"),we()}function Ft(){var e=document.getElementById("giftcard-code"),t=document.getElementById("giftcard-msg"),n=e.value.trim().toUpperCase();if(!n){t.textContent="Please enter a gift card code",t.className="coupon-msg error";return}var a=M();if(!a){t.textContent="Service unavailable",t.className="coupon-msg error";return}a.collection("giftCards").doc(n).get().then(function(r){if(!r.exists){t.textContent="Invalid gift card code",t.className="coupon-msg error",R=null;return}var o=r.data();if(!o.active){t.textContent="This gift card is no longer active",t.className="coupon-msg error",R=null;return}if(o.balance<=0){t.textContent="This gift card has no remaining balance",t.className="coupon-msg error",R=null;return}R={code:n,balance:o.balance},t.textContent="Gift card applied! Balance: ‚Çπ"+o.balance,t.className="coupon-msg success";var i=L.reduce(function(h,C){return h+C.price*C.quantity},0),s=i>=se?0:ce,l=T?_e(T,i):0,c=i-l+s,f=Math.min(o.balance,c),g=c-f;document.getElementById("co-total").textContent="‚Çπ"+g.toFixed(0)}).catch(function(r){t.textContent="Error: "+r.message,t.className="coupon-msg error"})}function _t(){R=null;var e=document.getElementById("giftcard-code"),t=document.getElementById("giftcard-msg");e&&(e.value=""),t&&(t.textContent="",t.className="coupon-msg"),we()}function Ut(){document.getElementById("giftcard-modal").style.display="block",Q()}function Wt(){document.getElementById("giftcard-modal").style.display="none",D()}function Gt(e,t){Fe=e,document.querySelectorAll(".gc-amount-btn").forEach(function(n){n.classList.remove("active")}),t&&t.classList.add("active")}function Yt(){var e=document.getElementById("gc-recipient-phone").value.trim(),t=document.getElementById("gc-msg");if(!e||e.length!==10){t.textContent="Please enter a valid 10-digit phone number",t.className="coupon-msg error";return}var n=N(),a=n?n.phone:"guest",r=Fe,o="GC-"+Date.now().toString(36).toUpperCase().slice(-4)+"-"+Math.random().toString(36).toUpperCase().slice(2,6);if(typeof Razorpay>"u"){t.textContent="Payment system loading. Please try again.",t.className="coupon-msg error";return}var i=M(),s={key:"rzp_live_bfHYCYWDyoSHFn",amount:r*100,currency:"INR",name:"Amogha Cafe",description:"Gift Card - "+o,image:"https://amogha-cafe.web.app/amogha-logo.png",handler:function(c){i.collection("giftCards").doc(o).set({code:o,amount:r,balance:r,purchaserPhone:a,recipientPhone:e,paymentRef:c.razorpay_payment_id,active:!0,createdAt:new Date().toISOString()}).then(function(){t.textContent="Gift card "+o+" created successfully! Share this code with the recipient.",t.className="coupon-msg success",document.getElementById("gc-recipient-phone").value=""}).catch(function(f){t.textContent="Payment received but error saving: "+f.message,t.className="coupon-msg error"})},prefill:{name:n?n.name:"",contact:a},theme:{color:"#D4A017"}},l=new Razorpay(s);l.open()}function Vt(){var e=N();if(!(!e||!e.loyaltyPoints||e.loyaltyPoints<100)){var t=Math.floor(e.loyaltyPoints/100)*10,n=Math.floor(e.loyaltyPoints/100)*100,a=L.reduce(function(c,f){return c+f.price*f.quantity},0),r=Math.min(t,a);if(!(r<=0)){var o=a>=se?0:ce,i=a-r+o;T={discount:r,type:"flat",label:"Rs."+r+" (Loyalty Points)"},document.getElementById("co-total").textContent="Rs."+i.toFixed(0);var s=document.getElementById("coupon-msg");s.textContent="Redeemed "+n+" points for Rs."+r+" off!",s.className="coupon-msg success",document.getElementById("coupon-code").value="LOYALTY",e.loyaltyPoints-=n,Z(e);var l=M();l&&l.collection("users").doc(e.phone).update({loyaltyPoints:e.loyaltyPoints}).catch(function(c){console.error("Loyalty update error:",c)}),typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget()}}}Object.assign(window,{checkout:At,openCheckout:Ue,closeCheckout:Pt,goToStep:be,setupPayment:we,switchPayTab:We,validateAndPay:qt,openRazorpay:Ot,placeCodOrder:Rt,placeOrderToFirestore:Be,applyCoupon:Dt,removeCoupon:Ht,applyGiftCard:Ft,removeGiftCard:_t,openGiftCardModal:Ut,closeGiftCardModal:Wt,buyGiftCard:Yt,selectGcAmount:Gt,redeemLoyaltyAtCheckout:Vt});function fe(e,t,n,a,r,o){var i=M();if(!(typeof i>"u"||!i)){try{var s=localStorage.getItem(t);if(s){var l=JSON.parse(s);if(l.ts&&Date.now()-l.ts<n*1e3){r(l.data);return}}}catch(f){}var c=i.collection(e);o&&o.orderBy&&(c=c.orderBy(o.orderBy[0])),o&&o.where&&(c=c.where(o.where[0],o.where[1],o.where[2])),c.get().then(function(f){var g=a(f);r(g);try{localStorage.setItem(t,JSON.stringify({ts:Date.now(),data:g}))}catch(h){}}).catch(function(f){console.error("cachedGet "+e+" error:",f);try{var g=localStorage.getItem(t);g&&r(JSON.parse(g).data)}catch(h){}})}}function zt(){var e=M();if(!e)return;function t(r){document.querySelectorAll(".menu-item-card").forEach(function(o){var i=o.querySelector("h4");if(i){var s=i.textContent.replace(/Bestseller|Must Try|New/gi,"").trim(),l=r[s];if(l&&l.count>0){var c=(l.total/l.count).toFixed(1),f=o.querySelector(".item-rating");f&&f.remove();var g=document.createElement("div");g.className="item-rating",g.innerHTML='<span class="rating-stars">'+jt(parseFloat(c))+'</span><span class="rating-text">'+c+" ("+l.count+")</span>";var h=o.querySelector(".item-description");h&&h.after(g)}}})}try{var n=U("amoghaRatings");if(n){var a=JSON.parse(n);if(a.ts&&Date.now()-a.ts<6e5&&a.data){t(a.data);return}}}catch(r){}e.collection("reviews").get().then(function(r){var o={};r.forEach(function(i){var s=i.data();o[s.itemName]||(o[s.itemName]={total:0,count:0}),o[s.itemName].total+=s.rating,o[s.itemName].count++}),t(o),Y("amoghaRatings",JSON.stringify({ts:Date.now(),data:o}))}).catch(function(){try{var r=U("amoghaRatings");if(r){var o=JSON.parse(r);o.data&&t(o.data)}}catch(i){}})}function jt(e){for(var t="",n=1;n<=5;n++)n<=Math.floor(e)?t+='<span class="star filled">&#9733;</span>':n-.5<=e?t+='<span class="star half">&#9733;</span>':t+='<span class="star empty">&#9734;</span>';return t}function $t(e){var t=document.querySelector(".specials-grid");if(t){if(e.length===0){var n=t.closest(".specials");n&&(n.style.display="none");return}var n=t.closest(".specials");n&&(n.style.display=""),t.innerHTML=e.map(function(a){var r=a.available?"":" item-unavailable";return'<div class="special-card'+r+'" data-id="'+a.name+'"><div class="glow-border"></div><div class="special-badge">'+(a.badge||"Special")+"</div><h3>"+a.name+"</h3><p>"+(a.description||"")+'</p><div class="special-price"><span class="new-price">&#8377;'+a.price+'</span></div><button class="add-to-cart" data-item="'+a.name+'" data-price="'+a.price+'">Order Now</button></div>'}).join("")}}function Xt(){var e=M();if(!e)return;function t(i){var s=i.querySelector(".menu-item-img-wrap");if(s)return s;s=document.createElement("div"),s.className="menu-item-img-wrap";var l=document.createElement("img");l.className="menu-item-img",l.alt="",l.loading="lazy";var c=document.createElement("div");return c.className="menu-item-img-placeholder",c.innerHTML='<svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg><span>Image coming soon</span>',s.appendChild(l),s.appendChild(c),i.insertBefore(s,i.firstChild),s}e.collection("menu").onSnapshot(function(i){var s={};i.forEach(function(l){s[l.id]=l.data()}),document.querySelectorAll(".menu-item-card[data-id]").forEach(function(l){var c=l.dataset.id,f=s[c];if(!f){l.style.display="none";return}l.style.display="",f.available?(l.classList.remove("item-unavailable"),l.style.opacity="",l.style.pointerEvents="",l.style.filter=""):(l.classList.add("item-unavailable"),l.style.opacity="0.45",l.style.pointerEvents="none",l.style.filter="grayscale(0.3)");var g=l.querySelector(".add-to-cart");if(g&&f.price!==parseInt(g.dataset.price)){g.dataset.price=f.price;var h=l.querySelector(".price");h&&(h.innerHTML="&#8377;"+f.price)}var C=t(l),w=C.querySelector(".menu-item-img");f.imageUrl?(w.dataset.currentUrl!==f.imageUrl&&(w.dataset.currentUrl=f.imageUrl,w.src=f.imageUrl,w.onload=function(){w.classList.add("loaded"),C.classList.add("has-image")},w.onerror=function(){w.classList.remove("loaded"),C.classList.remove("has-image"),w.src=""}),l.dataset.imageUrl=f.imageUrl):(w.classList.remove("loaded"),C.classList.remove("has-image"),w.src="",w.dataset.currentUrl="",delete l.dataset.imageUrl)})},function(i){console.error("Menu listener error:",i)}),fe("specials","specials_cache",300,function(i){var s=[];return i.forEach(function(l){var c=l.data();c.id=l.id,s.push(c)}),s},$t,{orderBy:["sortOrder"]}),fe("heroSlides","heroSlides_cache",300,function(i){var s=[];return i.forEach(function(l){var c=l.data();c.active&&s.push(c)}),s},function(i){i.length!==0&&typeof window.updateHeroSlides=="function"&&window.updateHeroSlides(i)},{orderBy:["sortOrder"]});try{var n=localStorage.getItem("theme_cache");if(n){var a=JSON.parse(n);if(a.ts&&Date.now()-a.ts<6e5&&a.theme&&a.theme!=="default"){document.body.classList.add("theme-"+a.theme);return}}}catch(i){}e.collection("settings").doc("global").get().then(function(i){var s=i.exists&&i.data().activeTheme?i.data().activeTheme:"default";s!=="default"&&document.body.classList.add("theme-"+s);try{localStorage.setItem("theme_cache",JSON.stringify({ts:Date.now(),theme:s}))}catch(l){}}).catch(function(){});var r=document.getElementById("testimonials-grid");r&&fe("testimonials","testimonials_cache",600,function(s){var l=[];return s.forEach(function(c){var f=c.data();f.active&&l.push(f)}),l},function(s){if(s.length===0){var l=r.closest(".testimonials");l&&(l.style.display="none");return}r.innerHTML=s.map(function(c){var f=c.thumbnailUrl||(c.videoUrl?c.videoUrl.replace("/upload/","/upload/f_jpg,so_1/"):"");return'<div class="testimonial-card" onclick="openVideoLightbox(\''+(c.videoUrl||"")+'\')"><div class="testimonial-thumb">'+(f?'<img src="'+f+'" alt="" loading="lazy">':'<div class="testimonial-placeholder">üé¨</div>')+'<div class="testimonial-play">&#9654;</div></div><p class="testimonial-name">'+(c.customerName||"")+"</p>"+(c.caption?'<p class="testimonial-caption">'+c.caption+"</p>":"")+"</div>"}).join("")},{orderBy:["sortOrder"]});var o=document.getElementById("social-feed-strip");o&&fe("socialPosts","socialPosts_cache",600,function(s){var l=[];return s.forEach(function(c){var f=c.data();f.active&&l.push(f)}),l},function(s){if(s.length===0){var l=o.closest(".social-feed");l&&(l.style.display="none");return}o.innerHTML=s.map(function(c){var f=c.link?'<a href="'+c.link+'" target="_blank" rel="noopener">':"<div>",g=c.link?"</a>":"</div>";return f+'<div class="social-card"><img src="'+c.imageUrl+'" alt="" loading="lazy">'+(c.caption?'<span class="social-caption">'+c.caption+"</span>":"")+"</div>"+g}).join("")},{orderBy:["sortOrder"]})}function Jt(){const e=["Authentic Indian Cuisine","Crafted with Passion","A Legacy of Flavour","Where Taste Meets Art","Born from Tradition"],t=["Tradition, Perfection & Soul in Every Dish","Handcrafted Recipes Passed Down Generations","An Unforgettable Culinary Journey Awaits","Every Flavour Tells a Story of Heritage","Experience the Art of Indian Fine Dining"],n=document.querySelector(".hero-tagline .hero-text-inner"),a=document.querySelector(".hero-subtitle .hero-text-inner");if(!n||!a)return;let r=0;function o(){r=(r+1)%e.length,n.classList.add("fade-out"),a.classList.add("fade-out"),setTimeout(()=>{n.textContent=e[r],a.textContent=t[r],window._scrambleReveal?window._scrambleReveal(e[r],n):n.classList.remove("fade-out"),a.classList.remove("fade-out")},700)}setTimeout(()=>{setInterval(o,6e3)},5e3)}function Kt(){const e=document.querySelectorAll(".header-slideshow .slide");if(e.length===0)return;let t=0;setInterval(()=>{e[t].classList.remove("active");let n;do n=Math.floor(Math.random()*e.length);while(n===t&&e.length>1);t=n,e[t].classList.add("active")},3e3)}function Qt(){var e=document.querySelectorAll("#hero-slideshow .hero-slide"),t=document.getElementById("hero-sparkles"),n=0,a=window.innerWidth<=768;function r(){if(t){t.innerHTML="";for(var c=a?5:12,f=a?3:6,g=a?4:10,h=a?2:4,C=0;C<h;C++){var w=document.createElement("span");w.className="sp-glow";var x=200+Math.random()*250,k=10+C/h*70+Math.random()*15,V=20+Math.random()*50,A=10+Math.random()*8,W=C*3+Math.random()*2;w.style.cssText="left:"+k+"%;top:"+V+"%;width:"+x+"px;height:"+x+"px;--glow-dur:"+A+"s;--glow-delay:"+W+"s;",t.appendChild(w)}for(var q=0;q<c;q++){var H=document.createElement("span"),J=["","thin","accent","thin",""],d=J[q%J.length];H.className="sp-line"+(d?" "+d:"");var m=140+Math.random()*180,u=3+q/c*90+Math.random()*6,p=12+Math.random()*10,v=q/c*p,y=7+Math.random()*6,b=2.5+Math.random()*2;H.style.cssText="left:"+u+"%;height:"+m+"px;--line-dur:"+p+"s;--line-delay:"+v+"s;--sway-dur:"+y+"s;--shimmer-dur:"+b+"s;",t.appendChild(H)}for(var E=0;E<f;E++){var I=document.createElement("span");I.className="sp-dot";var S=4+Math.random()*5,P=8+Math.random()*84,F=18+Math.random()*12,O=E*3.5+Math.random()*4;I.style.cssText="left:"+P+"%;width:"+S+"px;height:"+S+"px;--dot-dur:"+F+"s;--dot-delay:"+O+"s;",t.appendChild(I)}for(var z=0;z<g;z++){var Ee=document.createElement("span");Ee.className="sp-mote";var Te=2+Math.random()*3,tt=5+Math.random()*90,nt=18+Math.random()*14,at=z*2.5+Math.random()*3,ot=1.5+Math.random()*2;Ee.style.cssText="left:"+tt+"%;width:"+Te+"px;height:"+Te+"px;--mote-dur:"+nt+"s;--mote-delay:"+at+"s;--twinkle-dur:"+ot+"s;",t.appendChild(Ee)}}}r();var o=["kb-zoom-left","kb-zoom-right","kb-pan-down","kb-zoom-center"],i=null;function s(){i&&clearInterval(i),e=document.querySelectorAll("#hero-slideshow .hero-slide"),n=0,e.length>1&&(i=setInterval(function(){e[n].classList.remove("active"),n=(n+1)%e.length;for(var c=0;c<o.length;c++)e[n].classList.remove(o[c]);e[n].classList.add(o[Math.floor(Math.random()*o.length)]),e[n].classList.add("active")},2e3))}s(),window.updateHeroSlides=function(c){var f=document.getElementById("hero-slideshow");if(!(!f||c.length===0)){i&&clearInterval(i);for(var g=f.querySelectorAll(".hero-slide"),h=0;h<g.length;h++)g[h].remove();c.forEach(function(C,w){var x=document.createElement("div");if(x.className="hero-slide"+(w===0?" active":""),w===0&&x.classList.add(o[Math.floor(Math.random()*o.length)]),C.type==="video"){x.classList.add("hero-slide-video");var k=document.createElement("video");k.src=C.url,k.autoplay=!0,k.muted=!0,k.loop=!0,k.playsInline=!0,k.setAttribute("playsinline",""),k.setAttribute("webkit-playsinline",""),x.appendChild(k)}else x.style.backgroundImage="url("+C.url+")";f.appendChild(x)}),e=f.querySelectorAll(".hero-slide"),n=0,e.length>1&&(i=setInterval(function(){e[n].classList.remove("active");var C=e[n].querySelector("video");C&&C.pause(),n=(n+1)%e.length;for(var w=0;w<o.length;w++)e[n].classList.remove(o[w]);e[n].classList.add(o[Math.floor(Math.random()*o.length)]),e[n].classList.add("active");var x=e[n].querySelector("video");x&&(x.currentTime=0,x.play())},2e3))}};var l=document.querySelector(".hero-tagline .hero-text-inner");if(l&&(window._scrambleReveal=function(c,f){f.textContent=c,f.classList.remove("fade-out"),f.style.opacity="1",f.style.transform="translateY(0)",f.classList.remove("blur-reveal"),f.offsetWidth,f.classList.add("blur-reveal")},setTimeout(function(){window._scrambleReveal(l.textContent,l)},2800)),window.innerWidth>768){const c=document.querySelector(".hero"),f=document.querySelector(".hero-mouse-spotlight");c&&f&&c.addEventListener("mousemove",function(g){const h=c.getBoundingClientRect(),C=g.clientX-h.left,w=g.clientY-h.top;f.style.setProperty("--mouse-x",C+"px"),f.style.setProperty("--mouse-y",w+"px")})}}function Zt(){const e=document.getElementById("confetti-canvas");if(!e)return;const t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const n=[],a=["#EFB31A","#8B1A1A","#27ae60","#e74c3c","#3498db","#f39c12","#9b59b6"];for(let i=0;i<150;i++)n.push({x:Math.random()*e.width,y:Math.random()*e.height-e.height,w:Math.random()*10+5,h:Math.random()*6+3,color:a[Math.floor(Math.random()*a.length)],vy:Math.random()*3+2,vx:Math.random()*2-1,rot:Math.random()*360,rotSpeed:Math.random()*6-3});let r=0;function o(){t.clearRect(0,0,e.width,e.height),n.forEach(i=>{i.y+=i.vy,i.x+=i.vx,i.rot+=i.rotSpeed,t.save(),t.translate(i.x,i.y),t.rotate(i.rot*Math.PI/180),t.fillStyle=i.color,t.fillRect(-i.w/2,-i.h/2,i.w,i.h),t.restore()}),r++,r<200?requestAnimationFrame(o):t.clearRect(0,0,e.width,e.height)}o()}function ve(){var e=document.getElementById("nav-links"),t=document.getElementById("mobile-menu-overlay"),n=document.getElementById("mobile-menu-toggle");e&&e.classList.remove("active"),t&&t.classList.remove("active"),n&&(n.textContent="‚ò∞"),D()}function en(){"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo(0,0),window.addEventListener("load",()=>{const d=document.getElementById("page-transition");d&&setTimeout(()=>d.classList.add("loaded"),100),setTimeout(()=>{const m=document.getElementById("preloader");m&&m.classList.add("hidden")},2200)}),function(){const d=document.getElementById("theme-toggle");if(!d)return;U("amogha-dark-mode")==="true"&&(document.body.classList.add("dark-mode"),d.textContent="‚òÄÔ∏è"),d.addEventListener("click",()=>{document.body.classList.toggle("dark-mode");const u=document.body.classList.contains("dark-mode");d.textContent=u?"‚òÄÔ∏è":"üåô",Y("amogha-dark-mode",u)})}(),function(){const d=document.querySelectorAll(".stat-number");function m(){if(window.innerWidth<=768){d.forEach(function(E){var I=parseFloat(E.dataset.target);E.textContent=I%1!==0?I.toFixed(1):I.toLocaleString()});return}var p=[];d.forEach(function(E){p.push({el:E,target:parseFloat(E.dataset.target),isDecimal:parseFloat(E.dataset.target)%1!==0,lastValue:-1})});var v=2e3,y=performance.now();function b(E){for(var I=E-y,S=Math.min(I/v,1),P=1-Math.pow(1-S,3),F=0;F<p.length;F++){var O=p[F],z=O.isDecimal?+(O.target*P).toFixed(1):Math.floor(O.target*P);z!==O.lastValue&&(O.el.textContent=O.isDecimal?z.toFixed(1):z.toLocaleString(),O.lastValue=z)}S<1&&requestAnimationFrame(b)}requestAnimationFrame(b)}const u=document.querySelector(".stats-section");if(u){let p=!1;const v=new IntersectionObserver(y=>{y[0].isIntersecting&&!p&&(p=!0,m(),v.unobserve(u))},{threshold:.3});v.observe(u)}}(),function(){var d=document.getElementById("nav-links"),m=document.getElementById("mobile-menu-toggle"),u=document.getElementById("mobile-menu-overlay");if(!d||!m)return;var p=d.parentElement;function v(){window.innerWidth<=768?d.parentElement!==document.body&&document.body.appendChild(d):d.parentElement===document.body&&p.appendChild(d)}v();var y;window.addEventListener("resize",function(){clearTimeout(y),y=setTimeout(v,100)}),m.addEventListener("click",()=>{const b=d.classList.toggle("active");u&&u.classList.toggle("active",b),m.textContent=b?"‚úï":"‚ò∞",b?Q():D()}),u&&u.addEventListener("click",ve),d.querySelectorAll("a").forEach(function(b){b.addEventListener("click",function(E){var I=b.getAttribute("href"),S=b.id==="signin-btn"||b.closest("#signin-btn");if(S){d.classList.remove("active"),u&&u.classList.remove("active"),m.textContent="‚ò∞";return}if(ve(),I&&I.startsWith("#")){E.preventDefault();var P=document.querySelector(I);P&&setTimeout(function(){P.scrollIntoView({behavior:"smooth",block:"start"})},50)}})})}(),document.querySelectorAll('a[href^="#"]').forEach(d=>{d.addEventListener("click",function(m){if(this.id==="cart-icon")return;m.preventDefault();const u=document.querySelector(this.getAttribute("href"));u&&(u.scrollIntoView({behavior:"smooth",block:"start"}),ve())})});const e=document.getElementById("back-to-top");e&&e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const t=document.querySelector(".hero-slideshow"),n=document.querySelectorAll("section[id]"),a=document.querySelectorAll('.nav-links a[href^="#"]'),r=document.querySelector("header");var o=0,i=document.querySelector(".hero-scroll-indicator"),s=document.getElementById("btt-ring-fill"),l=document.getElementById("sticky-order-bar"),c=document.querySelector(".hero"),f=2*Math.PI*16,g=c?c.offsetHeight:600,h=[];(function(){n.forEach(function(m){h.push({id:m.getAttribute("id"),top:m.offsetTop})})})();var C=document.querySelector(".about"),w=document.querySelector(".chef-content"),x=document.querySelector(".stats-grid"),k=C?C.offsetTop:0,V=w?w.closest("section")||w.closest(".chef-section"):null,A=V?V.offsetTop:0,W=x?x.closest(".stats-section"):null,q=W?W.offsetTop:0;window.addEventListener("resize",function(){g=c?c.offsetHeight:600,h=[],n.forEach(function(d){h.push({id:d.getAttribute("id"),top:d.offsetTop})}),k=C?C.offsetTop:0,A=V?V.offsetTop:0,q=W?W.offsetTop:0});var H=!1;window.addEventListener("scroll",function(){H||(requestAnimationFrame(function(){var d=window.pageYOffset,m=window.innerWidth>768;if(t&&m&&(t.style.transform="translateY("+d*.35+"px)"),m){var u=window.innerHeight;if(C&&d>k-u&&d<k+C.offsetHeight){var p=(d-k+u)*.06;C.style.setProperty("--section-parallax",p+"px")}w&&d>A-u&&d<A+800&&(w.style.transform="translateY("+(d-A+u)*.04+"px)"),x&&d>q-u&&d<q+600&&(x.style.transform="translateY("+(d-q+u)*.035+"px)")}if(i&&d<300?i.style.opacity=Math.max(0,1-d/300):i&&i.style.opacity!=="0"&&(i.style.opacity=0),r&&m&&(d>o&&d>100?r.style.transform="translateY(-100%)":r.style.transform="translateY(0)"),o=d,e){var v=d>400,y=e.classList.contains("visible");v&&!y?e.classList.add("visible"):!v&&y&&e.classList.remove("visible")}if(s){var b=document.documentElement.scrollHeight-document.documentElement.clientHeight,E=b>0?d/b:0;s.style.strokeDashoffset=f*(1-E)}if(l){var I=d>g,S=l.classList.contains("visible");I&&!S?l.classList.add("visible"):!I&&S&&l.classList.remove("visible")}if(m){for(var P="",F=0;F<h.length;F++)d>=h[F].top-150&&(P=h[F].id);a.forEach(function(O){O.classList.remove("active"),O.getAttribute("href")==="#"+P&&O.classList.add("active")})}H=!1}),H=!0)},{passive:!0}),function(){document.querySelectorAll(".about-text, .special-card, .menu-category, .gallery-item, .review-card, .faq-item, .info-block, .contact-form-section, .stat-item, .chef-content, .trust-badge").forEach(y=>{y.classList.add("reveal");const E=(y.parentElement?Array.from(y.parentElement.children).filter(S=>S.classList.contains(y.classList[0])):[]).indexOf(y);if(E>0){var I=.07*E+.04*Math.sin(E*Math.PI/4);y.style.transitionDelay=Math.max(0,I).toFixed(3)+"s"}}),document.querySelectorAll(".menu-item-card").forEach(y=>{y.classList.add("reveal");const E=(y.parentElement?Array.from(y.parentElement.children):[]).indexOf(y);var I=Math.floor(E/2),S=E%2;y.style.transitionDelay=(I*.12+S*.06).toFixed(3)+"s"}),document.querySelectorAll(".about, .specials, .menu, .gallery, .reviews, .contact, .faq").forEach(y=>{y.classList.add("section-reveal")});const m=document.querySelector(".chef-image"),u=document.querySelector("#chef-info");m&&m.classList.add("reveal-left"),u&&u.classList.add("reveal-right"),document.querySelectorAll(".stat-item").forEach(y=>{y.classList.remove("reveal"),y.classList.add("reveal-scale")});const p=document.querySelectorAll(".reveal, .reveal-left, .reveal-right, .reveal-scale, .section-reveal"),v=new IntersectionObserver(y=>{y.forEach(b=>{b.isIntersecting&&b.target.classList.add("visible")})},{threshold:.08,rootMargin:"0px 0px -50px 0px"});p.forEach(y=>v.observe(y))}(),function(){const d=document.querySelectorAll("#chef-slideshow .chef-slide"),m=document.querySelectorAll(".chef-info-slide");if(d.length<=1)return;let u=0;setInterval(()=>{d[u].classList.remove("active"),m[u]&&m[u].classList.remove("active"),u=(u+1)%d.length,d[u].classList.add("active"),m[u]&&m[u].classList.add("active")},4e3)}(),function(){const d=document.getElementById("category-carousel"),m=document.getElementById("cat-arrow-left"),u=document.getElementById("cat-arrow-right");if(!d||!m||!u)return;const p=250;function v(){m.disabled=d.scrollLeft<=5,u.disabled=d.scrollLeft>=d.scrollWidth-d.clientWidth-5}m.addEventListener("click",()=>{d.scrollBy({left:-p,behavior:"smooth"})}),u.addEventListener("click",()=>{d.scrollBy({left:p,behavior:"smooth"})}),d.addEventListener("scroll",v),v(),d.querySelectorAll(".category-item").forEach(y=>{y.addEventListener("click",b=>{b.preventDefault();const E=y.getAttribute("href"),I=document.querySelector(E);if(I){const P=I.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:P,behavior:"smooth"})}})})}(),function(){var d=document.getElementById("menu-search");d&&d.addEventListener("input",function(m){var u=m.target.value.toLowerCase();document.querySelectorAll(".menu-item-card").forEach(function(p){var v=p.querySelector("h4"),y=p.querySelector(".item-description"),b=v?v.textContent.toLowerCase():"",E=y?y.textContent.toLowerCase():"";p.style.display=b.includes(u)||E.includes(u)?"":"none"})})}(),document.querySelectorAll(".filter-btn").forEach(d=>{d.addEventListener("click",()=>{document.querySelectorAll(".filter-btn").forEach(u=>u.classList.remove("active")),d.classList.add("active");const m=d.dataset.filter;document.querySelectorAll(".menu-item-card").forEach(u=>{const p=u.querySelector(".veg-badge"),v=u.querySelector(".nonveg-badge");m==="all"?u.style.display="":m==="veg"?u.style.display=p?"":"none":m==="non-veg"&&(u.style.display=v?"":"none")})})});var J=document.getElementById("contact-form");J&&J.addEventListener("submit",d=>{d.preventDefault(),typeof showAuthToast=="function"&&showAuthToast("Thank you for your message! We will get back to you shortly."),d.target.reset()}),function(){const d=document.getElementById("food-particles");if(!d)return;const m=["üçõ","üçö","üå∂Ô∏è","üçó","ü•ò","ü´ì","‚òï","üç≤"];for(let u=0;u<12;u++){const p=document.createElement("span");p.className="food-particle",p.textContent=m[Math.floor(Math.random()*m.length)],p.style.left=Math.random()*100+"%",p.style.animationDuration=15+Math.random()*20+"s",p.style.animationDelay=Math.random()*15+"s",p.style.fontSize=1+Math.random()*1.5+"rem",d.appendChild(p)}}(),function(){let d;var m=document.getElementById("pwa-prompt"),u=document.getElementById("pwa-install-btn"),p=document.getElementById("pwa-dismiss-btn");function v(){m&&(m.style.opacity="0",m.style.transform="translateX(-50%) translateY(30px)",setTimeout(function(){m.style.display="none"},400))}window.addEventListener("beforeinstallprompt",function(y){y.preventDefault(),d=y,m&&(m.style.display="flex")}),u&&u.addEventListener("click",function(){d&&(d.prompt(),d.userChoice.then(function(){d=null,v()}))}),p&&p.addEventListener("click",v)}(),function(){if(window.innerWidth<=768)return;document.querySelectorAll(".cta-button, .add-to-cart").forEach(m=>{m.addEventListener("mousemove",u=>{const p=m.getBoundingClientRect(),v=u.clientX-p.left-p.width/2,y=u.clientY-p.top-p.height/2;m.style.transform="translate(".concat(v*.15,"px, ").concat(y*.15,"px)")}),m.addEventListener("mouseleave",()=>{m.style.transform=""})})}(),function(){function d(u){u.complete&&u.naturalHeight>0?u.classList.add("loaded"):u.addEventListener("load",()=>u.classList.add("loaded"))}document.querySelectorAll('img[loading="lazy"]').forEach(d),new MutationObserver(u=>{u.forEach(p=>{p.addedNodes.forEach(v=>{v.tagName==="IMG"&&v.loading==="lazy"&&d(v)})})}).observe(document.body,{childList:!0,subtree:!0})}(),function(){if(window.innerWidth<=768)return;const d=document.querySelectorAll(".menu-item-card"),m=4;d.forEach(function(u){u.addEventListener("mousemove",function(p){const v=u.getBoundingClientRect(),y=p.clientX-v.left,b=p.clientY-v.top,E=v.width/2,I=v.height/2,S=(b-I)/I*-m,P=(y-E)/E*m;u.style.transform="perspective(800px) rotateX("+S+"deg) rotateY("+P+"deg) translateY(-4px)"}),u.addEventListener("mouseleave",function(){u.style.transition="transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",u.style.transform="perspective(800px) rotateX(0) rotateY(0) translateY(0)",setTimeout(function(){u.style.transition=""},500)})})}(),function(){if(window.innerWidth<=768)return;var d=document.getElementById("cursor-glow");if(!d)return;var m=0,u=0,p=0,v=0,y=!1;document.addEventListener("mousemove",function(E){m=E.clientX,u=E.clientY,y||(y=!0,d.classList.add("active"))}),document.addEventListener("mouseleave",function(){y=!1,d.classList.remove("active")});function b(){p+=(m-p)*.12,v+=(u-v)*.12,d.style.left=p+"px",d.style.top=v+"px",requestAnimationFrame(b)}b()}(),function(){if(!(window.innerWidth<=768)){var d=[],m=document.querySelector(".chef-image");if(m&&d.push({el:m,speed:.04}),document.querySelectorAll(".about-text").forEach(function(p,v){d.push({el:p,speed:.02+v*.01})}),document.querySelectorAll(".stat-item").forEach(function(p,v){d.push({el:p,speed:.015+v*.008})}),d.length!==0){var u=!1;window.addEventListener("scroll",function(){u||(requestAnimationFrame(function(){d.forEach(function(p){var v=p.el.getBoundingClientRect(),y=v.top+v.height/2,b=window.innerHeight/2,E=(y-b)*p.speed;p.el.style.transform="translateY("+E+"px)"}),u=!1}),u=!0)},{passive:!0})}}}(),function(){var d=document.querySelectorAll(".svg-ornament");if(d.length!==0){var m=new IntersectionObserver(function(u){u.forEach(function(p){p.isIntersecting&&p.target.classList.add("visible")})},{threshold:.5});d.forEach(function(u){m.observe(u)})}}(),function(){if(window.innerWidth<=768)return;var d=document.getElementById("menu-preview-img");if(!d)return;var m={starters:"pics/Gemini_Generated_Image_wnzsqxwnzsqxwnzs.png",curries:"pics/Gemini_Generated_Image_tu348stu348stu34.png",biryanis:"pics/Gemini_Generated_Image_h1vezgh1vezgh1ve.png",kebabs:"pics/Gemini_Generated_Image_5jdcgq5jdcgq5jdc.png",noodles:"pics/Gemini_Generated_Image_1ojbou1ojbou1ojb.png",friedrice:"pics/Gemini_Generated_Image_bfgo8abfgo8abfgo.png",rotis:"pics/Gemini_Generated_Image_6lqqu6lqqu6lqqu6.png"};function u(p){var v=p.closest(".menu-category");if(!v)return null;var y=v.id||"";return y.indexOf("starters")!==-1?"starters":y.indexOf("curries")!==-1?"curries":y.indexOf("biryanis")!==-1?"biryanis":y.indexOf("kebabs")!==-1?"kebabs":y.indexOf("noodles")!==-1?"noodles":y.indexOf("friedrice")!==-1?"friedrice":y.indexOf("rotis")!==-1?"rotis":null}document.querySelectorAll(".menu-item-card").forEach(function(p){p.addEventListener("mouseenter",function(){var v=p.dataset.imageUrl;if(v)d.src=v,d.classList.add("active");else{var y=u(p);y&&m[y]&&(d.src=m[y],d.classList.add("active"))}}),p.addEventListener("mousemove",function(v){d.style.left=v.clientX+20+"px",d.style.top=v.clientY-90+"px"}),p.addEventListener("mouseleave",function(){d.classList.remove("active")})})}(),function(){if(!(window.innerWidth<=768)){var d=document.querySelectorAll(".chef-slide, .gallery-slide-item img, .gallery-item img"),m=.03;d.forEach(function(u){u.classList.add("magnetic-image"),u.addEventListener("mousemove",function(p){var v=u.getBoundingClientRect(),y=p.clientX-v.left-v.width/2,b=p.clientY-v.top-v.height/2;u.style.transform="translate("+y*m+"px, "+b*m+"px) scale(1.02)"}),u.addEventListener("mouseleave",function(){u.style.transform=""})})}}(),function(){if(!(window.innerWidth<=768)){var d=document.querySelectorAll(".menu-item-card, .about-text");d.forEach(function(m){var u=document.createElement("div");u.className="card-reflection",m.appendChild(u),m.addEventListener("mousemove",function(p){var v=m.getBoundingClientRect(),y=p.clientX-v.left,b=p.clientY-v.top;u.style.setProperty("--ref-x",y+"px"),u.style.setProperty("--ref-y",b+"px")})})}}(),function(){var d=document.querySelectorAll(".section-wipe");if(d.length!==0){var m=new IntersectionObserver(function(u){u.forEach(function(p){p.isIntersecting&&!p.target.classList.contains("wipe-active")&&p.target.classList.add("wipe-active")})},{threshold:.15});d.forEach(function(u){m.observe(u)})}}(),function(){document.addEventListener("click",function(d){var m=d.target.closest(".add-to-cart, .cta-button, .btn-primary, .pay-now-btn, .combo-add-btn");if(m){var u=document.createElement("span");u.className="btn-ripple";var p=m.getBoundingClientRect(),v=Math.max(p.width,p.height)*2;u.style.width=u.style.height=v+"px",u.style.left=d.clientX-p.left-v/2+"px",u.style.top=d.clientY-p.top-v/2+"px",m.appendChild(u),setTimeout(function(){u.remove()},700)}})}(),function(){if(window.innerWidth<=768)return;function d(m,u){for(var p=10,v=0;v<p;v++){var y=document.createElement("span");y.className="gold-particle";var b=v/p*Math.PI*2,E=40+Math.random()*30,I=Math.cos(b)*E,S=Math.sin(b)*E;y.style.left=m+"px",y.style.top=u+"px",y.style.setProperty("--tx",I+"px"),y.style.setProperty("--ty",S+"px"),y.style.animationDelay=Math.random()*.1+"s",document.body.appendChild(y),y.addEventListener("animationend",function(){this.remove()})}}document.addEventListener("click",function(m){(m.target.classList.contains("add-to-cart")||m.target.closest(".add-to-cart"))&&d(m.clientX,m.clientY)})}(),function(){var d={Mild:"Subtle warmth, family-friendly",Medium:"Balanced heat, our recommendation",Spicy:"Andhra-level heat, for the brave!"};document.querySelectorAll(".spice-level").forEach(function(m){var u=m.textContent.trim();d[u]&&(m.setAttribute("data-tooltip",d[u]),m.classList.add("has-tooltip"))})}(),function(){var d=50;function m(u,p){if(u){var v=0,y=0,b=!1;u.addEventListener("touchstart",function(E){v=E.touches[0].clientX,y=E.touches[0].clientY,b=!0},{passive:!0}),u.addEventListener("touchmove",function(E){if(b){var I=E.touches[0].clientX-v,S=E.touches[0].clientY-y;Math.abs(I)>Math.abs(S)&&Math.abs(I)>10&&E.preventDefault()}},{passive:!1}),u.addEventListener("touchend",function(E){if(b){b=!1;var I=E.changedTouches[0].clientX-v;Math.abs(I)>d&&p(I<0?1:-1)}},{passive:!0})}}m(document.querySelector(".gallery-slideshow-wrapper"),function(u){typeof window.moveGallerySlide=="function"&&window.moveGallerySlide(u)}),m(document.querySelector(".reviews-carousel-wrapper"),function(u){typeof window.moveCarousel=="function"&&window.moveCarousel(u)})}(),function(){var d=document.getElementById("menu-search");if(d){var m=document.createElement("div");m.id="search-autocomplete",m.className="search-autocomplete-dropdown",d.parentElement.classList.add("search-autocomplete-wrap"),d.parentElement.appendChild(m);var u=[];document.querySelectorAll(".menu-item-card").forEach(function(v){var y=v.querySelector("h4"),b=v.querySelector(".item-description"),E=v.querySelector(".price"),I=!!v.querySelector(".veg-badge"),S=v.closest(".menu-category"),P=S?S.querySelector(".category-title"):null,F=P?P.textContent:"";u.push({name:y?y.textContent.replace(/Bestseller|Popular|Chef's Pick|Must Try/g,"").trim():"",desc:b?b.textContent:"",price:E?E.textContent:"",isVeg:I,category:F,card:v})});var p;d.addEventListener("input",function(){clearTimeout(p),p=setTimeout(function(){var v=d.value.toLowerCase().trim();if(document.querySelectorAll(".menu-item-card").forEach(function(b){var E=b.querySelector("h4"),I=b.querySelector(".item-description"),S=E?E.textContent.toLowerCase():"",P=I?I.textContent.toLowerCase():"";b.style.display=!v||S.includes(v)||P.includes(v)?"":"none"}),v.length<2){m.classList.remove("visible"),m.innerHTML="";return}var y=u.filter(function(b){return b.name.toLowerCase().includes(v)||b.desc.toLowerCase().includes(v)}).slice(0,6);if(y.length===0){m.classList.remove("visible"),m.innerHTML="";return}m.innerHTML=y.map(function(b){var E=b.isVeg?'<span class="ac-badge veg">VEG</span>':'<span class="ac-badge non-veg">NON-VEG</span>';return'<button class="ac-item" data-name="'+b.name+'"><div class="ac-info"><span class="ac-name">'+b.name+'</span><span class="ac-meta">'+E+' <span class="ac-cat">'+b.category+'</span></span></div><span class="ac-price">'+b.price+"</span></button>"}).join(""),m.classList.add("visible")},150)}),m.addEventListener("click",function(v){var y=v.target.closest(".ac-item");if(y){var b=y.dataset.name;d.value=b,m.classList.remove("visible");var E=u.find(function(I){return I.name===b});E&&E.card&&(document.querySelectorAll(".menu-item-card").forEach(function(I){I.style.display=""}),E.card.scrollIntoView({behavior:"smooth",block:"center"}),E.card.classList.add("search-highlight"),setTimeout(function(){E.card.classList.remove("search-highlight")},2e3))}}),document.addEventListener("click",function(v){v.target.closest(".search-autocomplete-wrap")||m.classList.remove("visible")}),d.addEventListener("keydown",function(v){v.key==="Escape"&&(m.classList.remove("visible"),d.blur())})}}(),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('img[loading="lazy"]').forEach(function(m){m.complete?m.classList.add("loaded"):(m.addEventListener("load",function(){m.classList.add("loaded")}),m.addEventListener("error",function(){m.classList.add("loaded")}))});var d=new MutationObserver(function(m){m.forEach(function(u){u.addedNodes.forEach(function(p){if(p.nodeType===1){var v=p.querySelectorAll?p.querySelectorAll('img[loading="lazy"]'):[];v.forEach(function(y){y.complete?y.classList.add("loaded"):y.addEventListener("load",function(){y.classList.add("loaded")})})}})})});d.observe(document.body,{childList:!0,subtree:!0})})}Object.assign(window,{closeMobileMenu:ve,launchConfetti:Zt});function tn(){if("Notification"in window){if(Notification.permission==="granted"){Y("amoghaNotifPerm","granted");return}if(Notification.permission!=="denied"){var e=document.getElementById("notif-banner");!e&&!U("amoghaNotifDismissed")&&(e=document.createElement("div"),e.id="notif-banner",e.className="notif-banner",e.innerHTML='<span class="notif-icon">üîî</span><span class="notif-text">Get notified when your order is ready!</span><button class="notif-allow" onclick="enableNotifications()">Enable</button><button class="notif-dismiss" onclick="dismissNotifBanner()">&times;</button>',document.body.appendChild(e),setTimeout(function(){e.classList.add("visible")},3e3))}}}function nn(){Notification.requestPermission().then(function(e){Y("amoghaNotifPerm",e),Ge(),e==="granted"&&B("Notifications enabled!")})}function Ge(){var e=document.getElementById("notif-banner");e&&(e.classList.remove("visible"),setTimeout(function(){e.remove()},400)),Y("amoghaNotifDismissed","true")}function an(e,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(e,{body:t,icon:"amogha-logo.png",badge:"amogha-logo.png",tag:"amogha-order"})}catch(n){navigator.serviceWorker&&navigator.serviceWorker.ready&&navigator.serviceWorker.ready.then(function(a){a.showNotification(e,{body:t,icon:"amogha-logo.png",tag:"amogha-order"})})}}function on(){setTimeout(tn,5e3)}Object.assign(window,{enableNotifications:nn,dismissNotifBanner:Ge,sendPushNotification:an});function Ye(){var e=document.getElementById("reservation-modal");if(e){var t=document.getElementById("reservation-form");if(!t||t.dataset.enhanced==="true"){e.style.display="block";return}t.dataset.enhanced="true";var n=new Date().toISOString().split("T")[0],a=new Date(Date.now()+7*864e5).toISOString().split("T")[0];t.innerHTML='<input type="text" id="res-name" placeholder="Your Name" required><input type="tel" id="res-phone" placeholder="Phone Number (10 digits)" required maxlength="10"><input type="date" id="res-date" min="'+n+'" max="'+a+'" required><div class="res-time-slots" id="res-time-slots"></div><input type="hidden" id="res-time" value=""><div class="res-party-size"><label>Party Size</label><div class="party-btns" id="party-btns"></div></div><textarea id="res-requests" placeholder="Special Requests (Optional)" rows="2"></textarea><div id="res-msg" class="auth-msg"></div><button type="submit" class="cta-button">Confirm Reservation</button>';for(var r=document.getElementById("party-btns"),o=1;o<=12;o++){var i=document.createElement("button");i.type="button",i.className="party-btn",i.textContent=o,i.dataset.size=o,i.onclick=function(){document.querySelectorAll(".party-btn").forEach(function(l){l.classList.remove("active")}),this.classList.add("active")},r.appendChild(i)}document.getElementById("res-date").addEventListener("change",function(){sn(this.value)}),t.onsubmit=function(l){l.preventDefault(),Ve()};var s=N();s&&(document.getElementById("res-name").value=s.name||"",document.getElementById("res-phone").value=s.phone||""),e.style.display="block"}}function rn(){var e=document.getElementById("reservation-modal");e&&(e.style.display="none")}function sn(e){var t=document.getElementById("res-time-slots");if(t){t.innerHTML='<label>Select Time</label><div class="time-grid" id="time-grid"></div>';for(var n=document.getElementById("time-grid"),a=new Date(e).getDay(),r=a===0?12:11,o=a===5||a===6?22:21,i=r;i<=o;i++)for(var s=0;s<60&&!(i===o&&s>0);s+=30){var l=String(i).padStart(2,"0")+":"+String(s).padStart(2,"0"),c=(i>12?i-12:i)+":"+String(s).padStart(2,"0")+(i>=12?" PM":" AM"),f=document.createElement("button");f.type="button",f.className="time-slot-btn",f.textContent=c,f.dataset.time=l,f.onclick=function(){document.querySelectorAll(".time-slot-btn").forEach(function(g){g.classList.remove("active")}),this.classList.add("active"),document.getElementById("res-time").value=this.dataset.time},n.appendChild(f)}}}function Ve(){var e=document.getElementById("res-name").value.trim(),t=document.getElementById("res-phone").value.trim(),n=document.getElementById("res-date").value,a=document.getElementById("res-time").value,r=document.querySelector(".party-btn.active"),o=r?parseInt(r.dataset.size):0,i=document.getElementById("res-requests").value.trim(),s=document.getElementById("res-msg");if(!e||!t||!n||!a||!o){s.textContent="Please fill in all required fields.",s.className="auth-msg error";return}if(!/^\d{10}$/.test(t)){s.textContent="Please enter a valid 10-digit phone number.",s.className="auth-msg error";return}s.textContent="Booking your table...",s.className="auth-msg";var l=M();if(!l){s.textContent="Service unavailable. Please refresh and try again.",s.className="auth-msg error";return}var c={name:e,phone:t,date:n,time:a,partySize:o,requests:i,status:"pending",createdAt:new Date().toISOString()};l.collection("reservations").add(c).then(function(f){var g=document.getElementById("reservation-form"),h=new Date(n).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"}),C=a,w=parseInt(a.split(":")[0]),x=a.split(":")[1];C=(w>12?w-12:w)+":"+x+(w>=12?" PM":" AM"),g.innerHTML='<div class="res-confirmed"><div class="res-check">&#10003;</div><h3>Reservation Confirmed!</h3><p class="res-id">Booking #'+f.id.slice(-6).toUpperCase()+'</p><div class="res-details"><p>'+h+" at "+C+"</p><p>"+o+" Guest"+(o>1?"s":"")+'</p></div><a class="whatsapp-btn" href="https://wa.me/919121004999?text='+encodeURIComponent("Hi Amogha! I have a reservation:\nDate: "+h+"\nTime: "+C+"\nGuests: "+o+"\nName: "+e+"\nBooking: #"+f.id.slice(-6).toUpperCase())+'" target="_blank">Confirm via WhatsApp</a><button class="cta-button" onclick="document.getElementById(\'reservation-modal\').style.display=\'none\'" style="margin-top:1rem">Done</button></div>'}).catch(function(){s.textContent="Failed to book. Please try again.",s.className="auth-msg error"})}function cn(){var e=document.querySelector(".cta-button.secondary");e&&e.textContent.indexOf("Reserve")!==-1&&(e.onclick=function(){Ye()});var t=document.getElementById("reservation-form");t&&t.addEventListener("submit",n=>{n.preventDefault(),typeof showAuthToast=="function"&&showAuthToast("Reservation request received! We will confirm shortly."),n.target.reset();var a=document.getElementById("reservation-modal");a&&(a.style.display="none")})}Object.assign(window,{openReservationModal:Ye,closeReservationModal:rn,submitReservation:Ve});function de(e){for(var t=j.length-1;t>=0;t--)if(e>=j[t].min)return j[t];return j[0]}function ln(e){var t=N();if(t){var n=Math.floor(e/10),a=new Date().toISOString().split("T")[0],r=t.orderDates||[];if(r[r.length-1]!==a&&r.push(a),r.length>=3){var o=r.slice(-3),i=new Date(o[0]),s=new Date(o[1]),l=new Date(o[2]),c=(s-i)/864e5,f=(l-s)/864e5;c===1&&f===1&&(n=n*2)}r.length>30&&(r=r.slice(-30));var g=(t.loyaltyPoints||0)+n,h=de(t.loyaltyPoints||0),C=de(g);t.loyaltyPoints=g,t.loyaltyTier=C.name,t.orderDates=r,Z(t);var w=M();w&&w.collection("users").doc(t.phone).update({loyaltyPoints:g,loyaltyTier:C.name,orderDates:r}).catch(function(k){console.error("Loyalty tier update error:",k)});var x=n>Math.floor(e/10)?" (2x Streak Bonus!)":"";B("+"+n+" loyalty points earned!"+x),C.name!==h.name&&setTimeout(function(){B("Congratulations! You are now "+C.icon+" "+C.name+" tier!"),typeof launchConfetti=="function"&&launchConfetti()},2e3),Se()}}function Se(){var e=document.getElementById("loyalty-widget");if(e){var t=N();if(!t){e.style.display="none";return}var n=t.loyaltyPoints||0,a=de(n);e.style.display="flex",e.innerHTML='<span class="loyalty-icon">'+a.icon+'</span><span class="loyalty-pts">'+n+" pts</span>",e.title=a.name+" Tier | "+n+" Points | Redeem 100pts = Rs.10 off",e.style.cursor="pointer",e.onclick=function(){ze()}}}function ze(){var e=N();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}for(var t=e.loyaltyPoints||0,n=de(t),a=null,r=0;r<j.length;r++)if(j[r].min>t){a=j[r];break}var o=document.getElementById("loyalty-modal");o||(o=document.createElement("div"),o.id="loyalty-modal",o.className="modal",o.innerHTML='<div class="modal-content loyalty-modal-content"></div>',document.body.appendChild(o),o.addEventListener("click",function(c){c.target===o&&(o.style.display="none")}));var i=a?Math.min(100,(t-n.min)/(a.min-n.min)*100):100,s=a?'<p class="loyalty-next">'+(a.min-t)+" points to "+a.icon+" "+a.name+"</p>":'<p class="loyalty-next">You have reached the highest tier!</p>',l=Math.floor(t/100)*10;o.querySelector(".loyalty-modal-content").innerHTML='<span class="close" onclick="document.getElementById(\'loyalty-modal\').style.display=\'none\'">&times;</span><div class="loyalty-header"><div class="loyalty-tier-badge" style="background:'+n.color+'">'+n.icon+" "+n.name+"</div><h2>"+t+' Points</h2></div><div class="loyalty-progress-bar"><div class="loyalty-progress-fill" style="width:'+i+"%;background:"+n.color+'"></div></div>'+s+'<div class="loyalty-info"><div class="loyalty-info-row"><span>Redeemable Value</span><span>Rs.'+l+'</span></div><div class="loyalty-info-row"><span>Points per Rs.10 spent</span><span>1 point</span></div><div class="loyalty-info-row"><span>3-Day Streak Bonus</span><span>2x points</span></div></div><div class="loyalty-tiers-list">'+j.map(function(c){var f=c.name===n.name?" active":"";return'<div class="loyalty-tier-item'+f+'"><span>'+c.icon+" "+c.name+"</span><span>"+c.min+"+ pts</span></div>"}).join("")+"</div>",o.style.display="block"}function dn(){var e=document.getElementById("loyalty-modal");e&&(e.style.display="none")}function un(){setTimeout(Se,500)}Object.assign(window,{openLoyaltyModal:ze,closeLoyaltyModal:dn,updateLoyaltyWidget:Se,awardLoyaltyPoints:ln,getLoyaltyTier:de});function je(e){e.parentElement.querySelectorAll(".spice-level").forEach(n=>n.classList.remove("active")),e.classList.add("active")}window.selectSpice=je;function mn(){const e=document.getElementById("reviews-carousel");if(!e)return;let t=0,n;function a(){return window.innerWidth<=768?1:window.innerWidth<=1024?2:3}function r(){const c=e.querySelector(".review-card");if(!c)return 0;const f=window.getComputedStyle(c);return c.offsetWidth+parseFloat(f.marginLeft)+parseFloat(f.marginRight)}function o(){const c=r();e.style.transform="translateX(-".concat(t*c,"px)")}window.moveCarousel=function(c){const f=e.querySelectorAll(".review-card"),g=a(),h=Math.max(0,f.length-g);t=Math.max(0,Math.min(t+c,h)),o(),s()};function i(){const c=e.querySelectorAll(".review-card"),f=a(),g=Math.max(0,c.length-f);t++,t>g&&(t=0),o()}function s(){clearInterval(n),n=setInterval(i,4e3)}const l=document.querySelector(".reviews-carousel-wrapper");l&&(l.addEventListener("mouseenter",()=>{clearInterval(n)}),l.addEventListener("mouseleave",()=>{s()})),window.addEventListener("resize",()=>{t=0,o(),s()}),n=setInterval(i,4e3)}function fn(){const e=document.querySelectorAll(".gallery-slide"),t=document.getElementById("gallery-dots");let n=0;t&&e.length>1&&e.forEach((r,o)=>{const i=document.createElement("button");i.className="gallery-dot"+(o===0?" active":""),i.addEventListener("click",()=>a(o)),t.appendChild(i)});function a(r){e.forEach(i=>i.classList.remove("active")),e[r]&&e[r].classList.add("active"),n=r,document.querySelectorAll(".gallery-dot").forEach((i,s)=>i.classList.toggle("active",s===r))}window.moveGallerySlide=function(r){if(e.length===0)return;let o=(n+r+e.length)%e.length;a(o)},e.length>1&&setInterval(()=>{window.moveGallerySlide(1)},5e3)}function vn(){const e=document.querySelectorAll(".gallery-item img"),t=document.querySelectorAll(".gallery-slide-item img"),n=[...e,...t],a=document.getElementById("lightbox"),r=document.getElementById("lightbox-img");let o=0;n.forEach((i,s)=>{i.addEventListener("click",()=>{o=s,r.src=i.src,a.classList.add("active"),Q()})}),window.closeLightbox=function(){a.classList.remove("active"),D()},window.navigateLightbox=function(i){o=(o+i+n.length)%n.length,r.src=n[o].src},document.addEventListener("keydown",i=>{a.classList.contains("active")&&(i.key==="Escape"&&window.closeLightbox(),i.key==="ArrowLeft"&&window.navigateLightbox(-1),i.key==="ArrowRight"&&window.navigateLightbox(1))})}function pn(e){if(e){var t=document.getElementById("video-lightbox"),n=document.getElementById("lightbox-video");!t||!n||(n.src=e,t.style.display="flex",n.play())}}function yn(){var e=document.getElementById("video-lightbox"),t=document.getElementById("lightbox-video");e&&(e.style.display="none"),t&&(t.pause(),t.src="")}function $e(e){var t=N();if(t){var n=document.getElementById("review-modal");n||(n=document.createElement("div"),n.id="review-modal",n.className="modal",n.innerHTML='<div class="modal-content review-modal-content"></div>',document.body.appendChild(n),n.addEventListener("click",function(o){o.target===n&&(n.style.display="none")}));var a=e||L.map(function(o){return{name:o.name}}),r="<span class=\"close\" onclick=\"document.getElementById('review-modal').style.display='none'\">&times;</span>";r+='<h2>Rate Your Order</h2><p class="review-subtitle">Help us serve you better!</p>',r+='<div id="review-items">',a.forEach(function(o,i){r+='<div class="review-item" data-item="'+o.name+'"><span class="review-item-name">'+o.name+'</span><div class="review-stars" data-idx="'+i+'">';for(var s=1;s<=5;s++)r+='<span class="review-star" data-star="'+s+'" onclick="setReviewStar(this, '+i+", "+s+')">&#9734;</span>';r+="</div></div>"}),r+="</div>",r+='<textarea id="review-text" class="review-textarea" placeholder="Share your thoughts (optional)" maxlength="200"></textarea>',r+='<button class="cta-button" onclick="submitReviews()">Submit Review</button>',n.querySelector(".review-modal-content").innerHTML=r,n.style.display="block",window._reviewRatings=new Array(a.length).fill(0),window._reviewItems=a}}function gn(e,t,n){window._reviewRatings[t]=n;var a=e.parentElement;a.querySelectorAll(".review-star").forEach(function(r,o){r.innerHTML=o<n?"&#9733;":"&#9734;",r.classList.toggle("active",o<n)})}function hn(){var e=N();if(e){var t=document.getElementById("review-text").value.trim(),n=M(),a=n.batch(),r=!1;if(window._reviewItems.forEach(function(o,i){var s=window._reviewRatings[i];if(s>0){r=!0;var l=n.collection("reviews").doc();a.set(l,{itemName:o.name,rating:s,text:t,userName:e.name,userPhone:e.phone,createdAt:new Date().toISOString()})}}),!r){B("Please rate at least one item");return}a.commit().then(function(){document.getElementById("review-modal").style.display="none",B("Thank you for your review!"),setTimeout(function(){typeof window.loadMenuRatings=="function"&&window.loadMenuRatings()},1e3)}).catch(function(){B("Failed to submit review. Please try again.")})}}function bn(e){setTimeout(function(){N()&&$e(e)},6e4)}function wn(){var e={biryanis:[{name:"Veg Dum Biryani",price:179},{name:"Paneer Biryani",price:219},{name:"Egg Biryani",price:189},{name:"Chicken Fry Piece Biryani",price:219},{name:"Chicken 65 Biryani",price:249},{name:"Boneless Chicken Biryani",price:219}],starters:[{name:"Veg Manchurian",price:169},{name:"Paneer 65",price:189},{name:"Chicken 65",price:200},{name:"Chicken Hot Wings",price:220},{name:"Chilli Chicken",price:200}],drinks:[{name:"Tea",price:30},{name:"Coffee",price:40},{name:"Lassi",price:50},{name:"Buttermilk",price:35},{name:"Fresh Lime Soda",price:45}]},t={biryani:null,starter:null,drink:null},n=.15;function a(s,l,c){var f=document.getElementById(s);f&&(f.innerHTML=l.map(function(g){return'<button class="combo-option" data-category="'+c+'" data-name="'+g.name+'" data-price="'+g.price+'"><span class="combo-opt-name">'+g.name+'</span><span class="combo-opt-price">‚Çπ'+g.price+"</span></button>"}).join(""))}function r(){a("combo-biryanis",e.biryanis,"biryani"),a("combo-starters",e.starters,"starter"),a("combo-drinks",e.drinks,"drink")}document.addEventListener("click",function(s){var l=s.target.closest(".combo-option");if(l){var c=l.dataset.category,f=l.dataset.name,g=parseInt(l.dataset.price);l.parentElement.querySelectorAll(".combo-option").forEach(function(h){h.classList.remove("selected")}),l.classList.add("selected"),t[c]={name:f,price:g},o()}});function o(){var s=document.getElementById("combo-selected"),l=document.getElementById("combo-original"),c=document.getElementById("combo-total"),f=document.getElementById("combo-add-btn");if(s){var g=[],h=0;if(t.biryani&&(g.push(t.biryani.name),h+=t.biryani.price),t.starter&&(g.push(t.starter.name),h+=t.starter.price),t.drink&&(g.push(t.drink.name),h+=t.drink.price),s.textContent=g.length>0?g.join(" + "):"Select items above",h>0){var C=Math.round(h*(1-n));l.textContent="‚Çπ"+h,l.style.textDecoration="line-through",c.textContent="‚Çπ"+C}else l.textContent="",c.textContent="";f&&(f.disabled=!(t.biryani&&t.starter&&t.drink))}}window.openComboModal=function(){r(),t={biryani:null,starter:null,drink:null},o();var s=document.getElementById("combo-modal");s&&(s.style.display="block",Q())},window.closeComboModal=function(){var s=document.getElementById("combo-modal");s&&(s.style.display="none",D())};var i=document.getElementById("combo-modal");i&&i.addEventListener("click",function(s){s.target===i&&window.closeComboModal()}),window.addComboToCart=function(){if(!(!t.biryani||!t.starter||!t.drink)){var s=t.biryani.price+t.starter.price+t.drink.price,l=Math.round(s*(1-n)),c="Combo: "+t.biryani.name+" + "+t.starter.name+" + "+t.drink.name,f=L.find(function(g){return g.name===c});f?f.quantity++:L.push({name:c,price:l,quantity:1}),X(),ee(),ne(),ge(),B("Combo added! You saved ‚Çπ"+(s-l)),window.closeComboModal()}}}function Xe(){for(var e=new Date,t=e.getDay(),n=e.getHours(),a=0;a<Ne.length;a++){var r=Ne[a];if(r.days.indexOf(t)!==-1&&n>=r.startHour&&n<r.endHour)return r}return null}function Pe(){var e=Xe(),t=document.getElementById("happy-hour-banner");if(!e){t&&(t.style.display="none"),document.querySelectorAll(".hh-price").forEach(function(s){s.remove()}),document.querySelectorAll(".price.hh-crossed").forEach(function(s){s.classList.remove("hh-crossed")});return}if(!t){t=document.createElement("div"),t.id="happy-hour-banner",t.className="happy-hour-banner";var n=document.getElementById("menu");n&&n.insertBefore(t,n.firstChild)}var a=new Date;a.setHours(e.endHour,0,0,0);var r=Math.max(0,a-new Date),o=Math.floor(r/6e4),i=Math.floor(r%6e4/1e3);t.innerHTML='<span class="hh-icon">üî•</span> <strong class="hh-text">'+e.label+'</strong> <span class="hh-timer">Ends in '+o+"m "+i+"s</span>",t.style.display="flex",document.querySelectorAll(".menu-item-card").forEach(function(s){var l=s.querySelector(".price");if(l){var c=s.closest(".menu-category");if(c){var f=(c.id||"").toLowerCase(),g=e.categories.indexOf("all")!==-1;if(g||e.categories.forEach(function(k){f.indexOf(k)!==-1&&(g=!0)}),!!g){var h=parseInt(l.textContent.replace(/[^\d]/g,"")),C=Math.round(h*(1-e.discount/100));l.classList.add("hh-crossed");var w=s.querySelector(".hh-price");if(w)w.textContent="‚Çπ"+C;else{var x=document.createElement("span");x.className="hh-price",x.textContent="‚Çπ"+C,l.after(x)}}}}})}function Je(){if(L.length===0)return[];var e={},t=L.map(function(a){return a.name});t.forEach(function(a){var r=lt[a]||[];r.forEach(function(o){t.indexOf(o)===-1&&pe[o]&&(e[o]=(e[o]||0)+1)})});var n=Object.keys(e).sort(function(a,r){return e[r]-e[a]});return n.slice(0,4).map(function(a){return{name:a,price:pe[a]}})}function ke(){var e=document.getElementById("cart-recommendations");if(e){var t=Je();if(t.length===0){e.style.display="none";return}var n='<p class="rec-title">You might also like:</p><div class="rec-items">';t.forEach(function(a){n+='<button class="rec-item" onclick="addToCart(\''+a.name.replace(/'/g,"\\'")+"', "+a.price+'); displayCart(); showRecommendations();"><span class="rec-name">'+a.name+'</span><span class="rec-price">‚Çπ'+a.price+'</span><span class="rec-add">+</span></button>'}),n+="</div>",e.innerHTML=n,e.style.display="block"}}var oe=!1,G=null;function Ke(){var e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){G=new e,G.continuous=!1,G.interimResults=!0,G.lang="en-IN",G.onresult=function(n){for(var a="",r=n.resultIndex;r<n.results.length;r++)a+=n.results[r][0].transcript;En(a),n.results[n.resultIndex].isFinal&&Cn(a)},G.onend=function(){oe&&(oe=!1,re())},G.onerror=function(){oe=!1,re()};var t=document.createElement("button");t.id="voice-order-btn",t.className="voice-order-btn",t.innerHTML='<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>',t.title="Voice Order",t.onclick=Qe,document.body.appendChild(t)}}function Qe(){oe?(G.stop(),oe=!1,re()):(oe=!0,Ze(),G.start())}function Ze(){var e=document.getElementById("voice-overlay");e||(e=document.createElement("div"),e.id="voice-overlay",e.className="voice-overlay",e.innerHTML='<div class="voice-content"><div class="voice-waves"><span></span><span></span><span></span><span></span><span></span></div><p class="voice-status">Listening...</p><p class="voice-transcript" id="voice-transcript"></p><p class="voice-hint">Say "Add chicken biryani" or "2 butter naan"</p><button class="voice-close" onclick="toggleVoice()">Cancel</button></div>',document.body.appendChild(e)),e.classList.add("active"),document.getElementById("voice-transcript").textContent=""}function re(){var e=document.getElementById("voice-overlay");e&&e.classList.remove("active")}function En(e){var t=document.getElementById("voice-transcript");t&&(t.textContent=e)}function Cn(e){e=e.toLowerCase().trim();var t=e.match(/^(?:add\s+)?(\d+)\s+/),n=t?parseInt(t[1]):1,a=e.replace(/^(?:add\s+)?(\d+\s+)?/,"").replace(/^add\s+/,""),r=null,o=0;if(Object.keys(pe).forEach(function(s){var l=s.toLowerCase(),c=0;if(l===a)c=100;else if(l.indexOf(a)!==-1)c=80;else if(a.indexOf(l)!==-1)c=70;else{var f=a.split(" ");f.forEach(function(g){g.length>2&&l.indexOf(g)!==-1&&(c+=20)})}c>o&&(o=c,r=s)}),r&&o>=20){for(var i=0;i<n;i++)ie(r,pe[r]);B("Added "+n+"x "+r+" to cart"),re()}else e.indexOf("checkout")!==-1||e.indexOf("check out")!==-1?(typeof window.checkout=="function"&&window.checkout(),re()):e.indexOf("clear")!==-1?(typeof window.clearCart=="function"&&window.clearCart(),re()):B('Could not find: "'+a+'". Try again.')}var le=U("amoghaLang")||"en";function Ln(e){le=e,Y("amoghaLang",e),Me(),document.querySelectorAll(".lang-btn").forEach(function(t){t.classList.toggle("active",t.dataset.lang===e)})}function Me(){var e=Ae[le]||Ae.en;document.querySelectorAll("[data-i18n]").forEach(function(t){var n=t.dataset.i18n;e[n]&&((t.tagName==="INPUT"||t.tagName==="TEXTAREA")&&t.placeholder!==void 0?t.placeholder=e[n]:t.textContent=e[n])})}function et(e){if(!e)return"";var t=(e.name||"USER").replace(/[^A-Za-z]/g,"").toUpperCase().slice(0,4),n=(e.phone||"0000").slice(-4);return t+n}function In(){var e=N();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=e.referralCode||et(e);if(!e.referralCode){e.referralCode=t,Z(e);var n=M();n&&n.collection("users").doc(e.phone).update({referralCode:t}).catch(function(o){console.error("Referral code save error:",o)})}var a=document.getElementById("referral-modal");a||(a=document.createElement("div"),a.id="referral-modal",a.className="modal",a.innerHTML='<div class="modal-content referral-content"></div>',document.body.appendChild(a),a.addEventListener("click",function(o){o.target===a&&(a.style.display="none")}));var r="Order from Amogha Cafe & get Rs.50 off your first order! Use my referral code: "+t+" when signing up. Order at "+window.location.origin;a.querySelector(".referral-content").innerHTML='<span class="close" onclick="document.getElementById(\'referral-modal\').style.display=\'none\'">&times;</span><h2>Refer a Friend</h2><p class="referral-subtitle">Share your code and both get rewarded!</p><div class="referral-code-box"><span class="referral-code">'+t+'</span><button class="referral-copy" onclick="safeCopy(\''+t+'\',this)">Copy</button></div><div class="referral-rewards"><div class="referral-reward"><span class="referral-reward-icon">üéÅ</span><span>Your friend gets <strong>Rs.50 off</strong> first order</span></div><div class="referral-reward"><span class="referral-reward-icon">‚≠ê</span><span>You get <strong>100 loyalty points</strong></span></div></div><a class="whatsapp-btn referral-share" href="https://wa.me/?text='+encodeURIComponent(r)+'" target="_blank">Share via WhatsApp</a>',a.style.display="block"}function xn(){var e=document.getElementById("referral-modal");e&&(e.style.display="none")}function Bn(e){if(e){var t=M();t&&(e=e.toUpperCase().trim(),t.collection("users").where("referralCode","==",e).limit(1).get().then(function(n){if(!n.empty){var a=n.docs[0],r=a.data(),o=N();!o||r.phone===o.phone||(t.collection("referrals").add({referrerPhone:r.phone,refereePhone:o.phone,redeemed:!1,createdAt:new Date().toISOString()}).catch(function(i){console.error("Referral save error:",i)}),o.referralDiscount=50,Z(o),B("Referral applied! Rs.50 off your first order!"))}}))}}function Sn(){var e=N();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=document.getElementById("myorders-modal");t||(t=document.createElement("div"),t.id="myorders-modal",t.className="modal",t.innerHTML='<div class="modal-content myorders-content"><span class="close" onclick="document.getElementById(\'myorders-modal\').style.display=\'none\'">&times;</span><h2>My Orders</h2><div id="myorders-list" class="myorders-list"><p>Loading...</p></div></div>',document.body.appendChild(t),t.addEventListener("click",function(r){r.target===t&&(t.style.display="none")})),t.style.display="block";var n=document.getElementById("myorders-list");n.innerHTML='<p style="text-align:center;color:#a09080">Loading orders...</p>';var a=M();if(!a){n.innerHTML='<p style="text-align:center;color:#a09080;padding:2rem">Service unavailable. Please refresh.</p>';return}a.collection("orders").where("userId","==",e.phone).orderBy("createdAt","desc").limit(10).get().then(function(r){if(r.empty){n.innerHTML='<p style="text-align:center;color:#a09080;padding:2rem">No orders yet. Place your first order!</p>';return}var o="";r.forEach(function(i){var s=i.data(),l=s.createdAt?new Date(s.createdAt):new Date,c=l.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),f={pending:"#f39c12",confirmed:"#3498db",preparing:"#e67e22",delivered:"#27ae60",cancelled:"#e74c3c"},g=f[s.status]||"#999",h=(s.items||[]).map(function(C){return C.name+" x"+C.qty}).join(", ");o+='<div class="myorder-card"><div class="myorder-header"><span class="myorder-date">'+c+'</span><span class="myorder-status" style="color:'+g+'">'+(s.status||"pending").toUpperCase()+'</span></div><p class="myorder-items">'+h+'</p><div class="myorder-footer"><span class="myorder-total">Rs.'+(s.total||0)+'</span><button class="myorder-reorder-btn" onclick="reorderFromHistory(\''+i.id+"')\">Order Again</button></div></div>"}),n.innerHTML=o,Y("amoghaMyOrders",JSON.stringify(r.docs.map(function(i){return{id:i.id,data:i.data()}})))}).catch(function(r){console.error("Load orders error:",r);var o=U("amoghaMyOrders");if(o){var i=JSON.parse(o),s="";i.forEach(function(l){var c=l.data,f=c.createdAt?new Date(c.createdAt):new Date,g=f.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),h=(c.items||[]).map(function(C){return C.name+" x"+C.qty}).join(", ");s+='<div class="myorder-card"><div class="myorder-header"><span class="myorder-date">'+g+'</span><span class="myorder-status">'+(c.status||"").toUpperCase()+'</span></div><p class="myorder-items">'+h+'</p><div class="myorder-footer"><span class="myorder-total">Rs.'+(c.total||0)+'</span><button class="myorder-reorder-btn" onclick="reorderFromHistory(\''+l.id+"')\">Order Again</button></div></div>"}),n.innerHTML=s}else n.innerHTML='<p style="text-align:center;color:#e74c3c">Failed to load orders. Please try again.</p>'})}function kn(){var e=document.getElementById("myorders-modal");e&&(e.style.display="none")}function Mn(e){var t=U("amoghaMyOrders");if(t){var n=JSON.parse(t),a=n.find(function(o){return o.id===e});if(a&&a.data.items){a.data.items.forEach(function(o){for(var i=0;i<o.qty;i++)ie(o.name,o.price)}),document.getElementById("myorders-modal").style.display="none",B("Items added to cart! Review and checkout.");return}}var r=M();r.collection("orders").doc(e).get().then(function(o){o.exists&&o.data().items&&(o.data().items.forEach(function(i){for(var s=0;s<i.qty;s++)ie(i.name,i.price)}),document.getElementById("myorders-modal").style.display="none",B("Items added to cart! Review and checkout."))})}function Tn(){var e=document.getElementById("schedule-order-check"),t=document.getElementById("schedule-fields"),n=document.getElementById("schedule-date"),a=document.getElementById("schedule-time");if(!e||!t||!n||!a)return;e.addEventListener("change",function(){t.style.display=this.checked?"block":"none",this.checked&&(r(),o())});function r(){var i=new Date,s=i.toISOString().split("T")[0],l=new Date(i);l.setDate(l.getDate()+3);var c=l.toISOString().split("T")[0];n.min=s,n.max=c,n.value=s}function o(){var i=["11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM"];a.innerHTML='<option value="">Select Time</option>',i.forEach(function(s){a.innerHTML+='<option value="'+s+'">'+s+"</option>"})}window.getScheduleInfo=function(){return e.checked?{date:n.value,time:a.value}:null}}function Nn(){mn(),fn(),vn(),wn(),Pe(),setInterval(Pe,6e4),setTimeout(Ke,1e3),setTimeout(function(){var t=document.querySelector(".nav-links");if(t){var n=document.createElement("li");n.className="lang-switcher",n.innerHTML='<button class="lang-btn'+(le==="en"?" active":"")+'" data-lang="en" onclick="switchLanguage(\'en\')">EN</button><button class="lang-btn'+(le==="hi"?" active":"")+'" data-lang="hi" onclick="switchLanguage(\'hi\')">‡§π‡§ø</button><button class="lang-btn'+(le==="te"?" active":"")+'" data-lang="te" onclick="switchLanguage(\'te\')">‡∞§‡±Ü</button>';var a=t.querySelector(".theme-toggle");a?t.insertBefore(n,a.parentElement):t.appendChild(n),Me()}},500),setTimeout(function(){typeof window.loadMenuRatings=="function"&&window.loadMenuRatings()},2e3),Tn();var e=window.displayCart;typeof e=="function"&&(window.displayCart=function(){e(),ke()})}Object.assign(window,{selectSpice:je,moveCarousel:window.moveCarousel,moveGallerySlide:window.moveGallerySlide,closeLightbox:window.closeLightbox,navigateLightbox:window.navigateLightbox,openVideoLightbox:pn,closeVideoLightbox:yn,openReviewModal:$e,setReviewStar:gn,submitReviews:hn,scheduleReviewPrompt:bn,openComboModal:window.openComboModal,closeComboModal:window.closeComboModal,addComboToCart:window.addComboToCart,getActiveHappyHour:Xe,getRecommendations:Je,showRecommendations:ke,initVoiceOrdering:Ke,toggleVoice:Qe,showVoiceOverlay:Ze,switchLanguage:Ln,applyTranslations:Me,openReferralModal:In,closeReferralModal:xn,generateReferralCode:et,applyReferralAtSignup:Bn,openMyOrders:Sn,closeMyOrders:kn,reorderFromHistory:Mn});en();Qt();Jt();Kt();yt();bt();ht();Bt();ge();Tt();Xt();un();on();cn();Nn();window.displayCart=function(){me(),ke()};window.loadMenuRatings=zt;export{An as __vite_legacy_guard};
//# sourceMappingURL=script.js.map
