function $a(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function V(e){try{return localStorage.getItem(e)}catch(t){return null}}function j(e,t){try{localStorage.setItem(e,t)}catch(n){}}function Ht(e,t){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(function(){t&&(t.textContent="Copied!")}).catch(function(){Ne(e,t)}):Ne(e,t)}function Ne(e,t){var n=document.createElement("textarea");n.value=e,n.style.cssText="position:fixed;opacity:0",document.body.appendChild(n),n.select();try{document.execCommand("copy"),t&&(t.textContent="Copied!")}catch(a){}document.body.removeChild(n)}var qe=0;function G(){qe=window.pageYOffset||document.documentElement.scrollTop,document.body.style.top=-qe+"px",document.body.classList.add("modal-open")}function O(){document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo(0,qe)}Object.assign(window,{safeGetItem:V,safeCopy:Ht,fallbackCopy:Ne,unlockScroll:O});const Ft="rzp_test_1DP5mmOlF5G5ag",_t="+919121004999",zt="AMOGHA CAFE & RESTAURANT",ue=500,me=49;var Z=[{name:"Bronze",min:0,color:"#cd7f32",icon:"ðŸ¥‰"},{name:"Silver",min:500,color:"#c0c0c0",icon:"ðŸ¥ˆ"},{name:"Gold",min:1e3,color:"#D4A017",icon:"ðŸ¥‡"}],Ve=[{days:[1,2,3,4,5],startHour:14,endHour:17,discount:15,label:"Happy Hour â€” 15% OFF!",categories:["beverages"]},{days:[0,1,2,3,4,5,6],startHour:22,endHour:23,discount:20,label:"Late Night Deal â€” 20% OFF!",categories:["all"]}],ve={Raita:40,"Mirchi ka Salan":50,"Veg Manchurian":169,"Paneer 65":189,"Chicken 65":200,"Chicken Hot Wings":220,"Veg Spring Rolls":149,"Chicken Lollipop":230,"Paneer Butter Masala":199,"Dal Tadka":149,"Butter Chicken":249,"Chicken Curry":219,"Mutton Curry":319,"Gongura Chicken":239,"Veg Dum Biryani":199,"Chicken Dum Biryani":249,"Chicken 65 Biryani":249,"Mutton Dum Biryani":349,"Egg Biryani":199,"Paneer Biryani":229,"Paneer Tikka":209,"Chicken Seekh Kebab":229,"Tandoori Chicken":269,"Mutton Seekh Kebab":289,"Veg Hakka Noodles":169,"Chicken Hakka Noodles":199,"Egg Noodles":179,"Schezwan Noodles":189,"Veg Fried Rice":169,"Chicken Fried Rice":199,"Egg Fried Rice":179,"Schezwan Fried Rice":189,"Butter Naan":40,"Garlic Naan":50,"Tandoori Roti":30,"Butter Roti":35,"Laccha Paratha":45,Tea:30,Coffee:40,"Hot Chocolate":60,Lassi:50,Buttermilk:35,"Fresh Lime Soda":45},Ye={en:{home:"Home",about:"About",menu:"Menu",specials:"Specials",gallery:"Gallery",reviews:"Reviews",contact:"Contact",signIn:"Sign In",orderNow:"Order Online",reserveTable:"Reserve Table",addToOrder:"Add to Order",yourOrder:"Your Order",clearCart:"Clear Cart",checkout:"Proceed to Checkout",orderSummary:"Order Summary",yourDetails:"Your Details",payment:"Payment",orderPlaced:"Order Placed!",thankYou:"Thank you! Your order has been received.",fullName:"Full Name",phoneNumber:"Phone Number",deliveryAddress:"Delivery Address",specialInstructions:"Special Instructions (Optional)",ourStory:"Our Story",whyChooseUs:"Why Choose Us?",ourMission:"Our Mission",search:"Search menu...",all:"All",veg:"Veg",nonVeg:"Non-Veg"},hi:{home:"à¤¹à¥‹à¤®",about:"à¤¹à¤®à¤¾à¤°à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚",menu:"à¤®à¥‡à¤¨à¥à¤¯à¥‚",specials:"à¤¸à¥à¤ªà¥‡à¤¶à¤²",gallery:"à¤—à¥ˆà¤²à¤°à¥€",reviews:"à¤¸à¤®à¥€à¤•à¥à¤·à¤¾",contact:"à¤¸à¤‚à¤ªà¤°à¥à¤•",signIn:"à¤¸à¤¾à¤‡à¤¨ à¤‡à¤¨",orderNow:"à¤‘à¤°à¥à¤¡à¤° à¤•à¤°à¥‡à¤‚",reserveTable:"à¤Ÿà¥‡à¤¬à¤² à¤¬à¥à¤• à¤•à¤°à¥‡à¤‚",addToOrder:"à¤‘à¤°à¥à¤¡à¤° à¤®à¥‡à¤‚ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",yourOrder:"à¤†à¤ªà¤•à¤¾ à¤‘à¤°à¥à¤¡à¤°",clearCart:"à¤•à¤¾à¤°à¥à¤Ÿ à¤–à¤¾à¤²à¥€ à¤•à¤°à¥‡à¤‚",checkout:"à¤šà¥‡à¤•à¤†à¤‰à¤Ÿ à¤•à¤°à¥‡à¤‚",orderSummary:"à¤‘à¤°à¥à¤¡à¤° à¤¸à¤¾à¤°à¤¾à¤‚à¤¶",yourDetails:"à¤†à¤ªà¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",payment:"à¤­à¥à¤—à¤¤à¤¾à¤¨",orderPlaced:"à¤‘à¤°à¥à¤¡à¤° à¤¹à¥‹ à¤—à¤¯à¤¾!",thankYou:"à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦! à¤†à¤ªà¤•à¤¾ à¤‘à¤°à¥à¤¡à¤° à¤®à¤¿à¤² à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤",fullName:"à¤ªà¥‚à¤°à¤¾ à¤¨à¤¾à¤®",phoneNumber:"à¤«à¥‹à¤¨ à¤¨à¤‚à¤¬à¤°",deliveryAddress:"à¤¡à¤¿à¤²à¥€à¤µà¤°à¥€ à¤ªà¤¤à¤¾",specialInstructions:"à¤µà¤¿à¤¶à¥‡à¤· à¤¨à¤¿à¤°à¥à¤¦à¥‡à¤¶ (à¤µà¥ˆà¤•à¤²à¥à¤ªà¤¿à¤•)",ourStory:"à¤¹à¤®à¤¾à¤°à¥€ à¤•à¤¹à¤¾à¤¨à¥€",whyChooseUs:"à¤¹à¤®à¥‡à¤‚ à¤•à¥à¤¯à¥‹à¤‚ à¤šà¥à¤¨à¥‡à¤‚?",ourMission:"à¤¹à¤®à¤¾à¤°à¤¾ à¤®à¤¿à¤¶à¤¨",search:"à¤®à¥‡à¤¨à¥à¤¯à¥‚ à¤–à¥‹à¤œà¥‡à¤‚...",all:"à¤¸à¤­à¥€",veg:"à¤¶à¤¾à¤•à¤¾à¤¹à¤¾à¤°à¥€",nonVeg:"à¤®à¤¾à¤‚à¤¸à¤¾à¤¹à¤¾à¤°à¥€"},te:{home:"à°¹à±‹à°®à±",about:"à°®à°¾ à°—à±à°°à°¿à°‚à°šà°¿",menu:"à°®à±†à°¨à±‚",specials:"à°¸à±à°ªà±†à°·à°²à±",gallery:"à°—à±à°¯à°¾à°²à°°à±€",reviews:"à°¸à°®à±€à°•à±à°·à°²à±",contact:"à°¸à°‚à°ªà±à°°à°¦à°¿à°‚à°šà°‚à°¡à°¿",signIn:"à°¸à±ˆà°¨à± à°‡à°¨à±",orderNow:"à°†à°°à±à°¡à°°à± à°šà±‡à°¯à°‚à°¡à°¿",reserveTable:"à°Ÿà±‡à°¬à±à°²à± à°¬à±à°•à± à°šà±‡à°¯à°‚à°¡à°¿",addToOrder:"à°†à°°à±à°¡à°°à±â€Œà°²à±‹ à°œà±‹à°¡à°¿à°‚à°šà°‚à°¡à°¿",yourOrder:"à°®à±€ à°†à°°à±à°¡à°°à±",clearCart:"à°•à°¾à°°à±à°Ÿà± à°–à°¾à°³à±€ à°šà±‡à°¯à°‚à°¡à°¿",checkout:"à°šà±†à°•à± à°…à°µà±à°Ÿà±",orderSummary:"à°†à°°à±à°¡à°°à± à°¸à°¾à°°à°¾à°‚à°¶à°‚",yourDetails:"à°®à±€ à°µà°¿à°µà°°à°¾à°²à±",payment:"à°šà±†à°²à±à°²à°¿à°‚à°ªà±",orderPlaced:"à°†à°°à±à°¡à°°à± à°ªà±‚à°°à±à°¤à°¯à°¿à°‚à°¦à°¿!",thankYou:"à°§à°¨à±à°¯à°µà°¾à°¦à°¾à°²à±! à°®à±€ à°†à°°à±à°¡à°°à± à°…à°‚à°¦à°¿à°‚à°¦à°¿.",fullName:"à°ªà±‚à°°à±à°¤à°¿ à°ªà±‡à°°à±",phoneNumber:"à°«à±‹à°¨à± à°¨à°‚à°¬à°°à±",deliveryAddress:"à°¡à±†à°²à°¿à°µà°°à±€ à°šà°¿à°°à±à°¨à°¾à°®à°¾",specialInstructions:"à°ªà±à°°à°¤à±à°¯à±‡à°• à°¸à±‚à°šà°¨à°²à± (à°à°šà±à°›à°¿à°•à°‚)",ourStory:"à°®à°¾ à°•à°¥",whyChooseUs:"à°®à°®à±à°®à°²à±à°¨à°¿ à°Žà°‚à°¦à±à°•à± à°Žà°‚à°šà±à°•à±‹à°µà°¾à°²à°¿?",ourMission:"à°®à°¾ à°²à°•à±à°·à±à°¯à°‚",search:"à°®à±†à°¨à±‚ à°µà±†à°¤à°•à°‚à°¡à°¿...",all:"à°…à°¨à±à°¨à±€",veg:"à°¶à°¾à°•à°¾à°¹à°¾à°°à°‚",nonVeg:"à°®à°¾à°‚à°¸à°¾à°¹à°¾à°°à°‚"}},ee=[],Xe={"Chicken Dum Biryani":["Raita","Mirchi ka Salan","Buttermilk"],"Chicken 65 Biryani":["Raita","Mirchi ka Salan","Fresh Lime Soda"],"Veg Dum Biryani":["Raita","Dal Tadka","Lassi"],"Mutton Dum Biryani":["Raita","Mirchi ka Salan","Buttermilk"],"Egg Biryani":["Raita","Buttermilk"],"Paneer Biryani":["Raita","Dal Tadka"],"Butter Chicken":["Butter Naan","Garlic Naan","Laccha Paratha"],"Paneer Butter Masala":["Butter Naan","Garlic Naan","Tandoori Roti"],"Chicken Curry":["Butter Naan","Butter Roti","Veg Fried Rice"],"Mutton Curry":["Butter Naan","Laccha Paratha"],"Gongura Chicken":["Butter Naan","Tandoori Roti"],"Dal Tadka":["Butter Naan","Tandoori Roti","Veg Fried Rice"],"Chicken 65":["Chicken Dum Biryani","Fresh Lime Soda"],"Paneer 65":["Veg Dum Biryani","Lassi"],"Veg Manchurian":["Veg Hakka Noodles","Veg Fried Rice"],"Chicken Hot Wings":["Fresh Lime Soda","Chicken Hakka Noodles"],"Chicken Lollipop":["Chicken Dum Biryani","Fresh Lime Soda"],"Veg Hakka Noodles":["Veg Manchurian","Veg Spring Rolls"],"Chicken Hakka Noodles":["Chicken 65","Fresh Lime Soda"]};function B(){return window.db}function ge(e){for(var t=Z.length-1;t>=0;t--)if(e>=Z[t].min)return Z[t];return Z[0]}function Gt(e){var t=M();if(t){var n=Math.floor(e/10),a=new Date().toISOString().split("T")[0],o=t.orderDates||[];if(o[o.length-1]!==a&&o.push(a),o.length>=3){var r=o.slice(-3),i=new Date(r[0]),s=new Date(r[1]),l=new Date(r[2]),c=(s-i)/864e5,u=(l-s)/864e5;c===1&&u===1&&(n=n*2)}o.length>30&&(o=o.slice(-30));var v=(t.loyaltyPoints||0)+n,b=ge(t.loyaltyPoints||0),h=ge(v);t.loyaltyPoints=v,t.loyaltyTier=h.name,t.orderDates=o,H(t);var x=B();x&&x.collection("users").doc(t.phone).update({loyaltyPoints:v,loyaltyTier:h.name,orderDates:o}).catch(function(I){console.error("Loyalty tier update error:",I)});var C=n>Math.floor(e/10)?" (2x Streak Bonus!)":"";L("+"+n+" loyalty points earned!"+C),h.name!==b.name&&setTimeout(function(){L("Congratulations! You are now "+h.icon+" "+h.name+" tier!"),typeof launchConfetti=="function"&&launchConfetti()},2e3),De()}}function De(){var e=document.getElementById("loyalty-widget");if(e){var t=M();if(!t){e.style.display="none";return}var n=t.loyaltyPoints||0,a=ge(n);e.style.display="flex",e.innerHTML='<span class="loyalty-icon">'+a.icon+'</span><span class="loyalty-pts">'+n+" pts</span>",e.title=a.name+" Tier | "+n+" Points | Redeem 100pts = Rs.10 off",e.style.cursor="pointer",e.onclick=function(){Ke()}}}function Ke(){var e=M();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}for(var t=e.loyaltyPoints||0,n=ge(t),a=null,o=0;o<Z.length;o++)if(Z[o].min>t){a=Z[o];break}var r=document.getElementById("loyalty-modal");r||(r=document.createElement("div"),r.id="loyalty-modal",r.className="modal",r.innerHTML='<div class="modal-content loyalty-modal-content"></div>',document.body.appendChild(r),r.addEventListener("click",function(c){c.target===r&&(r.style.display="none")}));var i=a?Math.min(100,(t-n.min)/(a.min-n.min)*100):100,s=a?'<p class="loyalty-next">'+(a.min-t)+" points to "+a.icon+" "+a.name+"</p>":'<p class="loyalty-next">You have reached the highest tier!</p>',l=Math.floor(t/100)*10;r.querySelector(".loyalty-modal-content").innerHTML='<span class="close" onclick="document.getElementById(\'loyalty-modal\').style.display=\'none\'">&times;</span><div class="loyalty-header"><div class="loyalty-tier-badge" style="background:'+n.color+'">'+n.icon+" "+n.name+"</div><h2>"+t+' Points</h2></div><div class="loyalty-progress-bar"><div class="loyalty-progress-fill" style="width:'+i+"%;background:"+n.color+'"></div></div>'+s+'<div class="loyalty-info"><div class="loyalty-info-row"><span>Redeemable Value</span><span>Rs.'+l+'</span></div><div class="loyalty-info-row"><span>Points per Rs.10 spent</span><span>1 point</span></div><div class="loyalty-info-row"><span>3-Day Streak Bonus</span><span>2x points</span></div></div><div class="loyalty-tiers-list">'+Z.map(function(c){var u=c.name===n.name?" active":"";return'<div class="loyalty-tier-item'+u+'"><span>'+c.icon+" "+c.name+"</span><span>"+c.min+"+ pts</span></div>"}).join("")+"</div>",r.style.display="block"}function Ut(){var e=document.getElementById("loyalty-modal");e&&(e.style.display="none")}function Wt(){setTimeout(De,500)}function Qe(e){if(!e||!e.dob)return!1;var t=new Date,n=new Date(e.dob);return t.getMonth()===n.getMonth()}function Se(e){if(!(!e||!Qe(e))&&!document.getElementById("birthday-banner")){var t=(e.name||"Guest").split(" ")[0],n=document.createElement("div");n.id="birthday-banner",n.className="birthday-banner",n.innerHTML='<span class="birthday-banner-icon">&#127874;</span><span class="birthday-banner-text">Happy Birthday, '+t+'! Enjoy special offers this month!</span><button class="birthday-banner-close" onclick="closeBirthdayBanner()">&times;</button>';var a=document.querySelector("header")||document.querySelector("nav");a&&a.nextSibling?a.parentNode.insertBefore(n,a.nextSibling):document.body.insertBefore(n,document.body.firstChild)}}function Vt(){var e=document.getElementById("birthday-banner");e&&(e.style.opacity="0",e.style.transform="translateY(-100%)",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},400))}Object.assign(window,{openLoyaltyModal:Ke,closeLoyaltyModal:Ut,updateLoyaltyWidget:De,awardLoyaltyPoints:Gt,getLoyaltyTier:ge,checkBirthdayRewards:Qe,showBirthdayBanner:Se,closeBirthdayBanner:Vt});function M(){try{const e=V("amoghaUser");return e?JSON.parse(e):null}catch(e){return null}}function H(e){j("amoghaUser",JSON.stringify(e));var t=B();e&&e.phone&&typeof t<"u"&&t&&!window._notifListenerActive&&(window._notifListenerActive=!0,t.collection("notifications").where("userPhone","==",e.phone).where("read","==",!1).onSnapshot(function(n){n.docChanges().forEach(function(a){if(a.type==="added"){var o=a.doc.data();typeof sendPushNotification=="function"&&sendPushNotification(o.title,o.body),a.doc.ref.update({read:!0})}})},function(n){console.error("Notification listener error:",n)}))}function Yt(){const e=M();if(e){confirm("Signed in as "+(e.name||"Guest")+"\n\nDo you want to sign out?")&&et();return}document.getElementById("auth-modal").style.display="block",G(),Ze("signup")}function oe(){document.getElementById("auth-modal").style.display="none",O(),document.getElementById("signup-name").value="",document.getElementById("signup-phone").value="",document.getElementById("signup-password").value="",document.getElementById("signin-phone").value="",document.getElementById("signin-password").value="",document.getElementById("signup-msg").textContent="",document.getElementById("signup-msg").className="auth-msg",document.getElementById("signin-msg").textContent="",document.getElementById("signin-msg").className="auth-msg",document.getElementById("forgot-phone").value="",document.getElementById("forgot-name").value="",document.getElementById("forgot-new-password").value="",document.getElementById("forgot-confirm-password").value="",document.getElementById("forgot-msg").textContent="",document.getElementById("forgot-msg").className="auth-msg",document.getElementById("forgot-step-1").style.display="",document.getElementById("forgot-step-2").style.display="none",Ee=null}function Ze(e){document.querySelectorAll(".auth-view").forEach(t=>t.classList.remove("active")),document.getElementById("auth-"+e).classList.add("active")}function jt(){var e=document.getElementById("signup-name").value.trim(),t=document.getElementById("signup-phone").value.trim(),n=document.getElementById("signup-password").value,a=document.getElementById("signup-msg");if(!e){a.textContent="Please enter your name.",a.className="auth-msg error";return}if(!/^\d{10}$/.test(t)){a.textContent="Please enter a valid 10-digit phone number.",a.className="auth-msg error";return}if(!/^\d{4}$/.test(n)){a.textContent="Please enter a 4-digit PIN.",a.className="auth-msg error";return}a.textContent="Creating account...",a.className="auth-msg";var o=B();if(typeof o>"u"||!o){a.textContent="Service unavailable. Please refresh and try again.",a.className="auth-msg error";return}o.collection("users").doc(t).get().then(function(r){if(r.exists){a.textContent="This phone number is already registered. Please sign in.",a.className="auth-msg error";return}var i={name:e,phone:t,pin:n,usedWelcomeBonus:!1,createdAt:new Date().toISOString()};return o.collection("users").doc(t).set(i).then(function(){try{H(i),ke(i),ye(),oe(),L("Welcome, "+(e||"Guest")+"! 25% off applied to your first order!"),setTimeout(function(){Se(i)},500);var s=document.getElementById("signup-referral"),l=s?s.value.trim():"";l&&setTimeout(function(){typeof applyReferralAtSignup=="function"&&applyReferralAtSignup(l)},2e3)}catch(c){console.error("SignUp UI error:",c),oe(),L("Account created successfully!")}})}).catch(function(r){console.error("SignUp error:",r);var i=r.code==="permission-denied"?"Access denied. Please contact support.":"Connection error. Please check your internet and try again.";a.textContent=i+" ("+(r.code||r.message||"unknown")+")",a.className="auth-msg error"})}function $t(){var e=document.getElementById("signin-phone").value.trim(),t=document.getElementById("signin-password").value,n=document.getElementById("signin-msg");if(!/^\d{10}$/.test(e)){n.textContent="Please enter a valid 10-digit phone number.",n.className="auth-msg error";return}if(!/^\d{4}$/.test(t)){n.textContent="Please enter your 4-digit PIN.",n.className="auth-msg error";return}n.textContent="Signing in...",n.className="auth-msg";var a=B();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(e).get().then(function(o){if(!o.exists){n.textContent="No account found with this number. Please sign up.",n.className="auth-msg error";return}var r=o.data();if((r.pin||r.password)!==t){n.textContent="Incorrect PIN. Please try again.",n.className="auth-msg error";return}try{H(r),ke(r),ye(),oe();var i=r.name||"Guest",s=r.usedWelcomeBonus?"":" Your 25% welcome bonus is still active!";L("Welcome back, "+i+"!"+s),setTimeout(function(){Se(r)},500)}catch(l){console.error("SignIn UI error:",l),oe(),L("Signed in successfully!")}}).catch(function(o){console.error("SignIn error:",o),n.textContent="Connection error. Please check your internet and try again.",n.className="auth-msg error"})}var Ee=null;function Jt(){var e=document.getElementById("forgot-phone").value.trim(),t=document.getElementById("forgot-name").value.trim(),n=document.getElementById("forgot-msg");if(!/^\d{10}$/.test(e)){n.textContent="Please enter a valid 10-digit phone number.",n.className="auth-msg error";return}if(!t){n.textContent="Please enter your registered name.",n.className="auth-msg error";return}n.textContent="Verifying...",n.className="auth-msg";var a=B();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(e).get().then(function(o){if(!o.exists){n.textContent="No account found with this phone number.",n.className="auth-msg error";return}var r=o.data();if(r.name.toLowerCase()!==t.toLowerCase()){n.textContent="Name does not match our records.",n.className="auth-msg error";return}Ee=e,n.textContent="",n.className="auth-msg",document.getElementById("forgot-step-1").style.display="none",document.getElementById("forgot-step-2").style.display="block"}).catch(function(o){console.error("Forgot password error:",o),n.textContent=o.code==="permission-denied"?"Access denied. Please contact support.":"Network error. Please check your connection and try again.",n.className="auth-msg error"})}function Xt(){var e=document.getElementById("forgot-new-password").value,t=document.getElementById("forgot-confirm-password").value,n=document.getElementById("forgot-msg");if(!/^\d{4}$/.test(e)){n.textContent="Please enter a 4-digit PIN.",n.className="auth-msg error";return}if(e!==t){n.textContent="PINs do not match.",n.className="auth-msg error";return}n.textContent="Resetting PIN...",n.className="auth-msg";var a=B();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(Ee).update({pin:e}).then(function(){Ee=null,n.textContent="",n.className="auth-msg",oe(),L("PIN reset successful! Please sign in.")}).catch(function(){n.textContent="Something went wrong. Please try again.",n.className="auth-msg error"})}function et(){try{localStorage.removeItem("amoghaUser")}catch(t){}const e=document.getElementById("signin-btn");e.className="signin-nav-btn",e.innerHTML='<svg class="signin-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg><span id="signin-text">Sign In</span>',ye(),typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget(),L("You have been signed out.")}function ke(e){const t=document.getElementById("signin-btn");if(!(!t||!e)){var n=e.name||"Guest",a=n.split(" ").filter(function(o){return o.length>0}).map(function(o){return o[0]}).join("").toUpperCase().slice(0,2)||"G";t.className="signin-nav-btn signed-in",t.innerHTML='<span class="user-avatar">'+a+'</span><span id="signin-text">'+n.split(" ")[0]+'</span><div class="user-dropdown" id="user-dropdown"><a href="#" onclick="event.preventDefault();event.stopPropagation();openProfileModal()">My Profile</a><a href="#" onclick="event.preventDefault();event.stopPropagation();signOut()">Sign Out</a></div>',t.onclick=function(o){o.preventDefault();var r=document.getElementById("user-dropdown");r&&r.classList.toggle("show")},typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget()}}function Kt(e,t){var n=document.getElementById(e),a=t.querySelector(".eye-open"),o=t.querySelector(".eye-closed");n.type==="password"?(n.type="text",a.style.display="none",o.style.display=""):(n.type="password",a.style.display="",o.style.display="none")}function L(e){var t=document.getElementById("auth-toast");t||(t=document.createElement("div"),t.id="auth-toast",document.body.appendChild(t)),t.textContent=e,t.classList.remove("visible"),t.offsetWidth,t.classList.add("visible"),setTimeout(function(){t.classList.remove("visible")},4e3)}function ye(){var e=document.getElementById("carousel-greeting");if(e){var t=M();t&&t.name?e.textContent="Hey "+t.name.split(" ")[0]+", ":e.textContent=""}}function Qt(){try{const t=V("amoghaUser");if(t){var e=JSON.parse(t);ke(e),setTimeout(function(){Se(e)},1e3)}ye()}catch(t){console.error("Auth restore error:",t)}window.addEventListener("click",function(t){var n=document.getElementById("auth-modal");t.target===n&&oe();var a=document.getElementById("user-dropdown");a&&a.classList.contains("show")&&!t.target.closest(".signin-nav-btn")&&a.classList.remove("show")}),setTimeout(function(){var t=document.getElementById("signup-form");if(!(!t||t.dataset.refEnhanced==="true")){t.dataset.refEnhanced="true";var n=t.querySelector(".password-field");if(n){var a=document.createElement("input");a.type="text",a.id="signup-referral",a.placeholder="Referral Code (Optional)",a.maxLength=20,a.style.textTransform="uppercase",n.after(a)}}},1e3),setTimeout(function(){var t=document.getElementById("signin-btn");if(t){var n=document.createElement("div");n.id="user-dropdown",n.className="user-dropdown",n.innerHTML='<button onclick="openMyOrders(); closeUserDropdown();">My Orders</button><button onclick="openReferralModal(); closeUserDropdown();">Refer a Friend</button><button onclick="openLoyaltyModal(); closeUserDropdown();">Loyalty Points</button><button onclick="openAuthModal(); closeUserDropdown();">Sign Out</button>',t.parentElement.style.position="relative",t.parentElement.appendChild(n),t.addEventListener("click",function(a){var o=M();o&&(a.preventDefault(),a.stopPropagation(),n.classList.toggle("visible"))}),document.addEventListener("click",function(a){t.parentElement.contains(a.target)||n.classList.remove("visible")})}},1e3)}function Zt(){var e=document.getElementById("user-dropdown");e&&e.classList.remove("visible")}Object.assign(window,{openAuthModal:Yt,closeAuthModal:oe,switchAuthView:Ze,handleSignUp:jt,handleSignIn:$t,handleForgotPassword:Jt,handleResetPassword:Xt,signOut:et,updateSignInUI:ke,togglePassword:Kt,showAuthToast:L,updateCarouselGreeting:ye,closeUserDropdown:Zt});let S=[];var ie=[];function en(){try{var e=localStorage.getItem("addons_cache");if(e){var t=JSON.parse(e);if(t.ts&&Date.now()-t.ts<6e5&&t.data){ie.push(...t.data);return}}}catch(a){}var n=B();n&&n.collection("addons").where("active","==",!0).orderBy("sortOrder").get().then(function(a){a.forEach(function(o){ie.push(o.data())});try{localStorage.setItem("addons_cache",JSON.stringify({ts:Date.now(),data:ie}))}catch(o){}}).catch(function(){})}var U=null,te=[];function tn(){try{const t=V("amoghaCart");if(t){var e=JSON.parse(t);S.length=0,e.forEach(function(n){S.push(n)}),X()}}catch(t){S.length=0}}function ne(){j("amoghaCart",JSON.stringify(S))}function X(){const e=S.reduce((n,a)=>n+a.quantity,0);var t=document.getElementById("cart-count");t&&(t.textContent=e)}function de(e,t,n){S.length===0&&!M()&&cn();var a="medium";if(n){var o=n.closest(".menu-item-card");if(o){var r=o.querySelector(".spice-level.active");r&&(a=r.textContent.trim().toLowerCase())}}if(ie.length>0){U={name:e,price:parseFloat(t),spiceLevel:a,btnEl:n},te.length=0,an(e,parseFloat(t));return}Ie(e,parseFloat(t),a,[],n)}function nn(e){var t=document.getElementById("cart-icon");if(!(!e||!t)){var n=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=document.createElement("div");o.className="cart-fly-item",o.style.left=n.left+n.width/2-6+"px",o.style.top=n.top+n.height/2-6+"px",document.body.appendChild(o),requestAnimationFrame(function(){o.style.transition="left 0.55s cubic-bezier(0.4,0,0.2,1), top 0.55s cubic-bezier(0.4,0,0.2,1), opacity 0.55s, transform 0.55s",o.style.left=a.left+a.width/2-6+"px",o.style.top=a.top+a.height/2-6+"px",o.style.opacity="0",o.style.transform="scale(0.3)"}),setTimeout(function(){o.remove()},600),t.classList.remove("cart-jiggle"),t.offsetWidth,t.classList.add("cart-jiggle"),setTimeout(function(){t.classList.remove("cart-jiggle")},400)}}function Ie(e,t,n,a,o){var r=a.map(function(s){return s.name}).sort().join(","),i=S.find(function(s){var l=(s.addons||[]).map(function(c){return c.name}).sort().join(",");return s.name===e&&s.spiceLevel===n&&l===r});i?i.quantity++:S.push({name:e,price:t,quantity:1,spiceLevel:n,addons:a||[]}),o&&(o.classList.remove("cart-adding"),o.offsetWidth,o.classList.add("cart-adding"),nn(o)),X(),ne(),re(e),ae(),Re();try{window.analytics&&window.analytics.logEvent("add_to_cart",{item_name:e,value:t})}catch(s){}}function an(e,t){var n=document.getElementById("addon-picker-overlay"),a=document.getElementById("addon-item-name"),o=document.getElementById("addon-sheet-list");a.textContent=e+" â€” â‚¹"+t,o.innerHTML=ie.map(function(r,i){return'<div class="addon-option" data-idx="'+i+'" onclick="toggleAddonOption(this, '+i+')"><div class="addon-checkbox"></div><div class="addon-option-info"><div class="addon-option-name">'+r.name+'</div><div class="addon-option-cat">'+(r.category||"")+'</div></div><div class="addon-option-price">+â‚¹'+r.price+"</div></div>"}).join(""),tt(),n.style.display="flex"}function on(e,t){e.classList.toggle("selected");var n=ie[t],a=e.querySelector(".addon-checkbox");if(e.classList.contains("selected"))te.push({name:n.name,price:n.price}),a.textContent="âœ“";else{var o=te.findIndex(function(r){return r.name===n.name});o!==-1&&te.splice(o,1),a.textContent=""}tt()}function tt(){if(U){var e=te.reduce(function(n,a){return n+a.price},0),t=U.price+e;document.getElementById("addon-total").textContent="Total: â‚¹"+t}}function rn(){document.getElementById("addon-picker-overlay").style.display="none",U&&(Ie(U.name,U.price,U.spiceLevel,[]),U=null,te.length=0)}function sn(){if(U){var e=U,t=te.slice();U=null,te.length=0,document.getElementById("addon-picker-overlay").style.display="none",Ie(e.name,e.price,e.spiceLevel,t)}}function ln(e){var t=e.closest(".add-to-cart")||e,n=document.createElement("span");n.className="atc-checkmark",n.textContent="âœ“",t.appendChild(n),setTimeout(function(){n.remove()},800)}function cn(){var e=document.getElementById("signin-prompt");e||(e=document.createElement("div"),e.id="signin-prompt",e.innerHTML='<div class="signin-prompt-content"><span class="signin-prompt-icon">ðŸŽ‰</span><div class="signin-prompt-text"><strong>Sign up & get 25% OFF!</strong><span>Create an account to unlock your welcome bonus</span></div><button class="signin-prompt-btn" onclick="closeSignInPrompt(); openAuthModal();">Sign Up</button><button class="signin-prompt-close" onclick="closeSignInPrompt()">&times;</button></div>',document.body.appendChild(e)),e.classList.remove("visible"),e.offsetWidth,e.classList.add("visible"),setTimeout(function(){nt()},8e3)}function nt(){var e=document.getElementById("signin-prompt");e&&e.classList.remove("visible")}function re(e){document.querySelectorAll(".add-to-cart").forEach(t=>{if(t.dataset.item===e){const n=S.find(o=>o.name===e),a=n?n.quantity:0;a>0&&!t.classList.contains("has-qty")?(t.classList.add("has-qty"),t.innerHTML='<span class="qty-minus" data-item="'.concat(e,'">âˆ’</span><span class="qty-count">').concat(a,'</span><span class="qty-plus" data-item="').concat(e,'">+</span>')):a>0?t.querySelector(".qty-count").textContent=a:(t.classList.remove("has-qty"),t.innerHTML="Add to Order")}})}function dn(){S.forEach(e=>re(e.name))}function ae(){let e=document.getElementById("floating-cart");e||(e=document.createElement("div"),e.id="floating-cart",e.innerHTML='\n            <div class="fc-header">\n                <span class="fc-title">Your Order</span>\n                <span class="fc-close" onclick="closeFloatingCart()">&times;</span>\n            </div>\n            <div class="fc-items"></div>\n            <div class="fc-footer">\n                <span class="fc-total"></span>\n                <button class="fc-checkout" onclick="document.getElementById(\'cart-icon\').click(); closeFloatingCart();">View Cart</button>\n            </div>\n        ',document.body.appendChild(e));const t=e.querySelector(".fc-items"),n=e.querySelector(".fc-total");if(S.length===0){e.classList.remove("visible"),xe();return}let a="",o=0;S.forEach(r=>{const i=r.price*r.quantity;o+=i,a+='<div class="fc-item"><span>'.concat(r.name," x").concat(r.quantity,"</span><span>â‚¹").concat(i,"</span></div>")}),t.innerHTML=a,n.textContent="Total: â‚¹".concat(o),e.classList.add("visible"),xe()}function Re(){var e=document.getElementById("floating-cart-bar");if(e){var t=S.reduce(function(i,s){return i+s.quantity},0),n=S.reduce(function(i,s){return i+s.price*s.quantity},0);if(t===0){e.classList.remove("visible");return}var a=e.querySelector(".floating-cart-count"),o=e.querySelector(".floating-cart-total"),r=e.querySelector(".floating-cart-label");a&&(a.textContent=t),o&&(o.textContent="â‚¹"+n),r&&(r.textContent=t===1?"1 item":t+" items"),e.classList.add("visible")}}function xe(e){var t=document.getElementById("cart-fab");t||(t=document.createElement("div"),t.id="cart-fab",t.className="cart-fab",t.innerHTML='<svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg><span class="cart-fab-badge">0</span>',t.addEventListener("click",function(){var o=document.getElementById("cart-icon");o&&o.click()}),document.body.appendChild(t));var n=t.querySelector(".cart-fab-badge"),a=S.reduce(function(o,r){return o+r.quantity},0);a>0?(n.textContent=a,t.classList.add("visible"),t.classList.remove("pop"),t.offsetWidth,t.classList.add("pop")):t.classList.remove("visible")}function un(){const e=document.getElementById("floating-cart");e&&e.classList.remove("visible")}function he(){const e=document.getElementById("cart-items");if(!e)return;if(S.length===0){e.innerHTML='<div class="empty-cart">Your cart is empty</div>';var t=document.getElementById("subtotal-amount"),n=document.getElementById("total-amount");t&&(t.textContent="0.00"),n&&(n.textContent="0.00");return}let a="",o=0;S.forEach((c,u)=>{const v=(c.addons||[]).reduce((C,I)=>C+I.price,0),b=(c.price+v)*c.quantity;o+=b;const h=c.spiceLevel&&c.spiceLevel!=="medium"?' <span style="font-size:0.7rem;color:#e67e22">('+c.spiceLevel+")</span>":"",x=(c.addons||[]).map(C=>'<span style="font-size:0.7rem;color:var(--gold,#D4A017)">+ '+C.name+" â‚¹"+C.price+"</span>").join(" ");a+='\n            <div class="cart-item">\n                <div class="cart-item-info">\n                    <div class="cart-item-name">'.concat(c.name).concat(h,"</div>\n                    ").concat(x?'<div style="margin-top:2px">'+x+"</div>":"",'\n                    <div class="cart-item-price">â‚¹').concat((c.price+v).toFixed(2),'</div>\n                </div>\n                <div class="cart-item-quantity">\n                    <button class="qty-btn" onclick="updateQuantity(').concat(u,', -1)">-</button>\n                    <span>').concat(c.quantity,'</span>\n                    <button class="qty-btn" onclick="updateQuantity(').concat(u,', 1)">+</button>\n                </div>\n                <button class="remove-item" onclick="removeItem(').concat(u,')">Remove</button>\n            </div>\n        ')}),e.innerHTML=a;const r=o>=ue?0:me,i=o+r;var s=document.getElementById("subtotal-amount"),l=document.getElementById("total-amount");s&&(s.textContent=o.toFixed(2)),l&&(l.textContent=i.toFixed(2))}function mn(e,t){const n=S[e].name;S[e].quantity+=t,S[e].quantity<=0&&S.splice(e,1),X(),ne(),he(),re(n),ae()}function fn(e){const t=S[e].name;S.splice(e,1),X(),ne(),he(),re(t),ae()}function at(){if(confirm("Are you sure you want to clear your cart?")){const e=S.map(t=>t.name);S.length=0,X(),ne(),he(),e.forEach(t=>re(t)),ae(),document.getElementById("cart-modal").style.display="none",O()}}function pn(){var e=document.getElementById("cart-icon"),t=document.getElementById("cart-modal");e&&e.addEventListener("click",r=>{r.preventDefault(),he(),t&&(t.style.display="block"),G()});var n=document.querySelectorAll(".close");n.forEach(r=>{r.addEventListener("click",()=>{if(!r.closest("#auth-modal")){t&&(t.style.display="none");var i=document.getElementById("reservation-modal");i&&(i.style.display="none"),O()}})}),window.addEventListener("click",r=>{r.target===t&&(t.style.display="none",O()),r.target===document.getElementById("reservation-modal")&&(document.getElementById("reservation-modal").style.display="none",O())}),document.addEventListener("click",r=>{if(r.target.classList.contains("qty-plus")){const i=r.target.dataset.item,s=r.target.closest(".add-to-cart");de(i,s.dataset.price);return}if(r.target.classList.contains("qty-minus")){const i=r.target.dataset.item,s=S.find(l=>l.name===i);s&&(s.quantity--,s.quantity<=0&&S.splice(S.indexOf(s),1),X(),ne(),re(i),ae());return}if(r.target.classList.contains("add-to-cart")&&!r.target.classList.contains("has-qty")){const i=r.target.dataset.item,s=r.target.dataset.price;de(i,s,r.target),ln(r.target)}});var a=document.getElementById("clear-cart");a&&a.addEventListener("click",at);var o=document.getElementById("checkout");o&&o.addEventListener("click",function(){typeof window.checkout=="function"&&window.checkout()})}Object.assign(window,{addToCart:de,finalizeAddToCart:Ie,updateQuantity:mn,removeItem:fn,clearCart:at,closeAddonPicker:rn,toggleAddonOption:on,confirmAddonSelection:sn,closeFloatingCart:un,closeSignInPrompt:nt,updateFloatingCartBar:Re});var P=null,_=null,ot=500;function He(){var e=S.reduce(function(r,i){return r+i.price*i.quantity},0),t=e>=ue?0:me,n=0,a=e+t;if(P&&(P.type==="percent"?n=Math.floor(e*P.discount/100):P.type==="flat"&&(n=P.discount),n=Math.min(n,e),a=e-n+t),_&&_.balance>0){var o=Math.min(_.balance,a);a=Math.max(0,a-o)}return{subtotal:e,deliveryFee:t,discount:n,total:a}}function vn(e,t){return e?e.active?e.expiresAt&&new Date(e.expiresAt)<new Date?{valid:!1,reason:"This coupon has expired."}:e.usageLimit&&e.usedCount>=e.usageLimit?{valid:!1,reason:"This coupon has reached its usage limit."}:e.minOrder&&t<e.minOrder?{valid:!1,reason:"Minimum order â‚¹"+e.minOrder+" required."}:{valid:!0}:{valid:!1,reason:"This coupon is no longer active."}:{valid:!1,reason:"No coupon"}}function rt(e,t){if(!e)return 0;var n=e.type==="percent"?t*e.discount/100:e.discount;return e.maxDiscount&&e.type==="percent"&&(n=Math.min(n,e.maxDiscount)),n=Math.min(n,t),n}function gn(){if(S.length===0){L("Your cart is empty!");return}if(!M()){document.getElementById("cart-modal").style.display="none",O(),typeof window.openAuthModal=="function"&&window.openAuthModal(),L("Please sign in to continue with your order");return}document.getElementById("cart-modal").style.display="none",G(),typeof window.checkAllergenWarning=="function"?window.checkAllergenWarning(S,function(e){e?Ce():O()}):Ce()}function Ce(){var e=S.reduce(function(x,C){return x+C.price*C.quantity},0),t=e>=ue?0:me,n=e+t,a="";S.forEach(function(x){a+='<div class="co-item"><span>'+x.name+" x"+x.quantity+"</span><span>â‚¹"+x.price*x.quantity+"</span></div>"});var o="";if(typeof window.getUpsellItems=="function"){var r=window.getUpsellItems(S);r&&r.length>0&&(o='<div class="upsell-section" id="upsell-section"><div class="upsell-title">Customers also ordered</div><div class="upsell-items">',r.forEach(function(x){o+='<div class="upsell-card"><div class="upsell-info"><div class="upsell-name">'+x.name+'</div><div class="upsell-reason">'+x.reason+'</div></div><span class="upsell-price">â‚¹'+x.price+'</span><button class="upsell-add-btn" onclick="addUpsellItem(\''+x.name.replace(/'/g,"\\'")+"',"+x.price+')">+ Add</button></div>'}),o+="</div></div>")}document.getElementById("checkout-items").innerHTML=a+o,document.getElementById("co-subtotal").textContent="â‚¹"+e,document.getElementById("co-delivery").textContent=t===0?"FREE":"â‚¹"+t,document.getElementById("co-total").textContent="â‚¹"+n;var i=document.getElementById("loyalty-redeem-btn");if(i){var s=M();if(s&&s.loyaltyPoints>=100){var l=Math.floor(s.loyaltyPoints/100)*10;i.textContent="Redeem "+s.loyaltyPoints+" pts (â‚¹"+l+" off)",i.style.display="block"}else i.style.display="none"}Le(1),document.getElementById("checkout-modal").style.display="block";var c=M(),u=document.getElementById("coupon-code"),v=document.getElementById("coupon-msg");if(c&&!c.usedWelcomeBonus){P={discount:25,type:"percent",label:"25% off (Welcome Bonus!)"},u.value="WELCOME25",v.textContent="Welcome bonus applied! You get 25% off!",v.className="coupon-msg success";var b=e*.25;b=Math.min(b,e);var h=e-b+t;document.getElementById("co-total").textContent="â‚¹"+h.toFixed(0)}else P=null,u.value="",v.textContent="",v.className="coupon-msg"}function yn(){document.getElementById("checkout-modal").style.display="none",O(),document.getElementById("co-name").value="",document.getElementById("co-phone").value="",document.getElementById("co-address").value="",document.getElementById("co-notes").value=""}function Le(e){document.querySelectorAll(".checkout-step").forEach(function(t){t.classList.remove("active")}),document.getElementById("checkout-step-"+e).classList.add("active"),e===3&&Be()}function Be(){var e=He(),t=e.total,n="â‚¹"+t.toFixed(0);document.getElementById("pay-total").textContent=n;var a=document.getElementById("cod-total");a&&(a.textContent=n),it("razorpay")}function it(e){["razorpay","cod"].forEach(function(t){var n=document.getElementById("tab-"+t),a=document.getElementById("pay-panel-"+t);n&&n.classList.toggle("active",t===e),a&&a.classList.toggle("active",t===e)})}function hn(){var e=document.getElementById("co-name").value.trim(),t=document.getElementById("co-phone").value.trim(),n=document.getElementById("co-address").value.trim();if(!e||!t||!n){L("Please fill in all required fields.");return}if(t.length<10){L("Please enter a valid phone number.");return}var a=window.getScheduleInfo?window.getScheduleInfo():null;if(a&&(!a.date||!a.time)){L("Please select both date and time for scheduled order.");return}Le(3)}function bn(){if(typeof Razorpay>"u"){L("Payment gateway loading... please try again");return}var e=He(),t=document.getElementById("co-name").value.trim(),n=document.getElementById("co-phone").value.trim(),a={key:Ft,amount:Math.round(e.total*100),currency:"INR",name:zt,description:"Food Order - Amogha Cafe",image:window.location.origin+"/amogha-logo.png",handler:function(i){var s=i.razorpay_payment_id;Fe("Razorpay",s,"paid")},prefill:{name:t,contact:n,method:"upi"},method:{upi:!0,card:!0,netbanking:!0,wallet:!0},config:{display:{blocks:{upi:{name:"Pay via UPI",instruments:[{method:"upi",flows:["qrcode","collect","intent"]}]}},sequence:["block.upi"],preferences:{show_default_blocks:!0}}},notes:{items:S.map(function(i){return i.name+" x"+i.quantity}).join(", ")},theme:{color:"#D4A017",backdrop_color:"rgba(8,6,4,0.85)"},modal:{ondismiss:function(){var i=document.getElementById("razorpay-pay-btn");i&&(i.disabled=!1,i.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Pay Now')}}},o=document.getElementById("razorpay-pay-btn");o&&(o.disabled=!0,o.innerHTML="Opening payment...");try{var r=new Razorpay(a);r.on("payment.failed",function(i){L("Payment failed: "+(i.error.description||"Please try again"));var s=document.getElementById("razorpay-pay-btn");s&&(s.disabled=!1,s.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Retry Payment')}),r.open()}catch(i){L("Error opening payment: "+i.message),o&&(o.disabled=!1,o.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Pay Now')}}function wn(){Fe("Cash on Delivery",null,"cod-pending")}function Fe(e,t,n){var a=B();if(typeof a>"u"||!a){L("Service unavailable. Please refresh and try again.");return}var o=document.getElementById("co-name").value.trim(),r=document.getElementById("co-phone").value.trim(),i=document.getElementById("co-address").value.trim(),s=document.getElementById("co-notes").value.trim(),l=He(),c=document.getElementById("schedule-order-check"),u=null;if(c&&c.checked){var v=document.getElementById("schedule-date"),b=document.getElementById("schedule-time");v&&b&&v.value&&b.value&&(u=new Date(v.value+"T"+b.value).toISOString())}document.getElementById("confirm-detail").textContent="Payment: "+e+(t?" (Ref: "+t+")":"")+" | Total: â‚¹"+l.total.toFixed(0);var h="*New Order - Amogha Cafe*\n\n";h+="*Customer:* "+o+"\n*Phone:* "+r+"\n*Address:* "+i+"\n",s&&(h+="*Notes:* "+s+"\n"),h+="\n*Items:*\n",S.forEach(function(A){h+="- "+A.name+" x"+A.quantity+" = â‚¹"+A.price*A.quantity+"\n"}),h+="\n*Subtotal:* â‚¹"+l.subtotal,h+="\n*Delivery:* "+(l.deliveryFee===0?"FREE":"â‚¹"+l.deliveryFee),h+="\n*Total:* â‚¹"+l.total.toFixed(0),h+="\n*Payment:* "+e,t&&(h+="\n*Payment Ref:* "+t);var x="https://wa.me/"+_t+"?text="+encodeURIComponent(h);document.getElementById("whatsapp-link").href=x,Le(4);var C=M(),I={customer:o,phone:r,address:i,notes:s,items:S.map(function(A){return{name:A.name,qty:A.quantity,price:A.price,spiceLevel:A.spiceLevel||"medium",addons:A.addons||[]}}),subtotal:l.subtotal,deliveryFee:l.deliveryFee,total:l.total,payment:e,paymentRef:t||null,paymentStatus:n,paymentVerifiedAt:t?new Date().toISOString():null,status:u?"scheduled":"pending",createdAt:new Date().toISOString(),scheduledFor:u||null,userId:C?C.phone:null},N=S.map(function(A){return A.name});a.collection("orders").add(I).then(function(A){try{window.analytics&&window.analytics.logEvent("purchase",{transaction_id:A.id,value:I.total,payment_type:e})}catch(d){}window._lastOrderId=A.id,window._lastOrderTotal=I.total;var D=window.location.origin+"/track/index.html?id="+A.id,R=document.getElementById("order-tracking-link");if(R&&(R.innerHTML='<div style="margin-top:1rem;padding:1rem;background:rgba(212,160,23,0.08);border:1px solid rgba(212,160,23,0.15);border-radius:12px;text-align:center"><p style="font-size:0.82rem;color:#a09080;margin-bottom:0.5rem">Track your order in real-time:</p><a href="'+D+'" target="_blank" rel="noopener noreferrer" style="color:#D4A017;font-weight:600;font-size:0.9rem;word-break:break-all">'+D+"</a><br><button onclick=\"safeCopy('"+D+'\',this)" style="margin-top:0.6rem;padding:0.4rem 1rem;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.78rem">Copy Link</button></div>'),C&&!C.usedWelcomeBonus&&P&&P.label&&P.label.indexOf("Welcome")!==-1&&(C.usedWelcomeBonus=!0,H(C),a.collection("users").doc(C.phone).update({usedWelcomeBonus:!0}).catch(function(d){console.error("Bonus update error:",d)})),P=null,_&&_.code){var $=Math.min(_.balance,I.total);a.collection("giftCards").doc(_.code).update({balance:firebase.firestore.FieldValue.increment(-$),redeemedAt:new Date().toISOString()}).catch(function(d){console.error("Gift card deduction error:",d)}),_=null}if(S.length=0,X(),ne(),N.forEach(function(d){re(d)}),ae(),typeof launchConfetti=="function"&&launchConfetti(),typeof awardLoyaltyPoints=="function"&&awardLoyaltyPoints(I.total),typeof checkAndAwardBadges=="function"){var K=M();K&&checkAndAwardBadges(K,I)}if(C&&a&&a.collection("referrals").where("refereePhone","==",C.phone).where("redeemed","==",!1).limit(1).get().then(function(d){if(!d.empty){var p=d.docs[0],y=p.data().referrerPhone;a.collection("users").doc(y).get().then(function(g){if(g.exists){var w=(g.data().loyaltyPoints||0)+100;a.collection("users").doc(y).update({loyaltyPoints:w}).catch(function(E){console.error("Referrer points error:",E)})}}),p.ref.update({redeemed:!0}).catch(function(g){console.error("Referral redeem error:",g)})}}).catch(function(d){console.error("Referral lookup error:",d)}),typeof scheduleReviewPrompt=="function"&&scheduleReviewPrompt(I.items.map(function(d){return{name:d.name}})),typeof sendPushNotification=="function"&&sendPushNotification("Order Placed!","Your order from Amogha has been placed successfully."),r){var m=r.replace(/\D/g,"");m.length===10&&(m="91"+m);var f="Hi "+o+"! ðŸ™\n\nYour order at *Amogha Cafe & Restaurant* has been placed successfully!\n\n";f+="*Order ID:* "+A.id+"\n",f+="*Items:* "+I.items.map(function(d){return d.name+" x"+d.qty}).join(", ")+"\n",f+="*Total:* â‚¹"+l.total.toFixed(0)+"\n\n",f+="ðŸ“ Track your order: "+window.location.origin+"/track/?id="+A.id+"\n\n",f+="Thank you for dining with us! ðŸ›",window.open("https://wa.me/"+m+"?text="+encodeURIComponent(f),"_blank")}a.collection("inventory").get().then(function(d){var p={};d.forEach(function(w){var E=w.data();p[(E.name||"").toLowerCase()]={id:w.id,qty:E.quantity||0}});var y=a.batch(),g=!1;I.items.forEach(function(w){var E=w.name.toLowerCase();if(p[E]&&p[E].qty>0){var k=a.collection("inventory").doc(p[E].id);y.update(k,{quantity:Math.max(0,p[E].qty-w.qty)}),g=!0}}),g&&y.commit().catch(function(w){console.error("Inventory deduction error:",w)})}).catch(function(d){console.error("Inventory fetch error:",d)})}).catch(function(A){console.error("Order save error:",A),L("Order failed to save. Please try again or check your connection.")})}function En(){var e=document.getElementById("coupon-code"),t=document.getElementById("coupon-msg"),n=e.value.trim().toUpperCase(),a={AMOGHA20:{discount:20,type:"percent",label:"20% off"},WELCOME50:{discount:50,type:"flat",label:"â‚¹50 off"},FIRST10:{discount:10,type:"percent",label:"10% off"},WELCOME25:{discount:25,type:"percent",label:"25% off (Welcome Bonus!)"}};function o(i){P=i,t.textContent="Coupon applied! "+i.label,t.className="coupon-msg success";var s=S.reduce((v,b)=>v+b.price*b.quantity,0),l=s>=ue?0:me,c=rt(i,s),u=s-c+l;document.getElementById("co-total").textContent="â‚¹"+u.toFixed(0)}var r=B();r?r.collection("coupons").doc(n).get().then(function(i){if(i.exists){var s=i.data(),l=S.reduce((u,v)=>u+v.price*v.quantity,0),c=vn(s,l);if(!c.valid){t.textContent=c.reason,t.className="coupon-msg error",P=null;return}o(s),r.collection("coupons").doc(n).update({usedCount:firebase.firestore.FieldValue.increment(1)})}else a[n]?o(a[n]):(P=null,t.textContent="Invalid coupon code. Please check and try again.",t.className="coupon-msg error")}).catch(function(){a[n]?o(a[n]):(P=null,t.textContent="Invalid coupon code.",t.className="coupon-msg error")}):a[n]?o(a[n]):(P=null,t.textContent="Invalid coupon code. Please check and try again.",t.className="coupon-msg error")}function xn(){P=null;var e=document.getElementById("coupon-code"),t=document.getElementById("coupon-msg");e&&(e.value=""),t&&(t.textContent="",t.className="coupon-msg"),Be()}function Cn(){var e=document.getElementById("giftcard-code"),t=document.getElementById("giftcard-msg"),n=e.value.trim().toUpperCase();if(!n){t.textContent="Please enter a gift card code",t.className="coupon-msg error";return}var a=B();if(!a){t.textContent="Service unavailable",t.className="coupon-msg error";return}a.collection("giftCards").doc(n).get().then(function(o){if(!o.exists){t.textContent="Invalid gift card code",t.className="coupon-msg error",_=null;return}var r=o.data();if(!r.active){t.textContent="This gift card is no longer active",t.className="coupon-msg error",_=null;return}if(r.balance<=0){t.textContent="This gift card has no remaining balance",t.className="coupon-msg error",_=null;return}_={code:n,balance:r.balance},t.textContent="Gift card applied! Balance: â‚¹"+r.balance,t.className="coupon-msg success";var i=S.reduce(function(b,h){return b+h.price*h.quantity},0),s=i>=ue?0:me,l=P?rt(P,i):0,c=i-l+s,u=Math.min(r.balance,c),v=c-u;document.getElementById("co-total").textContent="â‚¹"+v.toFixed(0)}).catch(function(o){t.textContent="Error: "+o.message,t.className="coupon-msg error"})}function Sn(){_=null;var e=document.getElementById("giftcard-code"),t=document.getElementById("giftcard-msg");e&&(e.value=""),t&&(t.textContent="",t.className="coupon-msg"),Be()}function kn(){document.getElementById("giftcard-modal").style.display="block",G()}function In(){document.getElementById("giftcard-modal").style.display="none",O()}function Ln(e,t){ot=e,document.querySelectorAll(".gc-amount-btn").forEach(function(n){n.classList.remove("active")}),t&&t.classList.add("active")}function Bn(){var e=document.getElementById("gc-recipient-phone").value.trim(),t=document.getElementById("gc-msg");if(!e||e.length!==10){t.textContent="Please enter a valid 10-digit phone number",t.className="coupon-msg error";return}var n=M(),a=n?n.phone:"guest",o=ot,r="GC-"+Date.now().toString(36).toUpperCase().slice(-4)+"-"+Math.random().toString(36).toUpperCase().slice(2,6);if(typeof Razorpay>"u"){t.textContent="Payment system loading. Please try again.",t.className="coupon-msg error";return}var i=B(),s={key:"rzp_live_bfHYCYWDyoSHFn",amount:o*100,currency:"INR",name:"Amogha Cafe",description:"Gift Card - "+r,image:"https://amogha-cafe.web.app/amogha-logo.png",handler:function(c){i.collection("giftCards").doc(r).set({code:r,amount:o,balance:o,purchaserPhone:a,recipientPhone:e,paymentRef:c.razorpay_payment_id,active:!0,createdAt:new Date().toISOString()}).then(function(){t.textContent="Gift card "+r+" created successfully! Share this code with the recipient.",t.className="coupon-msg success",document.getElementById("gc-recipient-phone").value=""}).catch(function(u){t.textContent="Payment received but error saving: "+u.message,t.className="coupon-msg error"})},prefill:{name:n?n.name:"",contact:a},theme:{color:"#D4A017"}},l=new Razorpay(s);l.open()}function Mn(){var e=M();if(!(!e||!e.loyaltyPoints||e.loyaltyPoints<100)){var t=Math.floor(e.loyaltyPoints/100)*10,n=Math.floor(e.loyaltyPoints/100)*100,a=S.reduce(function(c,u){return c+u.price*u.quantity},0),o=Math.min(t,a);if(!(o<=0)){var r=a>=ue?0:me,i=a-o+r;P={discount:o,type:"flat",label:"Rs."+o+" (Loyalty Points)"},document.getElementById("co-total").textContent="Rs."+i.toFixed(0);var s=document.getElementById("coupon-msg");s.textContent="Redeemed "+n+" points for Rs."+o+" off!",s.className="coupon-msg success",document.getElementById("coupon-code").value="LOYALTY",e.loyaltyPoints-=n,H(e);var l=B();l&&l.collection("users").doc(e.phone).update({loyaltyPoints:e.loyaltyPoints}).catch(function(c){console.error("Loyalty update error:",c)}),typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget()}}}function An(){var e="I just ordered from Amogha Cafe & Restaurant! ðŸ½ï¸ Check them out at https://amoghahotels.com";function t(){var n=M();if(n){var a=[];try{a=JSON.parse(localStorage.getItem("amoghaSharedOrders")||"[]")}catch(i){}Date.now().toString();var o=a.length>0?a[a.length-1]:0;if(!(Date.now()-o<3e5)){a.push(Date.now());try{localStorage.setItem("amoghaSharedOrders",JSON.stringify(a))}catch(i){}n.loyaltyPoints=(n.loyaltyPoints||0)+10,H(n);var r=B();r&&r.collection("users").doc(n.phone).update({loyaltyPoints:n.loyaltyPoints}).catch(function(i){console.error("Share loyalty update error:",i)}),L("Thanks for sharing! +10 loyalty points")}}}navigator.share?navigator.share({text:e}).then(function(){t()}).catch(function(){}):(window.open("https://wa.me/?text="+encodeURIComponent(e),"_blank"),t())}function Tn(e,t){for(var n=!1,a=0;a<S.length;a++)if(S[a].name===e){S[a].quantity++,n=!0;break}n||S.push({name:e,price:t,quantity:1,spiceLevel:"medium",addons:[]}),X(),ne(),ae(),L(e+" added to your order!"),Ce()}Object.assign(window,{checkout:gn,openCheckout:Ce,closeCheckout:yn,goToStep:Le,setupPayment:Be,switchPayTab:it,validateAndPay:hn,openRazorpay:bn,placeCodOrder:wn,placeOrderToFirestore:Fe,applyCoupon:En,removeCoupon:xn,applyGiftCard:Cn,removeGiftCard:Sn,openGiftCardModal:kn,closeGiftCardModal:In,buyGiftCard:Bn,selectGcAmount:Ln,redeemLoyaltyAtCheckout:Mn,shareOrder:An,addUpsellItem:Tn});function be(e,t,n,a,o,r){var i=B();if(!(typeof i>"u"||!i)){try{var s=localStorage.getItem(t);if(s){var l=JSON.parse(s);if(l.ts&&Date.now()-l.ts<n*1e3){o(l.data);return}}}catch(u){}var c=i.collection(e);r&&r.orderBy&&(c=c.orderBy(r.orderBy[0])),r&&r.where&&(c=c.where(r.where[0],r.where[1],r.where[2])),c.get().then(function(u){var v=a(u);o(v);try{localStorage.setItem(t,JSON.stringify({ts:Date.now(),data:v}))}catch(b){}}).catch(function(u){console.error("cachedGet "+e+" error:",u);try{var v=localStorage.getItem(t);v&&o(JSON.parse(v).data)}catch(b){}})}}function Pn(){var e=B();if(!e)return;function t(o){document.querySelectorAll(".menu-item-card").forEach(function(r){var i=r.querySelector("h4");if(i){var s=i.textContent.replace(/Bestseller|Must Try|New/gi,"").trim(),l=o[s];if(l&&l.count>0){var c=(l.total/l.count).toFixed(1),u=r.querySelector(".item-rating");u&&u.remove();var v=document.createElement("div");v.className="item-rating",v.innerHTML='<span class="rating-stars">'+Nn(parseFloat(c))+'</span><span class="rating-text">'+c+" ("+l.count+")</span>";var b=r.querySelector(".item-description");b&&b.after(v)}}})}try{var n=V("amoghaRatings");if(n){var a=JSON.parse(n);if(a.ts&&Date.now()-a.ts<6e5&&a.data){t(a.data);return}}}catch(o){}e.collection("reviews").get().then(function(o){var r={};o.forEach(function(i){var s=i.data();r[s.itemName]||(r[s.itemName]={total:0,count:0}),r[s.itemName].total+=s.rating,r[s.itemName].count++}),t(r),j("amoghaRatings",JSON.stringify({ts:Date.now(),data:r}))}).catch(function(){try{var o=V("amoghaRatings");if(o){var r=JSON.parse(o);r.data&&t(r.data)}}catch(i){}})}function Nn(e){for(var t="",n=1;n<=5;n++)n<=Math.floor(e)?t+='<span class="star filled">&#9733;</span>':n-.5<=e?t+='<span class="star half">&#9733;</span>':t+='<span class="star empty">&#9734;</span>';return t}function qn(e){var t=document.querySelector(".specials-grid");if(t){if(e.length===0){var n=t.closest(".specials");n&&(n.style.display="none");return}var n=t.closest(".specials");n&&(n.style.display=""),t.innerHTML=e.map(function(a){var o=a.available?"":" item-unavailable";return'<div class="special-card'+o+'" data-id="'+a.name+'"><div class="glow-border"></div><div class="special-badge">'+(a.badge||"Special")+"</div><h3>"+a.name+"</h3><p>"+(a.description||"")+'</p><div class="special-price"><span class="new-price">&#8377;'+a.price+'</span></div><button class="add-to-cart" data-item="'+a.name+'" data-price="'+a.price+'">Order Now</button></div>'}).join("")}}function On(){var e='<div class="menu-skeleton-card"><div class="skeleton-line h-img"></div><div class="skeleton-line w-60"></div><div class="skeleton-line w-100"></div><div class="skeleton-line w-80"></div><div class="skeleton-btn"></div></div>';document.querySelectorAll(".menu-items").forEach(function(t){t.querySelector(".menu-skeleton-card")||t.insertAdjacentHTML("afterbegin",e+e+e)})}function je(){document.querySelectorAll(".menu-skeleton-card").forEach(function(e){e.remove()})}function Dn(){document.querySelectorAll(".menu-item-card").forEach(function(e){var t=e.querySelector(".menu-badge"),n=e.querySelector("h4"),a=t||n;if(a){var o=(t?t.textContent:"")+a.closest(".menu-item-card").dataset.id,r=/chef|spicy|hot|bestseller/i.test(o);if(r&&!e.querySelector(".flame-badge")){var i=document.createElement("span");i.className="flame-badge",i.textContent="ðŸ”¥",i.title="Popular pick!",t?t.after(i):n&&n.appendChild(i)}}})}function Rn(){var e=B();if(!e)return;On();function t(i){var s=i.querySelector(".menu-item-img-wrap");if(s)return s;s=document.createElement("div"),s.className="menu-item-img-wrap";var l=document.createElement("img");l.className="menu-item-img",l.alt="",l.loading="lazy";var c=document.createElement("div");return c.className="menu-item-img-placeholder",c.innerHTML='<svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg><span>Image coming soon</span>',s.appendChild(l),s.appendChild(c),i.insertBefore(s,i.firstChild),s}e.collection("menu").onSnapshot(function(i){je();var s={};i.forEach(function(l){s[l.id]=l.data()}),document.querySelectorAll(".menu-item-card[data-id]").forEach(function(l){var c=l.dataset.id,u=s[c];if(!u){l.style.display="none";return}l.style.display="",u.available?(l.classList.remove("item-unavailable"),l.style.opacity="",l.style.pointerEvents="",l.style.filter=""):(l.classList.add("item-unavailable"),l.style.opacity="0.45",l.style.pointerEvents="none",l.style.filter="grayscale(0.3)");var v=l.querySelector(".add-to-cart");if(v&&u.price!==parseInt(v.dataset.price)){v.dataset.price=u.price;var b=l.querySelector(".price");b&&(b.innerHTML="&#8377;"+u.price)}var h=t(l),x=h.querySelector(".menu-item-img");u.imageUrl?(x.dataset.currentUrl!==u.imageUrl&&(x.dataset.currentUrl=u.imageUrl,x.src=u.imageUrl,x.onload=function(){x.classList.add("loaded"),h.classList.add("has-image")},x.onerror=function(){x.classList.remove("loaded"),h.classList.remove("has-image"),x.src=""}),l.dataset.imageUrl=u.imageUrl):(x.classList.remove("loaded"),h.classList.remove("has-image"),x.src="",x.dataset.currentUrl="",delete l.dataset.imageUrl);var C=u.allergens||[];l.dataset.allergens=C.join(",");var I=l.querySelector(".menu-allergen-icons");if(I&&I.remove(),C.length>0){var N={nuts:"ðŸ¥œ",dairy:"ðŸ¥›",gluten:"ðŸŒ¾",eggs:"ðŸ¥š",soy:"ðŸ«˜",shellfish:"ðŸ¦",sesame:"âšª",fish:"ðŸŸ"},A='<div class="menu-allergen-icons">';C.forEach(function(R){A+='<span class="allergen-icon">'+(N[R]||"")+" "+R+"</span>"}),A+="</div>";var D=l.querySelector(".item-description")||l.querySelector(".price");D&&D.insertAdjacentHTML("afterend",A)}}),Dn(),window._safeForMeActive&&st()},function(i){console.error("Menu listener error:",i),je()}),be("specials","specials_cache",300,function(i){var s=[];return i.forEach(function(l){var c=l.data();c.id=l.id,s.push(c)}),s},qn,{orderBy:["sortOrder"]}),be("heroSlides","heroSlides_cache",300,function(i){var s=[];return i.forEach(function(l){var c=l.data();c.active&&s.push(c)}),s},function(i){i.length!==0&&typeof window.updateHeroSlides=="function"&&window.updateHeroSlides(i)},{orderBy:["sortOrder"]});try{var n=localStorage.getItem("theme_cache");if(n){var a=JSON.parse(n);if(a.ts&&Date.now()-a.ts<6e5&&a.theme&&a.theme!=="default"){document.body.classList.add("theme-"+a.theme);return}}}catch(i){}e.collection("settings").doc("global").get().then(function(i){var s=i.exists&&i.data().activeTheme?i.data().activeTheme:"default";s!=="default"&&document.body.classList.add("theme-"+s);try{localStorage.setItem("theme_cache",JSON.stringify({ts:Date.now(),theme:s}))}catch(l){}}).catch(function(){});var o=document.getElementById("testimonials-grid");o&&be("testimonials","testimonials_cache",600,function(s){var l=[];return s.forEach(function(c){var u=c.data();u.active&&l.push(u)}),l},function(s){if(s.length===0){var l=o.closest(".testimonials");l&&(l.style.display="none");return}o.innerHTML=s.map(function(c){var u=c.thumbnailUrl||(c.videoUrl?c.videoUrl.replace("/upload/","/upload/f_jpg,so_1/"):"");return'<div class="testimonial-card" onclick="openVideoLightbox(\''+(c.videoUrl||"")+'\')"><div class="testimonial-thumb">'+(u?'<img src="'+u+'" alt="" loading="lazy">':'<div class="testimonial-placeholder">ðŸŽ¬</div>')+'<div class="testimonial-play">&#9654;</div></div><p class="testimonial-name">'+(c.customerName||"")+"</p>"+(c.caption?'<p class="testimonial-caption">'+c.caption+"</p>":"")+"</div>"}).join("")},{orderBy:["sortOrder"]});var r=document.getElementById("social-feed-strip");r&&be("socialPosts","socialPosts_cache",600,function(s){var l=[];return s.forEach(function(c){var u=c.data();u.active&&l.push(u)}),l},function(s){if(s.length===0){var l=r.closest(".social-feed");l&&(l.style.display="none");return}r.innerHTML=s.map(function(c){var u=c.link?'<a href="'+c.link+'" target="_blank" rel="noopener">':"<div>",v=c.link?"</a>":"</div>";return u+'<div class="social-card"><img src="'+c.imageUrl+'" alt="" loading="lazy">'+(c.caption?'<span class="social-caption">'+c.caption+"</span>":"")+"</div>"+v}).join("")},{orderBy:["sortOrder"]})}window._safeForMeActive=!1;function Hn(){window._safeForMeActive=!window._safeForMeActive;var e=document.getElementById("safe-for-me-btn");e&&e.classList.toggle("active",window._safeForMeActive),st()}function st(){var e=null;try{var t=localStorage.getItem("amoghaUser");t&&(e=JSON.parse(t))}catch(a){}var n=e&&e.allergenAlerts||[];document.querySelectorAll(".menu-item-card[data-id]").forEach(function(a){if(!window._safeForMeActive||n.length===0){a.classList.remove("allergen-hidden"),a.classList.contains("item-unavailable")||(a.style.display="");return}var o=(a.dataset.allergens||"").split(",").filter(Boolean),r=o.some(function(i){return n.indexOf(i)!==-1});r?(a.classList.add("allergen-hidden"),a.style.display="none"):(a.classList.remove("allergen-hidden"),a.classList.contains("item-unavailable")||(a.style.display=""))})}function Fn(e,t){var n=null;try{var a=localStorage.getItem("amoghaUser");a&&(n=JSON.parse(a))}catch(s){}var o=n&&n.allergenAlerts||[];if(o.length===0){t(!0);return}var r=[];if(document.querySelectorAll(".menu-item-card[data-id]").forEach(function(s){var l=(s.dataset.allergens||"").split(",").filter(Boolean),c=s.querySelector("h4"),u=c?c.textContent.replace(/Bestseller|Must Try|New/gi,"").trim():s.dataset.id;e.forEach(function(v){if(v.name===u||v.name===s.dataset.id){var b=l.filter(function(h){return o.indexOf(h)!==-1});b.length>0&&r.push({name:v.name,allergens:b})}})}),r.length===0){t(!0);return}var i='<div class="allergen-warning-popup" id="allergen-warning-popup"><div class="allergen-warning-box"><h3>Allergen Warning</h3><div class="allergen-list">';r.forEach(function(s){i+="<p><strong>"+s.name+"</strong> contains: "+s.allergens.join(", ")+"</p>"}),i+='</div><button class="btn-proceed" onclick="document.getElementById(\'allergen-warning-popup\').remove();window._allergenCb(true)">Proceed Anyway</button><button class="btn-cancel" onclick="document.getElementById(\'allergen-warning-popup\').remove();window._allergenCb(false)">Go Back</button></div></div>',window._allergenCb=t,document.body.insertAdjacentHTML("beforeend",i)}window.toggleSafeForMe=Hn;window.checkAllergenWarning=Fn;function _n(){const e=["Authentic Indian Cuisine","Crafted with Passion","A Legacy of Flavour","Where Taste Meets Art","Born from Tradition"],t=["Tradition, Perfection & Soul in Every Dish","Handcrafted Recipes Passed Down Generations","An Unforgettable Culinary Journey Awaits","Every Flavour Tells a Story of Heritage","Experience the Art of Indian Fine Dining"],n=document.querySelector(".hero-tagline .hero-text-inner"),a=document.querySelector(".hero-subtitle .hero-text-inner");if(!n||!a)return;let o=0;function r(){o=(o+1)%e.length,n.classList.add("fade-out"),a.classList.add("fade-out"),setTimeout(()=>{n.textContent=e[o],a.textContent=t[o],window._scrambleReveal?window._scrambleReveal(e[o],n):n.classList.remove("fade-out"),a.classList.remove("fade-out")},700)}setTimeout(()=>{setInterval(r,6e3)},5e3)}function zn(){const e=document.querySelectorAll(".header-slideshow .slide");if(e.length===0)return;let t=0;setInterval(()=>{e[t].classList.remove("active");let n;do n=Math.floor(Math.random()*e.length);while(n===t&&e.length>1);t=n,e[t].classList.add("active")},3e3)}function Gn(){var e=document.querySelectorAll("#hero-slideshow .hero-slide"),t=document.getElementById("hero-sparkles"),n=0,a=window.innerWidth<=768;function o(){if(t){t.innerHTML="";for(var c=a?5:12,u=a?3:6,v=a?4:10,b=a?2:4,h=0;h<b;h++){var x=document.createElement("span");x.className="sp-glow";var C=200+Math.random()*250,I=10+h/b*70+Math.random()*15,N=20+Math.random()*50,A=10+Math.random()*8,D=h*3+Math.random()*2;x.style.cssText="left:"+I+"%;top:"+N+"%;width:"+C+"px;height:"+C+"px;--glow-dur:"+A+"s;--glow-delay:"+D+"s;",t.appendChild(x)}for(var R=0;R<c;R++){var $=document.createElement("span"),K=["","thin","accent","thin",""],m=K[R%K.length];$.className="sp-line"+(m?" "+m:"");var f=140+Math.random()*180,d=3+R/c*90+Math.random()*6,p=12+Math.random()*10,y=R/c*p,g=7+Math.random()*6,w=2.5+Math.random()*2;$.style.cssText="left:"+d+"%;height:"+f+"px;--line-dur:"+p+"s;--line-delay:"+y+"s;--sway-dur:"+g+"s;--shimmer-dur:"+w+"s;",t.appendChild($)}for(var E=0;E<u;E++){var k=document.createElement("span");k.className="sp-dot";var T=4+Math.random()*5,q=8+Math.random()*84,z=18+Math.random()*12,F=E*3.5+Math.random()*4;k.style.cssText="left:"+q+"%;width:"+T+"px;height:"+T+"px;--dot-dur:"+z+"s;--dot-delay:"+F+"s;",t.appendChild(k)}for(var Q=0;Q<v;Q++){var Te=document.createElement("span");Te.className="sp-mote";var We=2+Math.random()*3,qt=5+Math.random()*90,Ot=18+Math.random()*14,Dt=Q*2.5+Math.random()*3,Rt=1.5+Math.random()*2;Te.style.cssText="left:"+qt+"%;width:"+We+"px;height:"+We+"px;--mote-dur:"+Ot+"s;--mote-delay:"+Dt+"s;--twinkle-dur:"+Rt+"s;",t.appendChild(Te)}}}o();var r=["kb-zoom-left","kb-zoom-right","kb-pan-down","kb-zoom-center"],i=null;function s(){i&&clearInterval(i),e=document.querySelectorAll("#hero-slideshow .hero-slide"),n=0,e.length>1&&(i=setInterval(function(){e[n].classList.remove("active"),n=(n+1)%e.length;for(var c=0;c<r.length;c++)e[n].classList.remove(r[c]);e[n].classList.add(r[Math.floor(Math.random()*r.length)]),e[n].classList.add("active")},2e3))}s(),window.updateHeroSlides=function(c){var u=document.getElementById("hero-slideshow");if(!(!u||c.length===0)){i&&clearInterval(i);for(var v=u.querySelectorAll(".hero-slide"),b=0;b<v.length;b++)v[b].remove();c.forEach(function(h,x){var C=document.createElement("div");if(C.className="hero-slide"+(x===0?" active":""),x===0&&C.classList.add(r[Math.floor(Math.random()*r.length)]),h.type==="video"){C.classList.add("hero-slide-video");var I=document.createElement("video");I.src=h.url,I.autoplay=!0,I.muted=!0,I.loop=!0,I.playsInline=!0,I.setAttribute("playsinline",""),I.setAttribute("webkit-playsinline",""),C.appendChild(I)}else C.style.backgroundImage="url("+h.url+")";u.appendChild(C)}),e=u.querySelectorAll(".hero-slide"),n=0,e.length>1&&(i=setInterval(function(){e[n].classList.remove("active");var h=e[n].querySelector("video");h&&h.pause(),n=(n+1)%e.length;for(var x=0;x<r.length;x++)e[n].classList.remove(r[x]);e[n].classList.add(r[Math.floor(Math.random()*r.length)]),e[n].classList.add("active");var C=e[n].querySelector("video");C&&(C.currentTime=0,C.play())},2e3))}};var l=document.querySelector(".hero-tagline .hero-text-inner");if(l&&(window._scrambleReveal=function(c,u){u.textContent=c,u.classList.remove("fade-out"),u.style.opacity="1",u.style.transform="translateY(0)",u.classList.remove("blur-reveal"),u.offsetWidth,u.classList.add("blur-reveal")},setTimeout(function(){window._scrambleReveal(l.textContent,l)},2800)),window.innerWidth>768){const c=document.querySelector(".hero"),u=document.querySelector(".hero-mouse-spotlight");c&&u&&c.addEventListener("mousemove",function(v){const b=c.getBoundingClientRect(),h=v.clientX-b.left,x=v.clientY-b.top;u.style.setProperty("--mouse-x",h+"px"),u.style.setProperty("--mouse-y",x+"px")})}}function Un(){const e=document.getElementById("confetti-canvas");if(!e)return;const t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const n=[],a=["#EFB31A","#8B1A1A","#27ae60","#e74c3c","#3498db","#f39c12","#9b59b6"];for(let i=0;i<150;i++)n.push({x:Math.random()*e.width,y:Math.random()*e.height-e.height,w:Math.random()*10+5,h:Math.random()*6+3,color:a[Math.floor(Math.random()*a.length)],vy:Math.random()*3+2,vx:Math.random()*2-1,rot:Math.random()*360,rotSpeed:Math.random()*6-3});let o=0;function r(){t.clearRect(0,0,e.width,e.height),n.forEach(i=>{i.y+=i.vy,i.x+=i.vx,i.rot+=i.rotSpeed,t.save(),t.translate(i.x,i.y),t.rotate(i.rot*Math.PI/180),t.fillStyle=i.color,t.fillRect(-i.w/2,-i.h/2,i.w,i.h),t.restore()}),o++,o<200?requestAnimationFrame(r):t.clearRect(0,0,e.width,e.height)}r()}function we(){var e=document.getElementById("nav-links"),t=document.getElementById("mobile-menu-overlay"),n=document.getElementById("mobile-menu-toggle");e&&e.classList.remove("active"),t&&t.classList.remove("active"),n&&(n.textContent="â˜°"),O()}function Wn(){"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo(0,0),window.addEventListener("load",()=>{const m=document.getElementById("page-transition");m&&setTimeout(()=>m.classList.add("loaded"),100),setTimeout(()=>{const f=document.getElementById("preloader");f&&f.classList.add("hidden")},2200)}),function(){const m=document.getElementById("theme-toggle");if(!m)return;V("amogha-dark-mode")==="true"&&(document.body.classList.add("dark-mode"),m.textContent="â˜€ï¸"),m.addEventListener("click",()=>{document.body.classList.toggle("dark-mode");const d=document.body.classList.contains("dark-mode");m.textContent=d?"â˜€ï¸":"ðŸŒ™",j("amogha-dark-mode",d)})}(),function(){const m=document.querySelectorAll(".stat-number");function f(){if(window.innerWidth<=768){m.forEach(function(E){var k=parseFloat(E.dataset.target);E.textContent=k%1!==0?k.toFixed(1):k.toLocaleString()});return}var p=[];m.forEach(function(E){p.push({el:E,target:parseFloat(E.dataset.target),isDecimal:parseFloat(E.dataset.target)%1!==0,lastValue:-1})});var y=2e3,g=performance.now();function w(E){for(var k=E-g,T=Math.min(k/y,1),q=1-Math.pow(1-T,3),z=0;z<p.length;z++){var F=p[z],Q=F.isDecimal?+(F.target*q).toFixed(1):Math.floor(F.target*q);Q!==F.lastValue&&(F.el.textContent=F.isDecimal?Q.toFixed(1):Q.toLocaleString(),F.lastValue=Q)}T<1&&requestAnimationFrame(w)}requestAnimationFrame(w)}const d=document.querySelector(".stats-section");if(d){let p=!1;const y=new IntersectionObserver(g=>{g[0].isIntersecting&&!p&&(p=!0,f(),y.unobserve(d))},{threshold:.3});y.observe(d)}}(),function(){var m=document.querySelectorAll(".reveal");if(!(!m.length||typeof IntersectionObserver>"u")){var f=new IntersectionObserver(function(d){d.forEach(function(p){p.isIntersecting&&(p.target.classList.add("in-view"),f.unobserve(p.target))})},{threshold:.12,rootMargin:"0px 0px -40px 0px"});m.forEach(function(d){f.observe(d)})}}(),function(){var m=document.getElementById("nav-links"),f=document.getElementById("mobile-menu-toggle"),d=document.getElementById("mobile-menu-overlay");if(!m||!f)return;var p=m.parentElement;function y(){window.innerWidth<=768?m.parentElement!==document.body&&document.body.appendChild(m):m.parentElement===document.body&&p.appendChild(m)}y();var g;window.addEventListener("resize",function(){clearTimeout(g),g=setTimeout(y,100)}),f.addEventListener("click",()=>{const w=m.classList.toggle("active");d&&d.classList.toggle("active",w),f.textContent=w?"âœ•":"â˜°",w?G():O()}),d&&d.addEventListener("click",we),m.querySelectorAll("a").forEach(function(w){w.addEventListener("click",function(E){var k=w.getAttribute("href"),T=w.id==="signin-btn"||w.closest("#signin-btn");if(T){m.classList.remove("active"),d&&d.classList.remove("active"),f.textContent="â˜°";return}if(we(),k&&k.startsWith("#")){E.preventDefault();var q=document.querySelector(k);q&&setTimeout(function(){q.scrollIntoView({behavior:"smooth",block:"start"})},50)}})})}(),document.querySelectorAll('a[href^="#"]').forEach(m=>{m.addEventListener("click",function(f){if(this.id==="cart-icon")return;f.preventDefault();const d=document.querySelector(this.getAttribute("href"));d&&(d.scrollIntoView({behavior:"smooth",block:"start"}),we())})});const e=document.getElementById("back-to-top");e&&e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const t=document.querySelector(".hero-slideshow"),n=document.querySelectorAll("section[id]"),a=document.querySelectorAll('.nav-links a[href^="#"]'),o=document.querySelector("header");var r=0,i=document.querySelector(".hero-scroll-indicator"),s=document.getElementById("btt-ring-fill"),l=document.getElementById("sticky-order-bar"),c=document.querySelector(".hero"),u=2*Math.PI*16,v=c?c.offsetHeight:600,b=[];(function(){n.forEach(function(f){b.push({id:f.getAttribute("id"),top:f.offsetTop})})})();var h=document.querySelector(".about"),x=document.querySelector(".chef-content"),C=document.querySelector(".stats-grid"),I=h?h.offsetTop:0,N=x?x.closest("section")||x.closest(".chef-section"):null,A=N?N.offsetTop:0,D=C?C.closest(".stats-section"):null,R=D?D.offsetTop:0;window.addEventListener("resize",function(){v=c?c.offsetHeight:600,b=[],n.forEach(function(m){b.push({id:m.getAttribute("id"),top:m.offsetTop})}),I=h?h.offsetTop:0,A=N?N.offsetTop:0,R=D?D.offsetTop:0});var $=!1;window.addEventListener("scroll",function(){$||(requestAnimationFrame(function(){var m=window.pageYOffset,f=window.innerWidth>768;if(t&&f&&(t.style.transform="translateY("+m*.35+"px)"),f){var d=window.innerHeight;if(h&&m>I-d&&m<I+h.offsetHeight){var p=(m-I+d)*.06;h.style.setProperty("--section-parallax",p+"px")}x&&m>A-d&&m<A+800&&(x.style.transform="translateY("+(m-A+d)*.04+"px)"),C&&m>R-d&&m<R+600&&(C.style.transform="translateY("+(m-R+d)*.035+"px)")}if(i&&m<300?i.style.opacity=Math.max(0,1-m/300):i&&i.style.opacity!=="0"&&(i.style.opacity=0),o&&f&&(m>r&&m>100?o.style.transform="translateY(-100%)":o.style.transform="translateY(0)"),r=m,e){var y=m>400,g=e.classList.contains("visible");y&&!g?e.classList.add("visible"):!y&&g&&e.classList.remove("visible")}if(s){var w=document.documentElement.scrollHeight-document.documentElement.clientHeight,E=w>0?m/w:0;s.style.strokeDashoffset=u*(1-E)}if(l){var k=m>v,T=l.classList.contains("visible");k&&!T?l.classList.add("visible"):!k&&T&&l.classList.remove("visible")}if(f){for(var q="",z=0;z<b.length;z++)m>=b[z].top-150&&(q=b[z].id);a.forEach(function(F){F.classList.remove("active"),F.getAttribute("href")==="#"+q&&F.classList.add("active")})}$=!1}),$=!0)},{passive:!0}),function(){document.querySelectorAll(".about-text, .special-card, .menu-category, .gallery-item, .review-card, .faq-item, .info-block, .contact-form-section, .stat-item, .chef-content, .trust-badge").forEach(g=>{g.classList.add("reveal");const E=(g.parentElement?Array.from(g.parentElement.children).filter(T=>T.classList.contains(g.classList[0])):[]).indexOf(g);if(E>0){var k=.07*E+.04*Math.sin(E*Math.PI/4);g.style.transitionDelay=Math.max(0,k).toFixed(3)+"s"}}),document.querySelectorAll(".menu-item-card").forEach(g=>{g.classList.add("reveal");const E=(g.parentElement?Array.from(g.parentElement.children):[]).indexOf(g);var k=Math.floor(E/2),T=E%2;g.style.transitionDelay=(k*.12+T*.06).toFixed(3)+"s"}),document.querySelectorAll(".about, .specials, .menu, .gallery, .reviews, .contact, .faq").forEach(g=>{g.classList.add("section-reveal")});const f=document.querySelector(".chef-image"),d=document.querySelector("#chef-info");f&&f.classList.add("reveal-left"),d&&d.classList.add("reveal-right"),document.querySelectorAll(".stat-item").forEach(g=>{g.classList.remove("reveal"),g.classList.add("reveal-scale")});const p=document.querySelectorAll(".reveal, .reveal-left, .reveal-right, .reveal-scale, .section-reveal"),y=new IntersectionObserver(g=>{g.forEach(w=>{w.isIntersecting&&w.target.classList.add("visible")})},{threshold:.08,rootMargin:"0px 0px -50px 0px"});p.forEach(g=>y.observe(g))}(),function(){const m=document.querySelectorAll("#chef-slideshow .chef-slide"),f=document.querySelectorAll(".chef-info-slide");if(m.length<=1)return;let d=0;setInterval(()=>{m[d].classList.remove("active"),f[d]&&f[d].classList.remove("active"),d=(d+1)%m.length,m[d].classList.add("active"),f[d]&&f[d].classList.add("active")},4e3)}(),function(){const m=document.getElementById("category-carousel"),f=document.getElementById("cat-arrow-left"),d=document.getElementById("cat-arrow-right");if(!m||!f||!d)return;const p=250;function y(){f.disabled=m.scrollLeft<=5,d.disabled=m.scrollLeft>=m.scrollWidth-m.clientWidth-5}f.addEventListener("click",()=>{m.scrollBy({left:-p,behavior:"smooth"})}),d.addEventListener("click",()=>{m.scrollBy({left:p,behavior:"smooth"})}),m.addEventListener("scroll",y,{passive:!0}),y(),m.querySelectorAll(".category-item").forEach(g=>{g.addEventListener("click",w=>{w.preventDefault();const E=g.getAttribute("href"),k=document.querySelector(E);if(k){const q=k.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:q,behavior:"smooth"})}})})}(),function(){var m=document.getElementById("menu-search");m&&m.addEventListener("input",function(f){var d=f.target.value.toLowerCase();document.querySelectorAll(".menu-item-card").forEach(function(p){var y=p.querySelector("h4"),g=p.querySelector(".item-description"),w=y?y.textContent.toLowerCase():"",E=g?g.textContent.toLowerCase():"";p.style.display=w.includes(d)||E.includes(d)?"":"none"})})}(),document.querySelectorAll(".filter-btn").forEach(m=>{m.addEventListener("click",()=>{document.querySelectorAll(".filter-btn").forEach(d=>d.classList.remove("active")),m.classList.add("active");const f=m.dataset.filter;document.querySelectorAll(".menu-item-card").forEach(d=>{const p=d.querySelector(".veg-badge"),y=d.querySelector(".nonveg-badge");f==="all"?d.style.display="":f==="veg"?d.style.display=p?"":"none":f==="non-veg"&&(d.style.display=y?"":"none")})})});var K=document.getElementById("contact-form");K&&K.addEventListener("submit",m=>{m.preventDefault(),typeof showAuthToast=="function"&&showAuthToast("Thank you for your message! We will get back to you shortly."),m.target.reset()}),function(){const m=document.getElementById("food-particles");if(!m)return;const f=["ðŸ›","ðŸš","ðŸŒ¶ï¸","ðŸ—","ðŸ¥˜","ðŸ«“","â˜•","ðŸ²"];for(let d=0;d<12;d++){const p=document.createElement("span");p.className="food-particle",p.textContent=f[Math.floor(Math.random()*f.length)],p.style.left=Math.random()*100+"%",p.style.animationDuration=15+Math.random()*20+"s",p.style.animationDelay=Math.random()*15+"s",p.style.fontSize=1+Math.random()*1.5+"rem",m.appendChild(p)}}(),function(){let m;var f=document.getElementById("pwa-prompt"),d=document.getElementById("pwa-install-btn"),p=document.getElementById("pwa-dismiss-btn");function y(){f&&(f.style.opacity="0",f.style.transform="translateX(-50%) translateY(30px)",setTimeout(function(){f.style.display="none"},400))}window.addEventListener("beforeinstallprompt",function(g){g.preventDefault(),m=g,f&&(f.style.display="flex")}),d&&d.addEventListener("click",function(){m&&(m.prompt(),m.userChoice.then(function(){m=null,y()}))}),p&&p.addEventListener("click",y)}(),function(){if(window.innerWidth<=768)return;document.querySelectorAll(".cta-button, .add-to-cart").forEach(f=>{f.addEventListener("mousemove",d=>{const p=f.getBoundingClientRect(),y=d.clientX-p.left-p.width/2,g=d.clientY-p.top-p.height/2;f.style.transform="translate(".concat(y*.15,"px, ").concat(g*.15,"px)")}),f.addEventListener("mouseleave",()=>{f.style.transform=""})})}(),function(){function m(d){d.complete&&d.naturalHeight>0?d.classList.add("loaded"):d.addEventListener("load",()=>d.classList.add("loaded"))}document.querySelectorAll('img[loading="lazy"]').forEach(m),new MutationObserver(d=>{d.forEach(p=>{p.addedNodes.forEach(y=>{y.tagName==="IMG"&&y.loading==="lazy"&&m(y)})})}).observe(document.body,{childList:!0,subtree:!0})}(),function(){if(window.innerWidth<=768)return;const m=document.querySelectorAll(".menu-item-card"),f=4;m.forEach(function(d){var p=null;d.addEventListener("mouseenter",function(){p=d.getBoundingClientRect()}),d.addEventListener("mousemove",function(y){if(!p)return;const g=y.clientX-p.left,w=y.clientY-p.top,E=p.width/2,k=p.height/2,T=(w-k)/k*-f,q=(g-E)/E*f;d.style.transform="perspective(800px) rotateX("+T+"deg) rotateY("+q+"deg) translateY(-4px)"}),d.addEventListener("mouseleave",function(){p=null,d.style.transition="transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",d.style.transform="perspective(800px) rotateX(0) rotateY(0) translateY(0)",setTimeout(function(){d.style.transition=""},500)})})}(),function(){if(window.innerWidth<=768)return;var m=document.getElementById("cursor-glow");if(!m)return;var f=0,d=0,p=0,y=0,g=!1;document.addEventListener("mousemove",function(E){f=E.clientX,d=E.clientY,g||(g=!0,m.classList.add("active"))}),document.addEventListener("mouseleave",function(){g=!1,m.classList.remove("active")});function w(){p+=(f-p)*.12,y+=(d-y)*.12,m.style.left=p+"px",m.style.top=y+"px",requestAnimationFrame(w)}w()}(),function(){var m=document.querySelectorAll(".svg-ornament");if(m.length!==0){var f=new IntersectionObserver(function(d){d.forEach(function(p){p.isIntersecting&&p.target.classList.add("visible")})},{threshold:.5});m.forEach(function(d){f.observe(d)})}}(),function(){if(window.innerWidth<=768)return;var m=document.getElementById("menu-preview-img");if(!m)return;var f={starters:"pics/Gemini_Generated_Image_wnzsqxwnzsqxwnzs.png",curries:"pics/Gemini_Generated_Image_tu348stu348stu34.png",biryanis:"pics/Gemini_Generated_Image_h1vezgh1vezgh1ve.png",kebabs:"pics/Gemini_Generated_Image_5jdcgq5jdcgq5jdc.png",noodles:"pics/Gemini_Generated_Image_1ojbou1ojbou1ojb.png",friedrice:"pics/Gemini_Generated_Image_bfgo8abfgo8abfgo.png",rotis:"pics/Gemini_Generated_Image_6lqqu6lqqu6lqqu6.png"};function d(p){var y=p.closest(".menu-category");if(!y)return null;var g=y.id||"";return g.indexOf("starters")!==-1?"starters":g.indexOf("curries")!==-1?"curries":g.indexOf("biryanis")!==-1?"biryanis":g.indexOf("kebabs")!==-1?"kebabs":g.indexOf("noodles")!==-1?"noodles":g.indexOf("friedrice")!==-1?"friedrice":g.indexOf("rotis")!==-1?"rotis":null}document.querySelectorAll(".menu-item-card").forEach(function(p){p.addEventListener("mouseenter",function(){var y=p.dataset.imageUrl;if(y)m.src=y,m.classList.add("active");else{var g=d(p);g&&f[g]&&(m.src=f[g],m.classList.add("active"))}}),p.addEventListener("mousemove",function(y){m.style.left=y.clientX+20+"px",m.style.top=y.clientY-90+"px"}),p.addEventListener("mouseleave",function(){m.classList.remove("active")})})}(),function(){if(!(window.innerWidth<=768)){var m=document.querySelectorAll(".chef-slide, .gallery-slide-item img, .gallery-item img"),f=.03;m.forEach(function(d){d.classList.add("magnetic-image");var p=null;d.addEventListener("mouseenter",function(){p=d.getBoundingClientRect()}),d.addEventListener("mousemove",function(y){if(p){var g=y.clientX-p.left-p.width/2,w=y.clientY-p.top-p.height/2;d.style.transform="translate("+g*f+"px, "+w*f+"px) scale(1.02)"}}),d.addEventListener("mouseleave",function(){p=null,d.style.transform=""})})}}(),function(){if(!(window.innerWidth<=768)){var m=document.querySelectorAll(".menu-item-card, .about-text");m.forEach(function(f){var d=document.createElement("div");d.className="card-reflection",f.appendChild(d);var p=null;f.addEventListener("mouseenter",function(){p=f.getBoundingClientRect()}),f.addEventListener("mousemove",function(y){p&&(d.style.setProperty("--ref-x",y.clientX-p.left+"px"),d.style.setProperty("--ref-y",y.clientY-p.top+"px"))}),f.addEventListener("mouseleave",function(){p=null})})}}(),function(){var m=document.querySelectorAll(".section-wipe");if(m.length!==0){var f=new IntersectionObserver(function(d){d.forEach(function(p){p.isIntersecting&&!p.target.classList.contains("wipe-active")&&p.target.classList.add("wipe-active")})},{threshold:.15});m.forEach(function(d){f.observe(d)})}}(),function(){document.addEventListener("click",function(m){var f=m.target.closest(".add-to-cart, .cta-button, .btn-primary, .pay-now-btn, .combo-add-btn");if(f){var d=document.createElement("span");d.className="btn-ripple";var p=f.getBoundingClientRect(),y=Math.max(p.width,p.height)*2;d.style.width=d.style.height=y+"px",d.style.left=m.clientX-p.left-y/2+"px",d.style.top=m.clientY-p.top-y/2+"px",f.appendChild(d),setTimeout(function(){d.remove()},700)}})}(),function(){if(window.innerWidth<=768)return;function m(f,d){for(var p=10,y=0;y<p;y++){var g=document.createElement("span");g.className="gold-particle";var w=y/p*Math.PI*2,E=40+Math.random()*30,k=Math.cos(w)*E,T=Math.sin(w)*E;g.style.left=f+"px",g.style.top=d+"px",g.style.setProperty("--tx",k+"px"),g.style.setProperty("--ty",T+"px"),g.style.animationDelay=Math.random()*.1+"s",document.body.appendChild(g),g.addEventListener("animationend",function(){this.remove()})}}document.addEventListener("click",function(f){(f.target.classList.contains("add-to-cart")||f.target.closest(".add-to-cart"))&&m(f.clientX,f.clientY)})}(),function(){var m={Mild:"Subtle warmth, family-friendly",Medium:"Balanced heat, our recommendation",Spicy:"Andhra-level heat, for the brave!"};document.querySelectorAll(".spice-level").forEach(function(f){var d=f.textContent.trim();m[d]&&(f.setAttribute("data-tooltip",m[d]),f.classList.add("has-tooltip"))})}(),function(){var m=50;function f(d,p){if(d){var y=0,g=0,w=!1;d.addEventListener("touchstart",function(E){y=E.touches[0].clientX,g=E.touches[0].clientY,w=!0},{passive:!0}),d.addEventListener("touchmove",function(E){if(w){var k=E.touches[0].clientX-y,T=E.touches[0].clientY-g;Math.abs(k)>Math.abs(T)&&Math.abs(k)>10&&E.preventDefault()}},{passive:!1}),d.addEventListener("touchend",function(E){if(w){w=!1;var k=E.changedTouches[0].clientX-y;Math.abs(k)>m&&p(k<0?1:-1)}},{passive:!0})}}f(document.querySelector(".gallery-slideshow-wrapper"),function(d){typeof window.moveGallerySlide=="function"&&window.moveGallerySlide(d)}),f(document.querySelector(".reviews-carousel-wrapper"),function(d){typeof window.moveCarousel=="function"&&window.moveCarousel(d)})}(),function(){var m=document.getElementById("menu-search");if(m){var f=document.createElement("div");f.id="search-autocomplete",f.className="search-autocomplete-dropdown",m.parentElement.classList.add("search-autocomplete-wrap"),m.parentElement.appendChild(f);var d=[];document.querySelectorAll(".menu-item-card").forEach(function(y){var g=y.querySelector("h4"),w=y.querySelector(".item-description"),E=y.querySelector(".price"),k=!!y.querySelector(".veg-badge"),T=y.closest(".menu-category"),q=T?T.querySelector(".category-title"):null,z=q?q.textContent:"";d.push({name:g?g.textContent.replace(/Bestseller|Popular|Chef's Pick|Must Try/g,"").trim():"",desc:w?w.textContent:"",price:E?E.textContent:"",isVeg:k,category:z,card:y})});var p;m.addEventListener("input",function(){clearTimeout(p),p=setTimeout(function(){var y=m.value.toLowerCase().trim();if(document.querySelectorAll(".menu-item-card").forEach(function(w){var E=w.querySelector("h4"),k=w.querySelector(".item-description"),T=E?E.textContent.toLowerCase():"",q=k?k.textContent.toLowerCase():"";w.style.display=!y||T.includes(y)||q.includes(y)?"":"none"}),y.length<2){f.classList.remove("visible"),f.innerHTML="";return}var g=d.filter(function(w){return w.name.toLowerCase().includes(y)||w.desc.toLowerCase().includes(y)}).slice(0,6);if(g.length===0){f.classList.remove("visible"),f.innerHTML="";return}f.innerHTML=g.map(function(w){var E=w.isVeg?'<span class="ac-badge veg">VEG</span>':'<span class="ac-badge non-veg">NON-VEG</span>';return'<button class="ac-item" data-name="'+w.name+'"><div class="ac-info"><span class="ac-name">'+w.name+'</span><span class="ac-meta">'+E+' <span class="ac-cat">'+w.category+'</span></span></div><span class="ac-price">'+w.price+"</span></button>"}).join(""),f.classList.add("visible")},150)}),f.addEventListener("click",function(y){var g=y.target.closest(".ac-item");if(g){var w=g.dataset.name;m.value=w,f.classList.remove("visible");var E=d.find(function(k){return k.name===w});E&&E.card&&(document.querySelectorAll(".menu-item-card").forEach(function(k){k.style.display=""}),E.card.scrollIntoView({behavior:"smooth",block:"center"}),E.card.classList.add("search-highlight"),setTimeout(function(){E.card.classList.remove("search-highlight")},2e3))}}),document.addEventListener("click",function(y){y.target.closest(".search-autocomplete-wrap")||f.classList.remove("visible")}),m.addEventListener("keydown",function(y){y.key==="Escape"&&(f.classList.remove("visible"),m.blur())})}}(),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('img[loading="lazy"]').forEach(function(f){f.complete?f.classList.add("loaded"):(f.addEventListener("load",function(){f.classList.add("loaded")}),f.addEventListener("error",function(){f.classList.add("loaded")}))});var m=new MutationObserver(function(f){f.forEach(function(d){d.addedNodes.forEach(function(p){if(p.nodeType===1){var y=p.querySelectorAll?p.querySelectorAll('img[loading="lazy"]'):[];y.forEach(function(g){g.complete?g.classList.add("loaded"):g.addEventListener("load",function(){g.classList.add("loaded")})})}})})});m.observe(document.body,{childList:!0,subtree:!0})})}Object.assign(window,{closeMobileMenu:we,launchConfetti:Un});function Vn(){if("Notification"in window){if(Notification.permission==="granted"){j("amoghaNotifPerm","granted");return}if(Notification.permission!=="denied"){var e=document.getElementById("notif-banner");!e&&!V("amoghaNotifDismissed")&&(e=document.createElement("div"),e.id="notif-banner",e.className="notif-banner",e.innerHTML='<span class="notif-icon">ðŸ””</span><span class="notif-text">Get notified when your order is ready!</span><button class="notif-allow" onclick="enableNotifications()">Enable</button><button class="notif-dismiss" onclick="dismissNotifBanner()">&times;</button>',document.body.appendChild(e),setTimeout(function(){e.classList.add("visible")},3e3))}}}function Yn(){Notification.requestPermission().then(function(e){j("amoghaNotifPerm",e),lt(),e==="granted"&&L("Notifications enabled!")})}function lt(){var e=document.getElementById("notif-banner");e&&(e.classList.remove("visible"),setTimeout(function(){e.remove()},400)),j("amoghaNotifDismissed","true")}function ct(e,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(e,{body:t,icon:"amogha-logo.png",badge:"amogha-logo.png",tag:"amogha-order"})}catch(n){navigator.serviceWorker&&navigator.serviceWorker.ready&&navigator.serviceWorker.ready.then(function(a){a.showNotification(e,{body:t,icon:"amogha-logo.png",tag:"amogha-order"})})}}function dt(){if(!(typeof firebase>"u"||!firebase.messaging))try{var e=firebase.messaging();e.getToken({vapidKey:"BAmoghaVapidKeyPlaceholder"}).then(function(t){t&&jn(t)}).catch(function(t){console.log("FCM token error (expected on some browsers):",t.message)}),e.onMessage(function(t){var n=t.notification?t.notification.title:"Amogha Cafe",a=t.notification?t.notification.body:"";ct(n,a),L(a||n)})}catch(t){}}function jn(e){try{var t=JSON.parse(localStorage.getItem("amoghaUser"));t&&t.phone&&window.db&&window.db.collection("users").doc(t.phone).update({fcmToken:e,fcmUpdatedAt:new Date().toISOString()}).catch(function(){})}catch(n){}j("amoghaFcmToken",e)}function $n(){setTimeout(Vn,5e3),setTimeout(dt,8e3)}Object.assign(window,{enableNotifications:Yn,dismissNotifBanner:lt,sendPushNotification:ct,initFCM:dt});function ut(){var e=document.getElementById("reservation-modal");if(e){var t=document.getElementById("reservation-form");if(!t||t.dataset.enhanced==="true"){e.style.display="block";return}t.dataset.enhanced="true";var n=new Date().toISOString().split("T")[0],a=new Date(Date.now()+7*864e5).toISOString().split("T")[0];t.innerHTML='<input type="text" id="res-name" placeholder="Your Name" required><input type="tel" id="res-phone" placeholder="Phone Number (10 digits)" required maxlength="10"><input type="date" id="res-date" min="'+n+'" max="'+a+'" required><div class="res-time-slots" id="res-time-slots"></div><input type="hidden" id="res-time" value=""><div class="res-party-size"><label>Party Size</label><div class="party-btns" id="party-btns"></div></div><textarea id="res-requests" placeholder="Special Requests (Optional)" rows="2"></textarea><div id="res-msg" class="auth-msg"></div><button type="submit" class="cta-button">Confirm Reservation</button>';for(var o=document.getElementById("party-btns"),r=1;r<=12;r++){var i=document.createElement("button");i.type="button",i.className="party-btn",i.textContent=r,i.dataset.size=r,i.onclick=function(){document.querySelectorAll(".party-btn").forEach(function(l){l.classList.remove("active")}),this.classList.add("active")},o.appendChild(i)}document.getElementById("res-date").addEventListener("change",function(){Xn(this.value)}),t.onsubmit=function(l){l.preventDefault(),mt()};var s=M();s&&(document.getElementById("res-name").value=s.name||"",document.getElementById("res-phone").value=s.phone||""),e.style.display="block"}}function Jn(){var e=document.getElementById("reservation-modal");e&&(e.style.display="none")}function Xn(e){var t=document.getElementById("res-time-slots");if(t){t.innerHTML='<label>Select Time</label><div class="time-grid" id="time-grid"></div>';for(var n=document.getElementById("time-grid"),a=new Date(e).getDay(),o=a===0?12:11,r=a===5||a===6?22:21,i=o;i<=r;i++)for(var s=0;s<60&&!(i===r&&s>0);s+=30){var l=String(i).padStart(2,"0")+":"+String(s).padStart(2,"0"),c=(i>12?i-12:i)+":"+String(s).padStart(2,"0")+(i>=12?" PM":" AM"),u=document.createElement("button");u.type="button",u.className="time-slot-btn",u.textContent=c,u.dataset.time=l,u.onclick=function(){document.querySelectorAll(".time-slot-btn").forEach(function(v){v.classList.remove("active")}),this.classList.add("active"),document.getElementById("res-time").value=this.dataset.time},n.appendChild(u)}}}function mt(){var e=document.getElementById("res-name").value.trim(),t=document.getElementById("res-phone").value.trim(),n=document.getElementById("res-date").value,a=document.getElementById("res-time").value,o=document.querySelector(".party-btn.active"),r=o?parseInt(o.dataset.size):0,i=document.getElementById("res-requests").value.trim(),s=document.getElementById("res-msg");if(!e||!t||!n||!a||!r){s.textContent="Please fill in all required fields.",s.className="auth-msg error";return}if(!/^\d{10}$/.test(t)){s.textContent="Please enter a valid 10-digit phone number.",s.className="auth-msg error";return}s.textContent="Booking your table...",s.className="auth-msg";var l=B();if(!l){s.textContent="Service unavailable. Please refresh and try again.",s.className="auth-msg error";return}var c={name:e,phone:t,date:n,time:a,partySize:r,requests:i,status:"pending",createdAt:new Date().toISOString()};l.collection("reservations").add(c).then(function(u){var v=document.getElementById("reservation-form"),b=new Date(n).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"}),h=a,x=parseInt(a.split(":")[0]),C=a.split(":")[1];h=(x>12?x-12:x)+":"+C+(x>=12?" PM":" AM"),v.innerHTML='<div class="res-confirmed"><div class="res-check">&#10003;</div><h3>Reservation Confirmed!</h3><p class="res-id">Booking #'+u.id.slice(-6).toUpperCase()+'</p><div class="res-details"><p>'+b+" at "+h+"</p><p>"+r+" Guest"+(r>1?"s":"")+'</p></div><a class="whatsapp-btn" href="https://wa.me/919121004999?text='+encodeURIComponent("Hi Amogha! I have a reservation:\nDate: "+b+"\nTime: "+h+"\nGuests: "+r+"\nName: "+e+"\nBooking: #"+u.id.slice(-6).toUpperCase())+'" target="_blank">Confirm via WhatsApp</a><button class="cta-button" onclick="document.getElementById(\'reservation-modal\').style.display=\'none\'" style="margin-top:1rem">Done</button></div>'}).catch(function(){s.textContent="Failed to book. Please try again.",s.className="auth-msg error"})}function Kn(){var e=document.querySelector(".cta-button.secondary");e&&e.textContent.indexOf("Reserve")!==-1&&(e.onclick=function(){ut()});var t=document.getElementById("reservation-form");t&&t.addEventListener("submit",n=>{n.preventDefault(),typeof showAuthToast=="function"&&showAuthToast("Reservation request received! We will confirm shortly."),n.target.reset();var a=document.getElementById("reservation-modal");a&&(a.style.display="none")})}Object.assign(window,{openReservationModal:ut,closeReservationModal:Jn,submitReservation:mt});function ft(e){e.parentElement.querySelectorAll(".spice-level").forEach(n=>n.classList.remove("active")),e.classList.add("active")}window.selectSpice=ft;function Qn(){const e=document.getElementById("reviews-carousel");if(!e)return;let t=0,n;function a(){return window.innerWidth<=768?1:window.innerWidth<=1024?2:3}function o(){const c=e.querySelector(".review-card");if(!c)return 0;const u=window.getComputedStyle(c);return c.offsetWidth+parseFloat(u.marginLeft)+parseFloat(u.marginRight)}function r(){const c=o();e.style.transform="translateX(-".concat(t*c,"px)")}window.moveCarousel=function(c){const u=e.querySelectorAll(".review-card"),v=a(),b=Math.max(0,u.length-v);t=Math.max(0,Math.min(t+c,b)),r(),s()};function i(){const c=e.querySelectorAll(".review-card"),u=a(),v=Math.max(0,c.length-u);t++,t>v&&(t=0),r()}function s(){clearInterval(n),n=setInterval(i,4e3)}const l=document.querySelector(".reviews-carousel-wrapper");l&&(l.addEventListener("mouseenter",()=>{clearInterval(n)}),l.addEventListener("mouseleave",()=>{s()})),window.addEventListener("resize",()=>{t=0,r(),s()}),n=setInterval(i,4e3)}function Zn(){const e=document.querySelectorAll(".gallery-slide"),t=document.getElementById("gallery-dots");let n=0;t&&e.length>1&&e.forEach((o,r)=>{const i=document.createElement("button");i.className="gallery-dot"+(r===0?" active":""),i.addEventListener("click",()=>a(r)),t.appendChild(i)});function a(o){e.forEach(i=>i.classList.remove("active")),e[o]&&e[o].classList.add("active"),n=o,document.querySelectorAll(".gallery-dot").forEach((i,s)=>i.classList.toggle("active",s===o))}window.moveGallerySlide=function(o){if(e.length===0)return;let r=(n+o+e.length)%e.length;a(r)},e.length>1&&setInterval(()=>{window.moveGallerySlide(1)},5e3)}function ea(){const e=document.querySelectorAll(".gallery-item img"),t=document.querySelectorAll(".gallery-slide-item img"),n=[...e,...t],a=document.getElementById("lightbox"),o=document.getElementById("lightbox-img");let r=0;n.forEach((i,s)=>{i.addEventListener("click",()=>{r=s,o.src=i.src,a.classList.add("active"),G()})}),window.closeLightbox=function(){a.classList.remove("active"),O()},window.navigateLightbox=function(i){r=(r+i+n.length)%n.length,o.src=n[r].src},document.addEventListener("keydown",i=>{a.classList.contains("active")&&(i.key==="Escape"&&window.closeLightbox(),i.key==="ArrowLeft"&&window.navigateLightbox(-1),i.key==="ArrowRight"&&window.navigateLightbox(1))})}function ta(e){if(e){var t=document.getElementById("video-lightbox"),n=document.getElementById("lightbox-video");!t||!n||(n.src=e,t.style.display="flex",n.play())}}function na(){var e=document.getElementById("video-lightbox"),t=document.getElementById("lightbox-video");e&&(e.style.display="none"),t&&(t.pause(),t.src="")}function pt(e){var t=M();if(t){var n=document.getElementById("review-modal");n||(n=document.createElement("div"),n.id="review-modal",n.className="modal",n.innerHTML='<div class="modal-content review-modal-content"></div>',document.body.appendChild(n),n.addEventListener("click",function(r){r.target===n&&(n.style.display="none")}));var a=e||S.map(function(r){return{name:r.name}}),o="<span class=\"close\" onclick=\"document.getElementById('review-modal').style.display='none'\">&times;</span>";o+='<h2>Rate Your Order</h2><p class="review-subtitle">Help us serve you better!</p>',o+='<div id="review-items">',a.forEach(function(r,i){o+='<div class="review-item" data-item="'+r.name+'"><span class="review-item-name">'+r.name+'</span><div class="review-stars" data-idx="'+i+'">';for(var s=1;s<=5;s++)o+='<span class="review-star" data-star="'+s+'" onclick="setReviewStar(this, '+i+", "+s+')">&#9734;</span>';o+="</div></div>"}),o+="</div>",o+='<textarea id="review-text" class="review-textarea" placeholder="Share your thoughts (optional)" maxlength="200"></textarea>',o+='<button class="cta-button" onclick="submitReviews()">Submit Review</button><span style="color:#D4A017;font-size:0.75rem;margin-left:8px">Earn 25 pts</span>',n.querySelector(".review-modal-content").innerHTML=o,n.style.display="block",window._reviewRatings=new Array(a.length).fill(0),window._reviewItems=a}}function aa(e,t,n){window._reviewRatings[t]=n;var a=e.parentElement;a.querySelectorAll(".review-star").forEach(function(o,r){o.innerHTML=r<n?"&#9733;":"&#9734;",o.classList.toggle("active",r<n)})}function oa(){var e=M();if(e){var t=document.getElementById("review-text").value.trim(),n=B(),a=n.batch(),o=!1;if(window._reviewItems.forEach(function(r,i){var s=window._reviewRatings[i];if(s>0){o=!0;var l=n.collection("reviews").doc();a.set(l,{itemName:r.name,rating:s,text:t,userName:e.name,userPhone:e.phone,createdAt:new Date().toISOString()})}}),!o){L("Please rate at least one item");return}a.commit().then(function(){document.getElementById("review-modal").style.display="none",L("Thank you for your review!");var r=M();if(r){r.loyaltyPoints=(r.loyaltyPoints||0)+25,H(r);var i=B();i&&i.collection("users").doc(r.phone).update({loyaltyPoints:r.loyaltyPoints}).catch(function(s){console.error("Review loyalty update error:",s)}),setTimeout(function(){L("+25 loyalty points for your review!")},1500)}setTimeout(function(){typeof window.loadMenuRatings=="function"&&window.loadMenuRatings()},1e3)}).catch(function(){L("Failed to submit review. Please try again.")})}}function ra(e){setTimeout(function(){M()&&pt(e)},6e4)}function ia(){var e={biryanis:[{name:"Veg Dum Biryani",price:179},{name:"Paneer Biryani",price:219},{name:"Egg Biryani",price:189},{name:"Chicken Fry Piece Biryani",price:219},{name:"Chicken 65 Biryani",price:249},{name:"Boneless Chicken Biryani",price:219}],starters:[{name:"Veg Manchurian",price:169},{name:"Paneer 65",price:189},{name:"Chicken 65",price:200},{name:"Chicken Hot Wings",price:220},{name:"Chilli Chicken",price:200}],drinks:[{name:"Tea",price:30},{name:"Coffee",price:40},{name:"Lassi",price:50},{name:"Buttermilk",price:35},{name:"Fresh Lime Soda",price:45}]},t={biryani:null,starter:null,drink:null},n=.15;function a(s,l,c){var u=document.getElementById(s);u&&(u.innerHTML=l.map(function(v){return'<button class="combo-option" data-category="'+c+'" data-name="'+v.name+'" data-price="'+v.price+'"><span class="combo-opt-name">'+v.name+'</span><span class="combo-opt-price">â‚¹'+v.price+"</span></button>"}).join(""))}function o(){a("combo-biryanis",e.biryanis,"biryani"),a("combo-starters",e.starters,"starter"),a("combo-drinks",e.drinks,"drink")}document.addEventListener("click",function(s){var l=s.target.closest(".combo-option");if(l){var c=l.dataset.category,u=l.dataset.name,v=parseInt(l.dataset.price);l.parentElement.querySelectorAll(".combo-option").forEach(function(b){b.classList.remove("selected")}),l.classList.add("selected"),t[c]={name:u,price:v},r()}});function r(){var s=document.getElementById("combo-selected"),l=document.getElementById("combo-original"),c=document.getElementById("combo-total"),u=document.getElementById("combo-add-btn");if(s){var v=[],b=0;if(t.biryani&&(v.push(t.biryani.name),b+=t.biryani.price),t.starter&&(v.push(t.starter.name),b+=t.starter.price),t.drink&&(v.push(t.drink.name),b+=t.drink.price),s.textContent=v.length>0?v.join(" + "):"Select items above",b>0){var h=Math.round(b*(1-n));l.textContent="â‚¹"+b,l.style.textDecoration="line-through",c.textContent="â‚¹"+h}else l.textContent="",c.textContent="";u&&(u.disabled=!(t.biryani&&t.starter&&t.drink))}}window.openComboModal=function(){o(),t={biryani:null,starter:null,drink:null},r();var s=document.getElementById("combo-modal");s&&(s.style.display="block",G())},window.closeComboModal=function(){var s=document.getElementById("combo-modal");s&&(s.style.display="none",O())};var i=document.getElementById("combo-modal");i&&i.addEventListener("click",function(s){s.target===i&&window.closeComboModal()}),window.addComboToCart=function(){if(!(!t.biryani||!t.starter||!t.drink)){var s=t.biryani.price+t.starter.price+t.drink.price,l=Math.round(s*(1-n)),c="Combo: "+t.biryani.name+" + "+t.starter.name+" + "+t.drink.name,u=S.find(function(v){return v.name===c});u?u.quantity++:S.push({name:c,price:l,quantity:1}),X(),ne(),ae(),xe(),L("Combo added! You saved â‚¹"+(s-l)),window.closeComboModal()}}}function vt(){for(var e=new Date,t=e.getDay(),n=e.getHours(),a=0;a<Ve.length;a++){var o=Ve[a];if(o.days.indexOf(t)!==-1&&n>=o.startHour&&n<o.endHour)return o}return null}function $e(){var e=vt(),t=document.getElementById("happy-hour-banner");if(!e){t&&(t.style.display="none"),document.querySelectorAll(".hh-price").forEach(function(s){s.remove()}),document.querySelectorAll(".price.hh-crossed").forEach(function(s){s.classList.remove("hh-crossed")});return}if(!t){t=document.createElement("div"),t.id="happy-hour-banner",t.className="happy-hour-banner";var n=document.getElementById("menu");n&&n.insertBefore(t,n.firstChild)}var a=new Date;a.setHours(e.endHour,0,0,0);var o=Math.max(0,a-new Date),r=Math.floor(o/6e4),i=Math.floor(o%6e4/1e3);t.innerHTML='<span class="hh-icon">ðŸ”¥</span> <strong class="hh-text">'+e.label+'</strong> <span class="hh-timer">Ends in '+r+"m "+i+"s</span>",t.style.display="flex",document.querySelectorAll(".menu-item-card").forEach(function(s){var l=s.querySelector(".price");if(l){var c=s.closest(".menu-category");if(c){var u=(c.id||"").toLowerCase(),v=e.categories.indexOf("all")!==-1;if(v||e.categories.forEach(function(I){u.indexOf(I)!==-1&&(v=!0)}),!!v){var b=parseInt(l.textContent.replace(/[^\d]/g,"")),h=Math.round(b*(1-e.discount/100));l.classList.add("hh-crossed");var x=s.querySelector(".hh-price");if(x)x.textContent="â‚¹"+h;else{var C=document.createElement("span");C.className="hh-price",C.textContent="â‚¹"+h,l.after(C)}}}}})}function gt(){if(S.length===0)return[];var e={},t=S.map(function(a){return a.name});t.forEach(function(a){var o=Xe[a]||[];o.forEach(function(r){t.indexOf(r)===-1&&ve[r]&&(e[r]=(e[r]||0)+1)})});var n=Object.keys(e).sort(function(a,o){return e[o]-e[a]});return n.slice(0,4).map(function(a){return{name:a,price:ve[a]}})}function _e(){var e=document.getElementById("cart-recommendations");if(e){var t=gt();if(t.length===0){e.style.display="none";return}var n='<p class="rec-title">You might also like:</p><div class="rec-items">';t.forEach(function(a){n+='<button class="rec-item" onclick="addToCart(\''+a.name.replace(/'/g,"\\'")+"', "+a.price+'); displayCart(); showRecommendations();"><span class="rec-name">'+a.name+'</span><span class="rec-price">â‚¹'+a.price+'</span><span class="rec-add">+</span></button>'}),n+="</div>",e.innerHTML=n,e.style.display="block"}}var se=!1,J=null;function yt(){var e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){J=new e,J.continuous=!1,J.interimResults=!0,J.lang="en-IN",J.onresult=function(n){for(var a="",o=n.resultIndex;o<n.results.length;o++)a+=n.results[o][0].transcript;sa(a),n.results[n.resultIndex].isFinal&&la(a)},J.onend=function(){se&&(se=!1,le())},J.onerror=function(){se=!1,le()};var t=document.createElement("button");t.id="voice-order-btn",t.className="voice-order-btn",t.innerHTML='<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>',t.title="Voice Order",t.onclick=ht,document.body.appendChild(t)}}function ht(){se?(J.stop(),se=!1,le()):(se=!0,bt(),J.start())}function bt(){var e=document.getElementById("voice-overlay");e||(e=document.createElement("div"),e.id="voice-overlay",e.className="voice-overlay",e.innerHTML='<div class="voice-content"><div class="voice-waves"><span></span><span></span><span></span><span></span><span></span></div><p class="voice-status">Listening...</p><p class="voice-transcript" id="voice-transcript"></p><p class="voice-hint">Say "Add chicken biryani" or "2 butter naan"</p><button class="voice-close" onclick="toggleVoice()">Cancel</button></div>',document.body.appendChild(e)),e.classList.add("active"),document.getElementById("voice-transcript").textContent=""}function le(){var e=document.getElementById("voice-overlay");e&&e.classList.remove("active")}function sa(e){var t=document.getElementById("voice-transcript");t&&(t.textContent=e)}function la(e){e=e.toLowerCase().trim();var t=e.match(/^(?:add\s+)?(\d+)\s+/),n=t?parseInt(t[1]):1,a=e.replace(/^(?:add\s+)?(\d+\s+)?/,"").replace(/^add\s+/,""),o=null,r=0;if(Object.keys(ve).forEach(function(s){var l=s.toLowerCase(),c=0;if(l===a)c=100;else if(l.indexOf(a)!==-1)c=80;else if(a.indexOf(l)!==-1)c=70;else{var u=a.split(" ");u.forEach(function(v){v.length>2&&l.indexOf(v)!==-1&&(c+=20)})}c>r&&(r=c,o=s)}),o&&r>=20){for(var i=0;i<n;i++)de(o,ve[o]);L("Added "+n+"x "+o+" to cart"),le()}else e.indexOf("checkout")!==-1||e.indexOf("check out")!==-1?(typeof window.checkout=="function"&&window.checkout(),le()):e.indexOf("clear")!==-1?(typeof window.clearCart=="function"&&window.clearCart(),le()):L('Could not find: "'+a+'". Try again.')}var fe=V("amoghaLang")||"en";function ca(e){fe=e,j("amoghaLang",e),ze(),document.querySelectorAll(".lang-btn").forEach(function(t){t.classList.toggle("active",t.dataset.lang===e)})}function ze(){var e=Ye[fe]||Ye.en;document.querySelectorAll("[data-i18n]").forEach(function(t){var n=t.dataset.i18n;e[n]&&((t.tagName==="INPUT"||t.tagName==="TEXTAREA")&&t.placeholder!==void 0?t.placeholder=e[n]:t.textContent=e[n])})}function wt(e){if(!e)return"";var t=(e.name||"USER").replace(/[^A-Za-z]/g,"").toUpperCase().slice(0,4),n=(e.phone||"0000").slice(-4);return t+n}function da(){var e=M();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=e.referralCode||wt(e);if(!e.referralCode){e.referralCode=t,H(e);var n=B();n&&n.collection("users").doc(e.phone).update({referralCode:t}).catch(function(r){console.error("Referral code save error:",r)})}var a=document.getElementById("referral-modal");a||(a=document.createElement("div"),a.id="referral-modal",a.className="modal",a.innerHTML='<div class="modal-content referral-content"></div>',document.body.appendChild(a),a.addEventListener("click",function(r){r.target===a&&(a.style.display="none")}));var o="Order from Amogha Cafe & get Rs.50 off your first order! Use my referral code: "+t+" when signing up. Order at "+window.location.origin;a.querySelector(".referral-content").innerHTML='<span class="close" onclick="document.getElementById(\'referral-modal\').style.display=\'none\'">&times;</span><h2>Refer a Friend</h2><p class="referral-subtitle">Share your code and both get rewarded!</p><div class="referral-code-box"><span class="referral-code">'+t+'</span><button class="referral-copy" onclick="safeCopy(\''+t+'\',this)">Copy</button></div><div class="referral-rewards"><div class="referral-reward"><span class="referral-reward-icon">ðŸŽ</span><span>Your friend gets <strong>Rs.50 off</strong> first order</span></div><div class="referral-reward"><span class="referral-reward-icon">â­</span><span>You get <strong>100 loyalty points</strong></span></div></div><a class="whatsapp-btn referral-share" href="https://wa.me/?text='+encodeURIComponent(o)+'" target="_blank">Share via WhatsApp</a>',a.style.display="block"}function ua(){var e=document.getElementById("referral-modal");e&&(e.style.display="none")}function ma(e){if(e){var t=B();t&&(e=e.toUpperCase().trim(),t.collection("users").where("referralCode","==",e).limit(1).get().then(function(n){if(!n.empty){var a=n.docs[0],o=a.data(),r=M();!r||o.phone===r.phone||(t.collection("referrals").add({referrerPhone:o.phone,refereePhone:r.phone,redeemed:!1,createdAt:new Date().toISOString()}).catch(function(i){console.error("Referral save error:",i)}),r.referralDiscount=50,H(r),L("Referral applied! Rs.50 off your first order!"))}}))}}function fa(){var e=M();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=document.getElementById("myorders-modal");t||(t=document.createElement("div"),t.id="myorders-modal",t.className="modal",t.innerHTML='<div class="modal-content myorders-content"><span class="close" onclick="document.getElementById(\'myorders-modal\').style.display=\'none\'">&times;</span><h2>My Orders</h2><div id="myorders-list" class="myorders-list"><p>Loading...</p></div></div>',document.body.appendChild(t),t.addEventListener("click",function(o){o.target===t&&(t.style.display="none")})),t.style.display="block";var n=document.getElementById("myorders-list");n.innerHTML='<p style="text-align:center;color:#a09080">Loading orders...</p>';var a=B();if(!a){n.innerHTML='<p style="text-align:center;color:#a09080;padding:2rem">Service unavailable. Please refresh.</p>';return}a.collection("orders").where("userId","==",e.phone).orderBy("createdAt","desc").limit(10).get().then(function(o){if(o.empty){n.innerHTML='<p style="text-align:center;color:#a09080;padding:2rem">No orders yet. Place your first order!</p>';return}var r="";o.forEach(function(i){var s=i.data(),l=s.createdAt?new Date(s.createdAt):new Date,c=l.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),u={pending:"#f39c12",confirmed:"#3498db",preparing:"#e67e22",delivered:"#27ae60",cancelled:"#e74c3c"},v=u[s.status]||"#999",b=(s.items||[]).map(function(h){return h.name+" x"+h.qty}).join(", ");r+='<div class="myorder-card"><div class="myorder-header"><span class="myorder-date">'+c+'</span><span class="myorder-status" style="color:'+v+'">'+(s.status||"pending").toUpperCase()+'</span></div><p class="myorder-items">'+b+'</p><div class="myorder-footer"><span class="myorder-total">Rs.'+(s.total||0)+'</span><button class="myorder-reorder-btn" onclick="reorderFromHistory(\''+i.id+"')\">Order Again</button></div></div>"}),n.innerHTML=r,j("amoghaMyOrders",JSON.stringify(o.docs.map(function(i){return{id:i.id,data:i.data()}})))}).catch(function(o){console.error("Load orders error:",o);var r=V("amoghaMyOrders");if(r){var i=JSON.parse(r),s="";i.forEach(function(l){var c=l.data,u=c.createdAt?new Date(c.createdAt):new Date,v=u.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),b=(c.items||[]).map(function(h){return h.name+" x"+h.qty}).join(", ");s+='<div class="myorder-card"><div class="myorder-header"><span class="myorder-date">'+v+'</span><span class="myorder-status">'+(c.status||"").toUpperCase()+'</span></div><p class="myorder-items">'+b+'</p><div class="myorder-footer"><span class="myorder-total">Rs.'+(c.total||0)+'</span><button class="myorder-reorder-btn" onclick="reorderFromHistory(\''+l.id+"')\">Order Again</button></div></div>"}),n.innerHTML=s}else n.innerHTML='<p style="text-align:center;color:#e74c3c">Failed to load orders. Please try again.</p>'})}function pa(){var e=document.getElementById("myorders-modal");e&&(e.style.display="none")}function va(e){var t=V("amoghaMyOrders");if(t){var n=JSON.parse(t),a=n.find(function(r){return r.id===e});if(a&&a.data.items){a.data.items.forEach(function(r){for(var i=0;i<r.qty;i++)de(r.name,r.price)}),document.getElementById("myorders-modal").style.display="none",L("Items added to cart! Review and checkout.");return}}var o=B();o.collection("orders").doc(e).get().then(function(r){r.exists&&r.data().items&&(r.data().items.forEach(function(i){for(var s=0;s<i.qty;s++)de(i.name,i.price)}),document.getElementById("myorders-modal").style.display="none",L("Items added to cart! Review and checkout."))})}function ga(){var e=document.getElementById("schedule-order-check"),t=document.getElementById("schedule-fields"),n=document.getElementById("schedule-date"),a=document.getElementById("schedule-time");if(!e||!t||!n||!a)return;e.addEventListener("change",function(){t.style.display=this.checked?"block":"none",this.checked&&(o(),r())});function o(){var i=new Date,s=i.toISOString().split("T")[0],l=new Date(i);l.setDate(l.getDate()+3);var c=l.toISOString().split("T")[0];n.min=s,n.max=c,n.value=s}function r(){var i=["11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM"];a.innerHTML='<option value="">Select Time</option>',i.forEach(function(s){a.innerHTML+='<option value="'+s+'">'+s+"</option>"})}window.getScheduleInfo=function(){return e.checked?{date:n.value,time:a.value}:null}}function ya(){Qn(),Zn(),ea(),ia(),$e(),setInterval($e,6e4),setTimeout(yt,1e3),setTimeout(function(){var t=document.querySelector(".nav-links");if(t){var n=document.createElement("li");n.className="lang-switcher",n.innerHTML='<button class="lang-btn'+(fe==="en"?" active":"")+'" data-lang="en" onclick="switchLanguage(\'en\')">EN</button><button class="lang-btn'+(fe==="hi"?" active":"")+'" data-lang="hi" onclick="switchLanguage(\'hi\')">à¤¹à¤¿</button><button class="lang-btn'+(fe==="te"?" active":"")+'" data-lang="te" onclick="switchLanguage(\'te\')">à°¤à±†</button>';var a=t.querySelector(".theme-toggle");a?t.insertBefore(n,a.parentElement):t.appendChild(n),ze()}},500),setTimeout(function(){typeof window.loadMenuRatings=="function"&&window.loadMenuRatings()},2e3),ga(),setTimeout(It,1500);var e=window.displayCart;typeof e=="function"&&(window.displayCart=function(){e(),_e()})}function ha(e){var t=[],n;for(n=0;n<e.length;n++)t.push(e[n].name);var a=[],o={};for(n=0;n<e.length;n++){var r=e[n].name,i=Xe[r];if(i)for(var s=0;s<i.length;s++){var l=i[s];if(t.indexOf(l)===-1&&!o[l]){var c=ve[l];if(c&&(o[l]=!0,a.push({name:l,price:c,reason:"Goes great with "+r}),a.length>=3))return a}}}return a}Object.assign(window,{selectSpice:ft,moveCarousel:window.moveCarousel,moveGallerySlide:window.moveGallerySlide,closeLightbox:window.closeLightbox,navigateLightbox:window.navigateLightbox,openVideoLightbox:ta,closeVideoLightbox:na,openReviewModal:pt,setReviewStar:aa,submitReviews:oa,scheduleReviewPrompt:ra,openComboModal:window.openComboModal,closeComboModal:window.closeComboModal,addComboToCart:window.addComboToCart,getActiveHappyHour:vt,getRecommendations:gt,showRecommendations:_e,initVoiceOrdering:yt,toggleVoice:ht,showVoiceOverlay:bt,switchLanguage:ca,applyTranslations:ze,openReferralModal:da,closeReferralModal:ua,generateReferralCode:wt,applyReferralAtSignup:ma,openMyOrders:fa,closeMyOrders:pa,reorderFromHistory:va,loadDailySpecial:Et,initComboBuilder:xt,getUpsellItems:ha});function ba(){var e=null;try{e=JSON.parse(localStorage.getItem("amoghaMyOrders"))}catch(i){}if(!(!e||!e.length)){var t=e[0].data;if(!(!t||!t.items||!t.items.length)){if(t.createdAt){var n=(Date.now()-new Date(t.createdAt).getTime())/864e5;if(n<1)return}var a=t.items.slice(0,2).map(function(i){return i.name}).join(", ");t.items.length>2&&(a+=" +"+(t.items.length-2)+" more");var o=document.createElement("div");o.className="reorder-toast",o.innerHTML='<div class="reorder-toast-text"><div class="reorder-toast-title">Welcome back! ðŸ‘‹</div><div class="reorder-toast-sub">'+a+'</div></div><button class="reorder-toast-btn" id="reorder-toast-btn">Order Again</button><button class="reorder-toast-close" id="reorder-toast-close">&times;</button>',document.body.appendChild(o),setTimeout(function(){o.classList.add("show")},100);var r=e[0].id;o.querySelector("#reorder-toast-btn").addEventListener("click",function(){typeof window.reorderFromHistory=="function"&&window.reorderFromHistory(r),o.classList.remove("show"),setTimeout(function(){o.remove()},400)}),o.querySelector("#reorder-toast-close").addEventListener("click",function(){o.classList.remove("show"),setTimeout(function(){o.remove()},400)}),setTimeout(function(){o.classList.remove("show"),setTimeout(function(){o.parentNode&&o.remove()},400)},8e3)}}}function Et(){var e=document.getElementById("daily-special-section");if(e){var t=null;try{t=window.db}catch(n){}if(!t){e.style.display="none";return}t.collection("settings").doc("dailySpecial").get().then(function(n){if(!n.exists||!n.data().active){e.style.display="none";return}var a=n.data();e.style.display="";var o=e.querySelector(".daily-special-img"),r=e.querySelector(".daily-special-img-placeholder"),i=e.querySelector(".daily-special-title"),s=e.querySelector(".daily-special-desc"),l=e.querySelector(".daily-special-price"),c=e.querySelector(".daily-special-add-btn");a.imageUrl&&o&&(o.src=a.imageUrl,o.style.display="block",r&&(r.style.display="none")),i&&(i.textContent=a.title||"Chef's Special"),s&&(s.textContent=a.description||""),l&&(l.innerHTML="&#8377;"+(a.price||"")),c&&a.title&&(c.dataset.item=a.title,c.dataset.price=a.price||0);function u(){var v=new Date,b=new Date;b.setHours(24,0,0,0);var h=Math.max(0,b-v),x=Math.floor(h/36e5),C=Math.floor(h%36e5/6e4),I=Math.floor(h%6e4/1e3),N=e.querySelector(".cd-h"),A=e.querySelector(".cd-m"),D=e.querySelector(".cd-s");N&&(N.textContent=String(x).padStart(2,"0")),A&&(A.textContent=String(C).padStart(2,"0")),D&&(D.textContent=String(I).padStart(2,"0"))}u(),setInterval(u,1e3)}).catch(function(){e.style.display="none"})}}function xt(){var e=document.getElementById("combo-builder-section");if(!e)return;var t={starter:["Veg Manchurian","Paneer 65","Chicken 65","Chicken Hot Wings","Veg Spring Rolls","Chicken Lollipop","Paneer Tikka","Chicken Seekh Kebab","Tandoori Chicken"],main:["Paneer Butter Masala","Dal Tadka","Butter Chicken","Chicken Curry","Mutton Curry","Gongura Chicken","Veg Dum Biryani","Chicken Dum Biryani","Mutton Dum Biryani"],bread:["Butter Naan","Garlic Naan","Tandoori Roti","Butter Roti","Laccha Paratha"],drink:["Tea","Coffee","Lassi","Buttermilk","Fresh Lime Soda","Hot Chocolate"]},n={};try{document.querySelectorAll(".menu-item-card[data-id]").forEach(function(s){var l=s.querySelector(".add-to-cart");l&&(n[s.dataset.id]=parseFloat(l.dataset.price)||0)})}catch(s){}var a={"Veg Manchurian":169,"Paneer 65":189,"Chicken 65":200,"Chicken Hot Wings":220,"Veg Spring Rolls":149,"Chicken Lollipop":230,"Paneer Tikka":209,"Chicken Seekh Kebab":229,"Tandoori Chicken":269,"Paneer Butter Masala":199,"Dal Tadka":149,"Butter Chicken":249,"Chicken Curry":219,"Mutton Curry":319,"Gongura Chicken":239,"Veg Dum Biryani":199,"Chicken Dum Biryani":249,"Mutton Dum Biryani":349,"Butter Naan":40,"Garlic Naan":50,"Tandoori Roti":30,"Butter Roti":35,"Laccha Paratha":45,Tea:30,Coffee:40,Lassi:50,Buttermilk:35,"Fresh Lime Soda":45,"Hot Chocolate":60};Object.keys(a).forEach(function(s){n[s]||(n[s]=a[s])});function o(s,l){var c=e.querySelector("#"+s);c&&(c.innerHTML='<option value="">â€” Choose â€”</option>'+l.map(function(u){var v=n[u]||0;return'<option value="'+u+'" data-price="'+v+'">'+u+" (â‚¹"+v+")</option>"}).join(""))}o("combo-starter",t.starter),o("combo-main",t.main),o("combo-bread",t.bread),o("combo-drink",t.drink);function r(){var s=0;["combo-starter","combo-main","combo-bread","combo-drink"].forEach(function(x){var C=e.querySelector("#"+x);if(C&&C.value){var I=C.options[C.selectedIndex];s+=parseFloat(I.dataset.price)||0}});var l=Math.round(s*.8),c=s-l,u=e.querySelector(".combo-original"),v=e.querySelector(".combo-discounted"),b=e.querySelector(".combo-savings"),h=e.querySelector(".combo-add-btn");u&&(u.textContent=s>0?"â‚¹"+s:""),v&&(v.textContent=s>0?"â‚¹"+l:"â‚¹0"),b&&(b.textContent=s>0?"Save â‚¹"+c:""),h&&(h.disabled=s===0)}e.querySelectorAll("select").forEach(function(s){s.addEventListener("change",r)}),r();var i=e.querySelector(".combo-add-btn");i&&i.addEventListener("click",function(){var s=0;["combo-starter","combo-main","combo-bread","combo-drink"].forEach(function(l){var c=e.querySelector("#"+l);if(!(!c||!c.value)){var u=c.options[c.selectedIndex],v=parseFloat(u.dataset.price)||0,b=Math.round(v*.8);typeof window.finalizeAddToCart=="function"&&window.finalizeAddToCart(c.value,b,"medium",[]),s++}}),s>0&&(i.textContent="âœ“ Added to Cart!",i.style.background="linear-gradient(135deg,#27ae60,#2ecc71)",setTimeout(function(){i.textContent="Add Combo to Cart",i.style.background=""},2e3))})}function Ct(){const e=B();if(!e)return;const t=document.querySelector(".bar-ticker-track");t&&e.collection("orders").orderBy("createdAt","desc").limit(6).get().then(function(n){const a=[];if(n.forEach(function(i){const s=i.data(),l=s.items&&s.items[0]&&s.items[0].name?s.items[0].name:null,u=(s.customerName||s.userName||"").split(" ")[0]||"Someone";l&&a.push({firstName:u,itemName:l})}),a.length<3)return;function o(i,s){return'<div class="bar-ticker-item"><span>'.concat(i,"</span><span>").concat(s,'</span></div><span class="bar-dot"></span>')}const r=a.map(function(i){return o("ðŸ›","".concat(i.firstName," just ordered ").concat(i.itemName))}).join("");t.innerHTML=r+r}).catch(function(){})}window.initLiveOrderTicker=Ct;function wa(){const e=document.getElementById("catering-modal");e&&(e.classList.add("active"),G())}window.openCateringModal=wa;function St(){const e=document.getElementById("catering-modal");e&&(e.classList.remove("active"),O())}window.closeCateringModal=St;function Ea(){var c,u,v,b,h,x;const e=B(),t=(c=document.getElementById("catering-name"))==null?void 0:c.value.trim(),n=(u=document.getElementById("catering-phone"))==null?void 0:u.value.trim(),a=(v=document.getElementById("catering-event"))==null?void 0:v.value,o=(b=document.getElementById("catering-guests"))==null?void 0:b.value,r=(h=document.getElementById("catering-date"))==null?void 0:h.value,i=(x=document.getElementById("catering-message"))==null?void 0:x.value.trim(),s=document.getElementById("catering-submit-btn");if(!t||!n||!a||!o||!r){alert("Please fill in all required fields.");return}s&&(s.disabled=!0,s.textContent="Submittingâ€¦");const l={name:t,phone:n,eventType:a,guestCount:parseInt(o)||0,date:r,message:i||"",createdAt:new Date().toISOString()};(e?e.collection("cateringInquiries").add(l):Promise.reject("no db")).then(function(){St();const C=document.createElement("div");C.className="catering-toast",C.textContent="âœ… Catering enquiry received! We'll contact you within 24 hours.",document.body.appendChild(C),setTimeout(function(){C.classList.add("show")},10),setTimeout(function(){C.classList.remove("show"),setTimeout(function(){C.remove()},400)},4e3)}).catch(function(){alert("Could not submit. Please call us at +91 91210 04999."),s&&(s.disabled=!1,s.textContent="Submit Enquiry")})}window.submitCateringEnquiry=Ea;function kt(){var e=document.getElementById("reorder-section"),t=document.getElementById("reorder-cards");if(!(!e||!t)){var n=M();if(!n){e.style.display="none";return}var a=null;try{a=JSON.parse(localStorage.getItem("amoghaMyOrders"))}catch(i){}if(!a||!a.length){e.style.display="none";return}var o=a.slice(0,3),r="";o.forEach(function(i){var s=i.data,l=s.createdAt?new Date(s.createdAt):new Date,c=l.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),u=(s.items||[]).reduce(function(b,h){return b+(h.qty||1)},0),v=s.total||0;r+='<div class="reorder-card" style="min-width:220px;background:rgba(212,160,23,0.06);border:1px solid rgba(212,160,23,0.15);border-radius:14px;padding:1rem;scroll-snap-align:start;flex-shrink:0"><div style="font-size:0.8rem;color:#a09080;margin-bottom:0.4rem">'+c+'</div><div style="font-size:0.95rem;font-weight:600;color:var(--text-primary,#1a0f08);margin-bottom:0.3rem">'+u+" item"+(u!==1?"s":"")+'</div><div style="font-size:1.05rem;font-weight:700;color:#D4A017;margin-bottom:0.7rem">Rs.'+v+"</div><button onclick=\"reorderFromHistory('"+i.id+'\')" style="width:100%;padding:0.5rem;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.85rem">Reorder</button></div>'}),t.innerHTML=r,e.style.display="block"}}window.initOrderAgainSection=kt;function It(){var e=B();e&&e.collection("settings").doc("dynamicPricing").get().then(function(t){t.exists&&t.data().rules&&(ee.length=0,t.data().rules.forEach(function(n){ee.push(n)}),Bt())}).catch(function(t){console.error("Dynamic pricing load error:",t)})}window.loadDynamicPricingRules=It;function Lt(e,t){if(!ee||ee.length===0)return e;for(var n=new Date,a=n.getDay(),o=n.getHours(),r=(t||"").toLowerCase(),i=0;i<ee.length;i++){var s=ee[i],l=s.day==="all"||parseInt(s.day)===a;if(l&&!(o<parseInt(s.startHour)||o>=parseInt(s.endHour))){for(var c=s.categories||[],u=!1,v=0;v<c.length;v++)if(c[v].toLowerCase()===r){u=!0;break}if(u)return Math.round(e*parseFloat(s.multiplier))}}return e}window.getAdjustedPrice=Lt;function Bt(){!ee||ee.length===0||document.querySelectorAll(".menu-item-card").forEach(function(e){var t=e.querySelector(".price");if(t&&!t.classList.contains("hh-crossed")){var n=e.closest(".menu-category");if(n){var a="",o=n.querySelector("h2, h3, .category-title");o&&(a=o.textContent.trim()),a||(a=(n.id||"").replace("cat-",""));var r=parseInt(t.textContent.replace(/[^\d]/g,""));if(r){var i=Lt(r,a);if(i===r){var s=e.querySelector(".dp-price");s&&s.remove(),t.classList.remove("dp-crossed");return}t.classList.add("dp-crossed");var l=e.querySelector(".dp-price");if(l)l.textContent="â‚¹"+i;else{var c=document.createElement("span");c.className="dp-price",c.textContent="â‚¹"+i,t.after(c)}}}}})}window.applyDynamicPricing=Bt;var ce=[{id:"first_bite",name:"First Bite",description:"Place your first order",icon:"ðŸ½ï¸"},{id:"regular",name:"Regular",description:"5 orders completed",icon:"â­"},{id:"foodie",name:"Foodie",description:"10 orders completed",icon:"ðŸ…"},{id:"super_fan",name:"Super Fan",description:"25 orders completed",icon:"ðŸ†"},{id:"explorer",name:"Explorer",description:"Order from all menu categories",icon:"ðŸ—ºï¸"},{id:"streak_master",name:"Streak Master",description:"3 consecutive days with orders",icon:"ðŸ”¥"},{id:"big_spender",name:"Big Spender",description:"Single order over â‚¹1000",icon:"ðŸ’Ž"},{id:"critic",name:"Critic",description:"Write 5 reviews",icon:"ðŸ“"},{id:"night_owl",name:"Night Owl",description:"Order after 9 PM",icon:"ðŸ¦‰"},{id:"early_bird",name:"Early Bird",description:"Order before 10 AM",icon:"ðŸ¦"}],xa=["starters","curries","biryani","tandoor","noodles","rice","breads","beverages"];function Ca(){return ce.slice()}function Y(e,t){for(var n=e.badges||[],a=0;a<n.length;a++)if(n[a].badgeId===t)return!0;return!1}function Sa(e,t){e.badges||(e.badges=[]),e.badges.push({badgeId:t,earnedAt:new Date().toISOString()}),H(e);var n=B();n&&e.phone&&n.collection("users").doc(e.phone).update({badges:e.badges}).catch(function(r){console.error("Badge save error:",r)});for(var a=null,o=0;o<ce.length;o++)if(ce[o].id===t){a=ce[o];break}a&&ka(a)}function ka(e){var t=document.getElementById("badge-toast");t||(t=document.createElement("div"),t.id="badge-toast",t.className="badge-toast",document.body.appendChild(t)),t.innerHTML='<span style="font-size:1.4rem">'+e.icon+"</span> Badge Unlocked: "+e.name+"!",t.classList.remove("visible"),t.offsetWidth,t.classList.add("visible"),setTimeout(function(){t.classList.remove("visible")},4e3)}function Ia(e,t){if(e){var n=[],a=(e.orderDates||[]).length,o=new Date().toISOString().split("T")[0],r=e.orderDates||[];if(r.indexOf(o)===-1&&a++,!Y(e,"first_bite")&&a>=1&&n.push("first_bite"),!Y(e,"regular")&&a>=5&&n.push("regular"),!Y(e,"foodie")&&a>=10&&n.push("foodie"),!Y(e,"super_fan")&&a>=25&&n.push("super_fan"),!Y(e,"explorer")){var i=e.categoriesOrdered||[];t&&t.items&&(t.items.forEach(function(N){N.category&&i.indexOf(N.category)===-1&&i.push(N.category)}),e.categoriesOrdered=i),i.length>=xa.length&&n.push("explorer")}if(!Y(e,"streak_master")){var s=(e.orderDates||[]).slice();if(s.indexOf(o)===-1&&s.push(o),s.length>=3){var l=s.slice(-3),c=new Date(l[0]),u=new Date(l[1]),v=new Date(l[2]),b=(u-c)/864e5,h=(v-u)/864e5;b===1&&h===1&&n.push("streak_master")}}if(!Y(e,"big_spender")&&t&&t.total>1e3&&n.push("big_spender"),!Y(e,"critic")&&(e.reviewCount||0)>=5&&n.push("critic"),!Y(e,"night_owl")){var x=new Date().getHours();x>=21&&n.push("night_owl")}if(!Y(e,"early_bird")){var C=new Date().getHours();C<10&&n.push("early_bird")}var I=0;n.forEach(function(N){setTimeout(function(){Sa(e,N)},I),I+=1500})}}function La(){var e=M(),t=e&&e.badges?e.badges:[],n=document.getElementById("badge-gallery-modal");n||(n=document.createElement("div"),n.id="badge-gallery-modal",n.className="badge-gallery-modal",n.innerHTML='<div class="badge-gallery-content"></div>',document.body.appendChild(n),n.addEventListener("click",function(i){i.target===n&&Mt()}));var a=t.length,o=ce.length,r="";ce.forEach(function(i){for(var s=!1,l="",c=0;c<t.length;c++)if(t[c].badgeId===i.id){s=!0;var u=new Date(t[c].earnedAt);l=u.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"});break}var v=s?"earned":"unearned";r+='<div class="badge-card '+v+'"><span class="badge-card-icon">'+i.icon+'</span><div class="badge-card-name">'+i.name+'</div><div class="badge-card-desc">'+i.description+"</div>"+(s?'<div class="badge-card-date">'+l+"</div>":"")+"</div>"}),n.querySelector(".badge-gallery-content").innerHTML='<button class="badge-gallery-close" onclick="closeBadgeGallery()">&times;</button><div class="badge-gallery-title">Your Badges</div><div class="badge-gallery-subtitle">'+a+" of "+o+' badges earned</div><div class="badge-grid">'+r+"</div>",n.classList.add("show")}function Mt(){var e=document.getElementById("badge-gallery-modal");e&&e.classList.remove("show")}Object.assign(window,{checkAndAwardBadges:Ia,openBadgeGallery:La,closeBadgeGallery:Mt,getBadgeDefinitions:Ca});var Ba=["Vegetarian","Vegan","Gluten-Free"],Ma=["Nuts","Dairy","Gluten","Eggs","Soy","Shellfish","Sesame","Fish"];function Ge(){var e=M();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=document.getElementById("profile-modal");t||(t=document.createElement("div"),t.id="profile-modal",t.className="modal",t.innerHTML='<div class="modal-content" style="max-width:520px;max-height:90vh;overflow-y:auto;"></div>',document.body.appendChild(t),t.addEventListener("click",function(l){l.target===t&&pe()}));var n=e.dietaryPrefs||[],a=e.allergenAlerts||[],o=e.savedAddresses||[],r=Ba.map(function(l){var c=n.indexOf(l)!==-1?" checked":"";return'<label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" class="profile-dietary-cb" value="'+l+'"'+c+"> "+l+"</label>"}).join(""),i=Ma.map(function(l){var c=a.indexOf(l)!==-1?" checked":"";return'<label style="display:flex;align-items:center;gap:8px;cursor:pointer;"><input type="checkbox" class="profile-allergen-cb" value="'+l+'"'+c+"> "+l+"</label>"}).join(""),s=o.length>0?o.map(function(l,c){return'<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:var(--bg-light,#f9f9f9);border-radius:8px;margin-bottom:6px;"><div><strong>'+(l.label||"Address")+'</strong><br><span style="font-size:0.9em;color:#666;">'+(l.address||"")+'</span></div><button onclick="removeAddress('+c+')" style="background:none;border:none;color:#e53935;cursor:pointer;font-size:1.2em;" title="Remove">&times;</button></div>'}).join(""):'<p style="color:#999;font-size:0.9em;">No saved addresses yet.</p>';t.querySelector(".modal-content").innerHTML='<span class="close" onclick="closeProfileModal()">&times;</span><h2 style="margin:0 0 20px;font-size:1.4em;">My Profile</h2><div style="margin-bottom:14px;"><label style="font-weight:600;font-size:0.9em;display:block;margin-bottom:4px;">Name</label><input type="text" id="profile-name" value="'+(e.name||"").replace(/"/g,"&quot;")+'" style="width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:8px;font-size:1em;box-sizing:border-box;"></div><div style="margin-bottom:14px;"><label style="font-weight:600;font-size:0.9em;display:block;margin-bottom:4px;">Phone</label><input type="text" id="profile-phone" value="'+(e.phone||"")+'" readonly style="width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:8px;font-size:1em;box-sizing:border-box;background:#f0f0f0;color:#888;cursor:not-allowed;"></div><div style="margin-bottom:14px;"><label style="font-weight:600;font-size:0.9em;display:block;margin-bottom:4px;">Date of Birth</label><input type="date" id="profile-dob" value="'+(e.dob||"")+'" style="width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:8px;font-size:1em;box-sizing:border-box;"></div><div style="margin-bottom:14px;"><label style="font-weight:600;font-size:0.9em;display:block;margin-bottom:8px;">Dietary Preferences</label><div style="display:flex;flex-wrap:wrap;gap:10px;">'+r+'</div></div><div style="margin-bottom:14px;"><label style="font-weight:600;font-size:0.9em;display:block;margin-bottom:8px;">Allergen Alerts</label><div style="display:flex;flex-wrap:wrap;gap:10px;">'+i+'</div></div><div style="margin-bottom:14px;"><label style="font-weight:600;font-size:0.9em;display:block;margin-bottom:8px;">Saved Addresses</label><div id="profile-address-list">'+s+'</div><div style="margin-top:10px;padding:12px;border:1px dashed #ccc;border-radius:8px;"><div style="display:flex;gap:8px;margin-bottom:8px;"><input type="text" id="profile-addr-label" placeholder="Label (e.g. Home, Office)" style="flex:1;padding:8px 10px;border:1px solid #ddd;border-radius:6px;font-size:0.9em;"></div><div style="display:flex;gap:8px;"><input type="text" id="profile-addr-address" placeholder="Full address" style="flex:1;padding:8px 10px;border:1px solid #ddd;border-radius:6px;font-size:0.9em;"><button onclick="addAddress()" style="padding:8px 16px;background:var(--accent,#ff9800);color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:600;white-space:nowrap;">Add</button></div></div></div><button onclick="saveProfile()" style="width:100%;padding:12px;background:var(--primary,#d4a259);color:#fff;border:none;border-radius:8px;font-size:1.05em;font-weight:600;cursor:pointer;margin-top:6px;">Save Profile</button>',t.style.display="block",G()}function pe(){var e=document.getElementById("profile-modal");e&&(e.style.display="none"),O()}function Aa(){var e=M();if(e){for(var t=document.getElementById("profile-name").value.trim(),n=document.getElementById("profile-dob").value,a=[],o=document.querySelectorAll(".profile-dietary-cb:checked"),r=0;r<o.length;r++)a.push(o[r].value);for(var i=[],s=document.querySelectorAll(".profile-allergen-cb:checked"),l=0;l<s.length;l++)i.push(s[l].value);if(!t){L("Please enter your name.");return}e.name=t,e.dob=n,e.dietaryPrefs=a,e.allergenAlerts=i,H(e);var c=B();c&&e.phone?c.collection("users").doc(e.phone).update({name:t,dob:n,dietaryPrefs:a,allergenAlerts:i,savedAddresses:e.savedAddresses||[]}).then(function(){L("Profile updated!"),pe(),typeof window.updateSignInUI=="function"&&window.updateSignInUI(e)}).catch(function(u){console.error("Profile save error:",u),L("Profile saved locally. Sync failed."),pe()}):(L("Profile updated!"),pe())}}function Ta(){var e=M();if(e){var t=document.getElementById("profile-addr-label"),n=document.getElementById("profile-addr-address"),a=t.value.trim(),o=n.value.trim();if(!o){L("Please enter an address.");return}e.savedAddresses||(e.savedAddresses=[]),e.savedAddresses.push({label:a||"Address",address:o}),H(e),Ge()}}function Pa(e){var t=M();!t||!t.savedAddresses||(t.savedAddresses.splice(e,1),H(t),Ge())}Object.assign(window,{openProfileModal:Ge,saveProfile:Aa,closeProfileModal:pe,addAddress:Ta,removeAddress:Pa});var W=null,Pe=null,Me=!1;function At(){var e=new URLSearchParams(window.location.search),t=e.get("group");t&&qa(t)}function Na(){var e=M();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal(),typeof window.showAuthToast=="function"&&window.showAuthToast("Please sign in to start group ordering");return}var t=B();if(t){var n={hostPhone:e.phone,hostName:e.name||"Host",participants:[{phone:e.phone,name:e.name||"Host",items:[]}],status:"open",createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+36e5).toISOString()};t.collection("groupCarts").add(n).then(function(a){W=a.id,Me=!0;var o=window.location.origin+window.location.pathname+"?group="+W;Pt(o),Tt(W)}).catch(function(a){console.error("Create group cart error:",a),typeof window.showAuthToast=="function"&&window.showAuthToast("Failed to create group cart")})}}function qa(e){var t=B();t&&t.collection("groupCarts").doc(e).get().then(function(n){if(!n.exists){typeof window.showAuthToast=="function"&&window.showAuthToast("Group cart not found or expired");return}var a=n.data();if(a.status!=="open"){typeof window.showAuthToast=="function"&&window.showAuthToast("This group order has been closed");return}W=e,Me=!1;var o=M();if(o){var r=a.participants.some(function(i){return i.phone===o.phone});r||(a.participants.push({phone:o.phone,name:o.name||"Guest",items:[]}),t.collection("groupCarts").doc(e).update({participants:a.participants}))}typeof window.showAuthToast=="function"&&window.showAuthToast("Joined group order by "+a.hostName),Tt(e),Fa()}).catch(function(n){console.error("Join group cart error:",n)})}function Tt(e){var t=B();t&&(Pe&&Pe(),Pe=t.collection("groupCarts").doc(e).onSnapshot(function(n){if(n.exists){var a=n.data();Da(a)}}))}function Pt(e){var t=document.getElementById("group-modal");t&&t.remove();var n=document.createElement("div");n.id="group-modal",n.className="modal",n.style.display="block",G(),n.innerHTML='<div class="modal-content" style="max-width:420px;padding:1.5rem"><span class="close-modal" onclick="closeGroupModal()">&times;</span><h2 style="color:#D4A017;margin-bottom:1rem">Group Ordering</h2><p style="margin-bottom:0.8rem">Share this link with friends to order together:</p><div style="display:flex;gap:0.5rem;margin-bottom:1rem"><input type="text" id="group-share-url" value="'+e+'" readonly style="flex:1;padding:0.5rem;border-radius:8px;border:1px solid rgba(212,160,23,0.2);background:rgba(0,0,0,0.2);color:#e8d5b5;font-size:0.8rem"><button onclick="copyGroupLink()" style="padding:0.5rem 1rem;background:#D4A017;color:#1a0f08;border:none;border-radius:8px;font-weight:700;cursor:pointer">Copy</button></div><div id="group-participants" style="margin-bottom:1rem"></div><p style="font-size:0.75rem;color:#a09080">Cart expires in 1 hour. Only you (host) can checkout.</p><button onclick="lockGroupCart()" class="cta-button" style="width:100%;margin-top:0.5rem">Lock Cart & Checkout</button></div>',document.body.appendChild(n),n.addEventListener("click",function(a){a.target===n&&Ue()})}function Ue(){var e=document.getElementById("group-modal");e&&(e.style.display="none"),O()}function Oa(){var e=document.getElementById("group-share-url");e&&(e.select(),navigator.clipboard?navigator.clipboard.writeText(e.value):document.execCommand("copy"),typeof window.showAuthToast=="function"&&window.showAuthToast("Link copied!"))}function Da(e){var t=document.getElementById("group-participants");if(t){var n='<h4 style="color:#D4A017;margin-bottom:0.5rem">Participants ('+e.participants.length+")</h4>";e.participants.forEach(function(a){var o=(a.items||[]).length;n+='<div style="display:flex;justify-content:space-between;padding:0.4rem 0;border-bottom:1px solid rgba(255,255,255,0.05)"><span>'+(a.name||a.phone)+(a.phone===e.hostPhone?" (Host)":"")+'</span><span style="color:#D4A017">'+o+" item"+(o!==1?"s":"")+"</span></div>"}),t.innerHTML=n}}function Ra(e,t){if(W){var n=M();if(n){var a=B();a&&a.collection("groupCarts").doc(W).get().then(function(o){if(o.exists){var r=o.data(),i=r.participants.find(function(s){return s.phone===n.phone});i&&(i.items||(i.items=[]),i.items.push({name:e,price:t,qty:1}),a.collection("groupCarts").doc(W).update({participants:r.participants}),typeof window.showAuthToast=="function"&&window.showAuthToast("Added to group cart!"))}})}}}function Ha(){if(!(!W||!Me)){var e=B();e&&e.collection("groupCarts").doc(W).update({status:"locked"}).then(function(){e.collection("groupCarts").doc(W).get().then(function(t){if(t.exists){var n=t.data();n.participants.forEach(function(a){(a.items||[]).forEach(function(o){typeof window.finalizeAddToCart=="function"&&window.finalizeAddToCart(o.name,o.price,1)})}),Ue(),typeof window.showAuthToast=="function"&&window.showAuthToast("Group cart locked! Proceed to checkout.")}})})}}function Fa(){var e=document.getElementById("group-indicator");e&&e.remove();var t=document.createElement("div");t.id="group-indicator",t.style.cssText="position:fixed;bottom:80px;right:20px;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;padding:0.5rem 1rem;border-radius:20px;font-size:0.8rem;font-weight:700;cursor:pointer;z-index:999;box-shadow:0 4px 12px rgba(0,0,0,0.3)",t.textContent="Group Order Active",t.onclick=function(){Me&&Pt(window.location.origin+window.location.pathname+"?group="+W)},document.body.appendChild(t)}Object.assign(window,{createGroupCart:Na,closeGroupModal:Ue,copyGroupLink:Oa,addToGroupCart:Ra,lockGroupCart:Ha,initGroupOrdering:At});function _a(e,t){var n=document.getElementById("split-bill-modal");n&&n.remove();var a=document.createElement("div");a.id="split-bill-modal",a.className="modal",a.style.display="block",G(),a.innerHTML='<div class="modal-content" style="max-width:420px;padding:1.5rem"><span class="close-modal" onclick="closeSplitBill()">&times;</span><h2 style="color:#D4A017;margin-bottom:1rem">Split Bill</h2><p style="margin-bottom:0.5rem">Order Total: <strong style="color:#D4A017">Rs.'+t+'</strong></p><div style="margin-bottom:1rem"><label style="font-size:0.85rem;color:#a09080">Split between how many people?</label><div style="display:flex;gap:0.5rem;margin-top:0.5rem"><button class="split-num-btn" onclick="setSplitCount(2)" style="flex:1;padding:0.5rem;border-radius:8px;border:1px solid rgba(212,160,23,0.2);background:rgba(212,160,23,0.1);color:#D4A017;font-weight:700;cursor:pointer">2</button><button class="split-num-btn" onclick="setSplitCount(3)" style="flex:1;padding:0.5rem;border-radius:8px;border:1px solid rgba(212,160,23,0.2);background:rgba(212,160,23,0.1);color:#D4A017;font-weight:700;cursor:pointer">3</button><button class="split-num-btn" onclick="setSplitCount(4)" style="flex:1;padding:0.5rem;border-radius:8px;border:1px solid rgba(212,160,23,0.2);background:rgba(212,160,23,0.1);color:#D4A017;font-weight:700;cursor:pointer">4</button><input type="number" id="split-custom-count" min="2" max="10" placeholder="Custom" style="width:70px;padding:0.5rem;border-radius:8px;border:1px solid rgba(212,160,23,0.2);background:rgba(0,0,0,0.2);color:#e8d5b5;text-align:center" onchange="setSplitCount(parseInt(this.value))"></div></div><div id="split-result" style="margin-bottom:1rem"></div><div id="split-links" style="margin-bottom:1rem"></div></div>',a.dataset.orderId=e,a.dataset.total=t,document.body.appendChild(a),a.addEventListener("click",function(o){o.target===a&&Nt()})}function Nt(){var e=document.getElementById("split-bill-modal");e&&(e.style.display="none"),O()}function za(e){if(!(!e||e<2||e>10)){var t=document.getElementById("split-bill-modal");if(t){var n=parseInt(t.dataset.total)||0,a=t.dataset.orderId||"",o=Math.ceil(n/e),r=document.getElementById("split-result");r&&(r.innerHTML='<div style="background:rgba(212,160,23,0.08);border:1px solid rgba(212,160,23,0.15);border-radius:12px;padding:1rem;text-align:center"><div style="font-size:0.85rem;color:#a09080;margin-bottom:0.3rem">Each person pays</div><div style="font-size:1.8rem;font-weight:700;color:#D4A017">Rs.'+o+'</div><div style="font-size:0.75rem;color:#a09080">'+e+" people x Rs."+o+" = Rs."+o*e+"</div></div>");var i=document.getElementById("split-links");if(i){for(var s="9121004999@upi",l='<h4 style="color:#D4A017;margin:0.8rem 0 0.5rem;font-size:0.9rem">Share Payment Links</h4>',c=0;c<e;c++){var u=c===0?"You":"Person "+(c+1),v="upi://pay?pa="+s+"&pn=Amogha%20Cafe&am="+o+"&tn=Split%20Bill%20"+a.slice(-6);l+='<div style="display:flex;align-items:center;justify-content:space-between;padding:0.5rem 0;border-bottom:1px solid rgba(255,255,255,0.05)"><span style="font-size:0.85rem">'+u+'</span><a href="'+v+'" style="padding:0.3rem 0.8rem;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;border-radius:8px;font-weight:700;font-size:0.75rem;text-decoration:none">Pay Rs.'+o+"</a></div>"}l+='<button onclick="shareSplitBill('+e+","+o+')" style="width:100%;margin-top:0.8rem;padding:0.5rem;background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;border:none;border-radius:10px;font-weight:700;cursor:pointer;font-size:0.85rem">Share via WhatsApp</button>',i.innerHTML=l}var b=B();b&&a&&b.collection("orders").doc(a).update({splitBill:{count:e,perPerson:o,total:n}}).catch(function(h){console.error("Split bill save error:",h)})}}}function Ga(e,t){var n="Hey! Let's split the bill from Amogha Cafe. Each person pays Rs."+t+" ("+e+" ways). Pay via UPI to 9121004999@upi. Thanks!";navigator.share?navigator.share({text:n}).catch(function(){}):window.open("https://wa.me/?text="+encodeURIComponent(n),"_blank")}Object.assign(window,{openSplitBill:_a,closeSplitBill:Nt,setSplitCount:za,shareSplitBill:Ga});function Ua(){var e=M();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal(),typeof window.showAuthToast=="function"&&window.showAuthToast("Please sign in to view meal plans");return}var t=document.getElementById("subscription-modal");t&&t.remove();var n=document.createElement("div");n.id="subscription-modal",n.className="modal",n.style.display="block",G();var a=B();a&&a.collection("subscriptionPlans").where("active","==",!0).get().then(function(o){var r=[];o.forEach(function(i){var s=i.data();s.id=i.id,r.push(s)}),r.length===0&&(r=Oe()),Je(n,r,e)}).catch(function(){Je(n,Oe(),e)})}function Oe(){return[{id:"lunch-basic",name:"Lunch Basic",description:"5 lunches per week (Mon-Fri)",mealsPerWeek:5,pricePerMonth:2499,regularPrice:3500,items:["Chicken Dum Biryani","Veg Dum Biryani","Dal Tadka + Butter Naan"],active:!0},{id:"lunch-premium",name:"Lunch Premium",description:"5 lunches + 2 dinners per week",mealsPerWeek:7,pricePerMonth:3999,regularPrice:5600,items:["Chicken Dum Biryani","Mutton Dum Biryani","Butter Chicken + Naan","Paneer Butter Masala + Naan"],active:!0},{id:"all-meals",name:"All Meals",description:"7 lunches + 7 dinners per week",mealsPerWeek:14,pricePerMonth:6999,regularPrice:9800,items:["Full menu rotation - Chef's choice daily"],active:!0}]}function Je(e,t,n){var a='<div class="modal-content" style="max-width:500px;padding:1.5rem;max-height:85vh;overflow-y:auto"><span class="close-modal" onclick="closeSubscriptionModal()">&times;</span><h2 style="color:#D4A017;margin-bottom:0.5rem">Meal Plans</h2><p style="color:#a09080;font-size:0.85rem;margin-bottom:1.2rem">Save up to 30% with weekly subscriptions</p>';t.forEach(function(o){var r=o.regularPrice-o.pricePerMonth,i=Math.round(r/o.regularPrice*100);a+='<div style="background:rgba(212,160,23,0.06);border:1px solid rgba(212,160,23,0.15);border-radius:14px;padding:1.2rem;margin-bottom:1rem"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5rem"><h3 style="color:#e8d5b5;margin:0;font-size:1.1rem">'+o.name+'</h3><span style="background:#D4A017;color:#1a0f08;padding:0.15rem 0.5rem;border-radius:8px;font-size:0.7rem;font-weight:700">Save '+i+'%</span></div><p style="color:#a09080;font-size:0.8rem;margin-bottom:0.6rem">'+o.description+'</p><div style="display:flex;align-items:baseline;gap:0.5rem;margin-bottom:0.6rem"><span style="font-size:1.4rem;font-weight:700;color:#D4A017">Rs.'+o.pricePerMonth+'</span><span style="color:#a09080;font-size:0.8rem;text-decoration:line-through">Rs.'+o.regularPrice+'</span><span style="color:#a09080;font-size:0.75rem">/month</span></div><div style="margin-bottom:0.8rem"><div style="font-size:0.75rem;color:#a09080;margin-bottom:0.3rem">Includes:</div>'+o.items.map(function(s){return'<span style="display:inline-block;font-size:0.7rem;padding:0.15rem 0.4rem;border-radius:6px;background:rgba(255,255,255,0.05);color:#e8d5b5;margin:0.1rem">'+s+"</span>"}).join(" ")+"</div><button onclick=\"subscribeToPlan('"+o.id+'\')" style="width:100%;padding:0.55rem;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;border:none;border-radius:10px;font-weight:700;cursor:pointer;font-size:0.85rem">Subscribe Now</button></div>'}),n.activeSubscription&&(a+='<div style="background:rgba(76,175,80,0.08);border:1px solid rgba(76,175,80,0.2);border-radius:14px;padding:1rem;margin-bottom:1rem"><h4 style="color:#4CAF50;margin:0 0 0.3rem">Your Active Plan</h4><p style="color:#e8d5b5;font-size:0.85rem">'+n.activeSubscription.planName+'</p><p style="color:#a09080;font-size:0.75rem">Next delivery: '+(n.activeSubscription.nextDeliveryDate||"Tomorrow")+'</p><button onclick="cancelSubscription()" style="margin-top:0.5rem;padding:0.4rem 1rem;background:rgba(244,67,54,0.1);color:#f44336;border:1px solid rgba(244,67,54,0.2);border-radius:8px;font-size:0.75rem;cursor:pointer">Cancel Plan</button></div>'),a+="</div>",e.innerHTML=a,document.body.appendChild(e),e.addEventListener("click",function(o){o.target===e&&Ae()})}function Ae(){var e=document.getElementById("subscription-modal");e&&(e.style.display="none"),O()}function Wa(e){var t=M();if(t){var n=Oe(),a=n.find(function(i){return i.id===e});if(a){var o={planId:e,planName:a.name,userPhone:t.phone,userName:t.name,status:"active",pricePerMonth:a.pricePerMonth,mealsPerWeek:a.mealsPerWeek,startDate:new Date().toISOString(),nextDeliveryDate:Ya(),createdAt:new Date().toISOString()},r=B();r&&r.collection("subscriptions").add(o).then(function(i){t.activeSubscription={id:i.id,planId:e,planName:a.name,nextDeliveryDate:o.nextDeliveryDate},H(t),r.collection("users").doc(t.phone).update({activeSubscription:t.activeSubscription}).catch(function(){}),Ae(),typeof window.showAuthToast=="function"&&window.showAuthToast("Subscribed to "+a.name+"! Your first delivery is on the way.")}).catch(function(i){console.error("Subscribe error:",i),typeof window.showAuthToast=="function"&&window.showAuthToast("Failed to subscribe. Please try again.")})}}}function Va(){var e=M();if(!(!e||!e.activeSubscription)&&confirm("Are you sure you want to cancel your meal plan?")){var t=B();t&&e.activeSubscription.id&&t.collection("subscriptions").doc(e.activeSubscription.id).update({status:"cancelled",cancelledAt:new Date().toISOString()}).catch(function(){}),delete e.activeSubscription,H(e),t&&t.collection("users").doc(e.phone).update({activeSubscription:null}).catch(function(){}),Ae(),typeof window.showAuthToast=="function"&&window.showAuthToast("Meal plan cancelled.")}}function Ya(){var e=new Date;for(e.setDate(e.getDate()+1);e.getDay()===0;)e.setDate(e.getDate()+1);return e.toISOString().split("T")[0]}function ja(){}Object.assign(window,{openSubscriptionModal:Ua,closeSubscriptionModal:Ae,subscribeToPlan:Wa,cancelSubscription:Va,initSubscriptions:ja});Wn();Gn();_n();zn();Qt();tn();en();dn();xe();pn();Rn();Wt();$n();Kn();ya();Et();xt();Ct();setTimeout(function(){var e=null;try{e=JSON.parse(localStorage.getItem("amoghaUser"))}catch(t){}e&&ba()},2e3);kt();At();Re();window.displayCart=function(){he(),_e()};window.loadMenuRatings=Pn;export{$a as __vite_legacy_guard};
//# sourceMappingURL=script.js.map
