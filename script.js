function Vn(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}function W(e){try{return localStorage.getItem(e)}catch(t){return null}}function z(e,t){try{localStorage.setItem(e,t)}catch(n){}}function ut(e,t){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(function(){t&&(t.textContent="Copied!")}).catch(function(){Le(e,t)}):Le(e,t)}function Le(e,t){var n=document.createElement("textarea");n.value=e,n.style.cssText="position:fixed;opacity:0",document.body.appendChild(n),n.select();try{document.execCommand("copy"),t&&(t.textContent="Copied!")}catch(a){}document.body.removeChild(n)}var Ie=0;function X(){Ie=window.pageYOffset||document.documentElement.scrollTop,document.body.style.top=-Ie+"px",document.body.classList.add("modal-open")}function P(){document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo(0,Ie)}Object.assign(window,{safeGetItem:W,safeCopy:ut,fallbackCopy:Le,unlockScroll:P});const mt="rzp_test_1DP5mmOlF5G5ag",ft="+919121004999",vt="AMOGHA CAFE & RESTAURANT",se=500,ce=49;var $=[{name:"Bronze",min:0,color:"#cd7f32",icon:"ü•â"},{name:"Silver",min:500,color:"#c0c0c0",icon:"ü•à"},{name:"Gold",min:1e3,color:"#D4A017",icon:"ü•á"}],Ne=[{days:[1,2,3,4,5],startHour:14,endHour:17,discount:15,label:"Happy Hour ‚Äî 15% OFF!",categories:["beverages"]},{days:[0,1,2,3,4,5,6],startHour:22,endHour:23,discount:20,label:"Late Night Deal ‚Äî 20% OFF!",categories:["all"]}],pe={Raita:40,"Mirchi ka Salan":50,"Veg Manchurian":169,"Paneer 65":189,"Chicken 65":200,"Chicken Hot Wings":220,"Veg Spring Rolls":149,"Chicken Lollipop":230,"Paneer Butter Masala":199,"Dal Tadka":149,"Butter Chicken":249,"Chicken Curry":219,"Mutton Curry":319,"Gongura Chicken":239,"Veg Dum Biryani":199,"Chicken Dum Biryani":249,"Chicken 65 Biryani":249,"Mutton Dum Biryani":349,"Egg Biryani":199,"Paneer Biryani":229,"Paneer Tikka":209,"Chicken Seekh Kebab":229,"Tandoori Chicken":269,"Mutton Seekh Kebab":289,"Veg Hakka Noodles":169,"Chicken Hakka Noodles":199,"Egg Noodles":179,"Schezwan Noodles":189,"Veg Fried Rice":169,"Chicken Fried Rice":199,"Egg Fried Rice":179,"Schezwan Fried Rice":189,"Butter Naan":40,"Garlic Naan":50,"Tandoori Roti":30,"Butter Roti":35,"Laccha Paratha":45,Tea:30,Coffee:40,"Hot Chocolate":60,Lassi:50,Buttermilk:35,"Fresh Lime Soda":45},Ae={en:{home:"Home",about:"About",menu:"Menu",specials:"Specials",gallery:"Gallery",reviews:"Reviews",contact:"Contact",signIn:"Sign In",orderNow:"Order Online",reserveTable:"Reserve Table",addToOrder:"Add to Order",yourOrder:"Your Order",clearCart:"Clear Cart",checkout:"Proceed to Checkout",orderSummary:"Order Summary",yourDetails:"Your Details",payment:"Payment",orderPlaced:"Order Placed!",thankYou:"Thank you! Your order has been received.",fullName:"Full Name",phoneNumber:"Phone Number",deliveryAddress:"Delivery Address",specialInstructions:"Special Instructions (Optional)",ourStory:"Our Story",whyChooseUs:"Why Choose Us?",ourMission:"Our Mission",search:"Search menu...",all:"All",veg:"Veg",nonVeg:"Non-Veg"},hi:{home:"‡§π‡•ã‡§Æ",about:"‡§π‡§Æ‡§æ‡§∞‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç",menu:"‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç",specials:"‡§∏‡•ç‡§™‡•á‡§∂‡§≤",gallery:"‡§ó‡•à‡§≤‡§∞‡•Ä",reviews:"‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ",contact:"‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï",signIn:"‡§∏‡§æ‡§á‡§® ‡§á‡§®",orderNow:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡§∞‡•á‡§Ç",reserveTable:"‡§ü‡•á‡§¨‡§≤ ‡§¨‡•Å‡§ï ‡§ï‡§∞‡•á‡§Ç",addToOrder:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç",yourOrder:"‡§Ü‡§™‡§ï‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞",clearCart:"‡§ï‡§æ‡§∞‡•ç‡§ü ‡§ñ‡§æ‡§≤‡•Ä ‡§ï‡§∞‡•á‡§Ç",checkout:"‡§ö‡•á‡§ï‡§Ü‡§â‡§ü ‡§ï‡§∞‡•á‡§Ç",orderSummary:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂",yourDetails:"‡§Ü‡§™‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",payment:"‡§≠‡•Å‡§ó‡§§‡§æ‡§®",orderPlaced:"‡§ë‡§∞‡•ç‡§°‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ!",thankYou:"‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! ‡§Ü‡§™‡§ï‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§Æ‡§ø‡§≤ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§",fullName:"‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ",phoneNumber:"‡§´‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞",deliveryAddress:"‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§™‡§§‡§æ",specialInstructions:"‡§µ‡§ø‡§∂‡•á‡§∑ ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",ourStory:"‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ï‡§π‡§æ‡§®‡•Ä",whyChooseUs:"‡§π‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§ö‡•Å‡§®‡•á‡§Ç?",ourMission:"‡§π‡§Æ‡§æ‡§∞‡§æ ‡§Æ‡§ø‡§∂‡§®",search:"‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç ‡§ñ‡•ã‡§ú‡•á‡§Ç...",all:"‡§∏‡§≠‡•Ä",veg:"‡§∂‡§æ‡§ï‡§æ‡§π‡§æ‡§∞‡•Ä",nonVeg:"‡§Æ‡§æ‡§Ç‡§∏‡§æ‡§π‡§æ‡§∞‡•Ä"},te:{home:"‡∞π‡±ã‡∞Æ‡±ç",about:"‡∞Æ‡∞æ ‡∞ó‡±Å‡∞∞‡∞ø‡∞Ç‡∞ö‡∞ø",menu:"‡∞Æ‡±Ü‡∞®‡±Ç",specials:"‡∞∏‡±ç‡∞™‡±Ü‡∞∑‡∞≤‡±ç",gallery:"‡∞ó‡±ç‡∞Ø‡∞æ‡∞≤‡∞∞‡±Ä",reviews:"‡∞∏‡∞Æ‡±Ä‡∞ï‡±ç‡∞∑‡∞≤‡±Å",contact:"‡∞∏‡∞Ç‡∞™‡±ç‡∞∞‡∞¶‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø",signIn:"‡∞∏‡±à‡∞®‡±ç ‡∞á‡∞®‡±ç",orderNow:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",reserveTable:"‡∞ü‡±á‡∞¨‡±Å‡∞≤‡±ç ‡∞¨‡±Å‡∞ï‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",addToOrder:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç‚Äå‡∞≤‡±ã ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø",yourOrder:"‡∞Æ‡±Ä ‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç",clearCart:"‡∞ï‡∞æ‡∞∞‡±ç‡∞ü‡±ç ‡∞ñ‡∞æ‡∞≥‡±Ä ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø",checkout:"‡∞ö‡±Ü‡∞ï‡±ç ‡∞Ö‡∞µ‡±Å‡∞ü‡±ç",orderSummary:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞∏‡∞æ‡∞∞‡∞æ‡∞Ç‡∞∂‡∞Ç",yourDetails:"‡∞Æ‡±Ä ‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å",payment:"‡∞ö‡±Ü‡∞≤‡±ç‡∞≤‡∞ø‡∞Ç‡∞™‡±Å",orderPlaced:"‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞Ø‡∞ø‡∞Ç‡∞¶‡∞ø!",thankYou:"‡∞ß‡∞®‡±ç‡∞Ø‡∞µ‡∞æ‡∞¶‡∞æ‡∞≤‡±Å! ‡∞Æ‡±Ä ‡∞Ü‡∞∞‡±ç‡∞°‡∞∞‡±ç ‡∞Ö‡∞Ç‡∞¶‡∞ø‡∞Ç‡∞¶‡∞ø.",fullName:"‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞ø ‡∞™‡±á‡∞∞‡±Å",phoneNumber:"‡∞´‡±ã‡∞®‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç",deliveryAddress:"‡∞°‡±Ü‡∞≤‡∞ø‡∞µ‡∞∞‡±Ä ‡∞ö‡∞ø‡∞∞‡±Å‡∞®‡∞æ‡∞Æ‡∞æ",specialInstructions:"‡∞™‡±ç‡∞∞‡∞§‡±ç‡∞Ø‡±á‡∞ï ‡∞∏‡±Ç‡∞ö‡∞®‡∞≤‡±Å (‡∞ê‡∞ö‡±ç‡∞õ‡∞ø‡∞ï‡∞Ç)",ourStory:"‡∞Æ‡∞æ ‡∞ï‡∞•",whyChooseUs:"‡∞Æ‡∞Æ‡±ç‡∞Æ‡∞≤‡±ç‡∞®‡∞ø ‡∞é‡∞Ç‡∞¶‡±Å‡∞ï‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞µ‡∞æ‡∞≤‡∞ø?",ourMission:"‡∞Æ‡∞æ ‡∞≤‡∞ï‡±ç‡∞∑‡±ç‡∞Ø‡∞Ç",search:"‡∞Æ‡±Ü‡∞®‡±Ç ‡∞µ‡±Ü‡∞§‡∞ï‡∞Ç‡∞°‡∞ø...",all:"‡∞Ö‡∞®‡±ç‡∞®‡±Ä",veg:"‡∞∂‡∞æ‡∞ï‡∞æ‡∞π‡∞æ‡∞∞‡∞Ç",nonVeg:"‡∞Æ‡∞æ‡∞Ç‡∞∏‡∞æ‡∞π‡∞æ‡∞∞‡∞Ç"}},pt={"Chicken Dum Biryani":["Raita","Mirchi ka Salan","Buttermilk"],"Chicken 65 Biryani":["Raita","Mirchi ka Salan","Fresh Lime Soda"],"Veg Dum Biryani":["Raita","Dal Tadka","Lassi"],"Mutton Dum Biryani":["Raita","Mirchi ka Salan","Buttermilk"],"Egg Biryani":["Raita","Buttermilk"],"Paneer Biryani":["Raita","Dal Tadka"],"Butter Chicken":["Butter Naan","Garlic Naan","Laccha Paratha"],"Paneer Butter Masala":["Butter Naan","Garlic Naan","Tandoori Roti"],"Chicken Curry":["Butter Naan","Butter Roti","Veg Fried Rice"],"Mutton Curry":["Butter Naan","Laccha Paratha"],"Gongura Chicken":["Butter Naan","Tandoori Roti"],"Dal Tadka":["Butter Naan","Tandoori Roti","Veg Fried Rice"],"Chicken 65":["Chicken Dum Biryani","Fresh Lime Soda"],"Paneer 65":["Veg Dum Biryani","Lassi"],"Veg Manchurian":["Veg Hakka Noodles","Veg Fried Rice"],"Chicken Hot Wings":["Fresh Lime Soda","Chicken Hakka Noodles"],"Chicken Lollipop":["Chicken Dum Biryani","Fresh Lime Soda"],"Veg Hakka Noodles":["Veg Manchurian","Veg Spring Rolls"],"Chicken Hakka Noodles":["Chicken 65","Fresh Lime Soda"]};function T(){return window.db}function N(){try{const e=W("amoghaUser");return e?JSON.parse(e):null}catch(e){return null}}function Z(e){z("amoghaUser",JSON.stringify(e));var t=T();e&&e.phone&&typeof t<"u"&&t&&!window._notifListenerActive&&(window._notifListenerActive=!0,t.collection("notifications").where("userPhone","==",e.phone).where("read","==",!1).onSnapshot(function(n){n.docChanges().forEach(function(a){if(a.type==="added"){var o=a.doc.data();typeof sendPushNotification=="function"&&sendPushNotification(o.title,o.body),a.doc.ref.update({read:!0})}})},function(n){console.error("Notification listener error:",n)}))}function yt(){const e=N();if(e){confirm("Signed in as "+(e.name||"Guest")+"\n\nDo you want to sign out?")&&De();return}document.getElementById("auth-modal").style.display="block",X(),Re("signup")}function Q(){document.getElementById("auth-modal").style.display="none",P(),document.getElementById("signup-name").value="",document.getElementById("signup-phone").value="",document.getElementById("signup-password").value="",document.getElementById("signin-phone").value="",document.getElementById("signin-password").value="",document.getElementById("signup-msg").textContent="",document.getElementById("signup-msg").className="auth-msg",document.getElementById("signin-msg").textContent="",document.getElementById("signin-msg").className="auth-msg",document.getElementById("forgot-phone").value="",document.getElementById("forgot-name").value="",document.getElementById("forgot-new-password").value="",document.getElementById("forgot-confirm-password").value="",document.getElementById("forgot-msg").textContent="",document.getElementById("forgot-msg").className="auth-msg",document.getElementById("forgot-step-1").style.display="",document.getElementById("forgot-step-2").style.display="none",ye=null}function Re(e){document.querySelectorAll(".auth-view").forEach(t=>t.classList.remove("active")),document.getElementById("auth-"+e).classList.add("active")}function gt(){var e=document.getElementById("signup-name").value.trim(),t=document.getElementById("signup-phone").value.trim(),n=document.getElementById("signup-password").value,a=document.getElementById("signup-msg");if(!e){a.textContent="Please enter your name.",a.className="auth-msg error";return}if(!/^\d{10}$/.test(t)){a.textContent="Please enter a valid 10-digit phone number.",a.className="auth-msg error";return}if(!/^\d{4}$/.test(n)){a.textContent="Please enter a 4-digit PIN.",a.className="auth-msg error";return}a.textContent="Creating account...",a.className="auth-msg";var o=T();if(typeof o>"u"||!o){a.textContent="Service unavailable. Please refresh and try again.",a.className="auth-msg error";return}o.collection("users").doc(t).get().then(function(r){if(r.exists){a.textContent="This phone number is already registered. Please sign in.",a.className="auth-msg error";return}var i={name:e,phone:t,pin:n,usedWelcomeBonus:!1,createdAt:new Date().toISOString()};return o.collection("users").doc(t).set(i).then(function(){try{Z(i),he(i),ue(),Q(),k("Welcome, "+(e||"Guest")+"! 25% off applied to your first order!");var s=document.getElementById("signup-referral"),l=s?s.value.trim():"";l&&setTimeout(function(){typeof applyReferralAtSignup=="function"&&applyReferralAtSignup(l)},2e3)}catch(c){console.error("SignUp UI error:",c),Q(),k("Account created successfully!")}})}).catch(function(r){console.error("SignUp error:",r);var i=r.code==="permission-denied"?"Access denied. Please contact support.":"Connection error. Please check your internet and try again.";a.textContent=i+" ("+(r.code||r.message||"unknown")+")",a.className="auth-msg error"})}function ht(){var e=document.getElementById("signin-phone").value.trim(),t=document.getElementById("signin-password").value,n=document.getElementById("signin-msg");if(!/^\d{10}$/.test(e)){n.textContent="Please enter a valid 10-digit phone number.",n.className="auth-msg error";return}if(!/^\d{4}$/.test(t)){n.textContent="Please enter your 4-digit PIN.",n.className="auth-msg error";return}n.textContent="Signing in...",n.className="auth-msg";var a=T();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(e).get().then(function(o){if(!o.exists){n.textContent="No account found with this number. Please sign up.",n.className="auth-msg error";return}var r=o.data();if((r.pin||r.password)!==t){n.textContent="Incorrect PIN. Please try again.",n.className="auth-msg error";return}try{Z(r),he(r),ue(),Q();var i=r.name||"Guest",s=r.usedWelcomeBonus?"":" Your 25% welcome bonus is still active!";k("Welcome back, "+i+"!"+s)}catch(l){console.error("SignIn UI error:",l),Q(),k("Signed in successfully!")}}).catch(function(o){console.error("SignIn error:",o),n.textContent="Connection error. Please check your internet and try again.",n.className="auth-msg error"})}var ye=null;function bt(){var e=document.getElementById("forgot-phone").value.trim(),t=document.getElementById("forgot-name").value.trim(),n=document.getElementById("forgot-msg");if(!/^\d{10}$/.test(e)){n.textContent="Please enter a valid 10-digit phone number.",n.className="auth-msg error";return}if(!t){n.textContent="Please enter your registered name.",n.className="auth-msg error";return}n.textContent="Verifying...",n.className="auth-msg";var a=T();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(e).get().then(function(o){if(!o.exists){n.textContent="No account found with this phone number.",n.className="auth-msg error";return}var r=o.data();if(r.name.toLowerCase()!==t.toLowerCase()){n.textContent="Name does not match our records.",n.className="auth-msg error";return}ye=e,n.textContent="",n.className="auth-msg",document.getElementById("forgot-step-1").style.display="none",document.getElementById("forgot-step-2").style.display="block"}).catch(function(o){console.error("Forgot password error:",o),n.textContent=o.code==="permission-denied"?"Access denied. Please contact support.":"Network error. Please check your connection and try again.",n.className="auth-msg error"})}function wt(){var e=document.getElementById("forgot-new-password").value,t=document.getElementById("forgot-confirm-password").value,n=document.getElementById("forgot-msg");if(!/^\d{4}$/.test(e)){n.textContent="Please enter a 4-digit PIN.",n.className="auth-msg error";return}if(e!==t){n.textContent="PINs do not match.",n.className="auth-msg error";return}n.textContent="Resetting PIN...",n.className="auth-msg";var a=T();if(typeof a>"u"||!a){n.textContent="Service unavailable. Please refresh and try again.",n.className="auth-msg error";return}a.collection("users").doc(ye).update({pin:e}).then(function(){ye=null,n.textContent="",n.className="auth-msg",Q(),k("PIN reset successful! Please sign in.")}).catch(function(){n.textContent="Something went wrong. Please try again.",n.className="auth-msg error"})}function De(){try{localStorage.removeItem("amoghaUser")}catch(t){}const e=document.getElementById("signin-btn");e.className="signin-nav-btn",e.innerHTML='<svg class="signin-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg><span id="signin-text">Sign In</span>',ue(),typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget(),k("You have been signed out.")}function he(e){const t=document.getElementById("signin-btn");if(!(!t||!e)){var n=e.name||"Guest",a=n.split(" ").filter(function(o){return o.length>0}).map(function(o){return o[0]}).join("").toUpperCase().slice(0,2)||"G";t.className="signin-nav-btn signed-in",t.innerHTML='<span class="user-avatar">'+a+'</span><span id="signin-text">'+n.split(" ")[0]+"</span>",typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget()}}function Et(e,t){var n=document.getElementById(e),a=t.querySelector(".eye-open"),o=t.querySelector(".eye-closed");n.type==="password"?(n.type="text",a.style.display="none",o.style.display=""):(n.type="password",a.style.display="",o.style.display="none")}function k(e){var t=document.getElementById("auth-toast");t||(t=document.createElement("div"),t.id="auth-toast",document.body.appendChild(t)),t.textContent=e,t.classList.remove("visible"),t.offsetWidth,t.classList.add("visible"),setTimeout(function(){t.classList.remove("visible")},4e3)}function ue(){var e=document.getElementById("carousel-greeting");if(e){var t=N();t&&t.name?e.textContent="Hey "+t.name.split(" ")[0]+", ":e.textContent=""}}function Ct(){try{const e=W("amoghaUser");e&&he(JSON.parse(e)),ue()}catch(e){console.error("Auth restore error:",e)}window.addEventListener("click",function(e){var t=document.getElementById("auth-modal");e.target===t&&Q()}),setTimeout(function(){var e=document.getElementById("signup-form");if(!(!e||e.dataset.refEnhanced==="true")){e.dataset.refEnhanced="true";var t=e.querySelector(".password-field");if(t){var n=document.createElement("input");n.type="text",n.id="signup-referral",n.placeholder="Referral Code (Optional)",n.maxLength=20,n.style.textTransform="uppercase",t.after(n)}}},1e3),setTimeout(function(){var e=document.getElementById("signin-btn");if(e){var t=document.createElement("div");t.id="user-dropdown",t.className="user-dropdown",t.innerHTML='<button onclick="openMyOrders(); closeUserDropdown();">My Orders</button><button onclick="openReferralModal(); closeUserDropdown();">Refer a Friend</button><button onclick="openLoyaltyModal(); closeUserDropdown();">Loyalty Points</button><button onclick="openAuthModal(); closeUserDropdown();">Sign Out</button>',e.parentElement.style.position="relative",e.parentElement.appendChild(t),e.addEventListener("click",function(n){var a=N();a&&(n.preventDefault(),n.stopPropagation(),t.classList.toggle("visible"))}),document.addEventListener("click",function(n){e.parentElement.contains(n.target)||t.classList.remove("visible")})}},1e3)}function Lt(){var e=document.getElementById("user-dropdown");e&&e.classList.remove("visible")}Object.assign(window,{openAuthModal:yt,closeAuthModal:Q,switchAuthView:Re,handleSignUp:gt,handleSignIn:ht,handleForgotPassword:bt,handleResetPassword:wt,signOut:De,updateSignInUI:he,togglePassword:Et,showAuthToast:k,updateCarouselGreeting:ue,closeUserDropdown:Lt});let I=[];var ae=[];function It(){try{var e=localStorage.getItem("addons_cache");if(e){var t=JSON.parse(e);if(t.ts&&Date.now()-t.ts<6e5&&t.data){ae.push(...t.data);return}}}catch(a){}var n=T();n&&n.collection("addons").where("active","==",!0).orderBy("sortOrder").get().then(function(a){a.forEach(function(o){ae.push(o.data())});try{localStorage.setItem("addons_cache",JSON.stringify({ts:Date.now(),data:ae}))}catch(o){}}).catch(function(){})}var U=null,J=[];function St(){try{const t=W("amoghaCart");if(t){var e=JSON.parse(t);I.length=0,e.forEach(function(n){I.push(n)}),K()}}catch(t){I.length=0}}function ee(){z("amoghaCart",JSON.stringify(I))}function K(){const e=I.reduce((n,a)=>n+a.quantity,0);var t=document.getElementById("cart-count");t&&(t.textContent=e)}function ie(e,t,n){I.length===0&&!N()&&Nt();var a="medium";if(n){var o=n.closest(".menu-item-card");if(o){var r=o.querySelector(".spice-level.active");r&&(a=r.textContent.trim().toLowerCase())}}if(ae.length>0){U={name:e,price:parseFloat(t),spiceLevel:a,btnEl:n},J.length=0,xt(e,parseFloat(t));return}be(e,parseFloat(t),a,[],n)}function Bt(e){var t=document.getElementById("cart-icon");if(!(!e||!t)){var n=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=document.createElement("div");o.className="cart-fly-item",o.style.left=n.left+n.width/2-6+"px",o.style.top=n.top+n.height/2-6+"px",document.body.appendChild(o),requestAnimationFrame(function(){o.style.transition="left 0.55s cubic-bezier(0.4,0,0.2,1), top 0.55s cubic-bezier(0.4,0,0.2,1), opacity 0.55s, transform 0.55s",o.style.left=a.left+a.width/2-6+"px",o.style.top=a.top+a.height/2-6+"px",o.style.opacity="0",o.style.transform="scale(0.3)"}),setTimeout(function(){o.remove()},600),t.classList.remove("cart-jiggle"),t.offsetWidth,t.classList.add("cart-jiggle"),setTimeout(function(){t.classList.remove("cart-jiggle")},400)}}function be(e,t,n,a,o){var r=a.map(function(s){return s.name}).sort().join(","),i=I.find(function(s){var l=(s.addons||[]).map(function(c){return c.name}).sort().join(",");return s.name===e&&s.spiceLevel===n&&l===r});i?i.quantity++:I.push({name:e,price:t,quantity:1,spiceLevel:n,addons:a||[]}),o&&(o.classList.remove("cart-adding"),o.offsetWidth,o.classList.add("cart-adding"),Bt(o)),K(),ee(),te(e),ne(),Se();try{window.analytics&&window.analytics.logEvent("add_to_cart",{item_name:e,value:t})}catch(s){}}function xt(e,t){var n=document.getElementById("addon-picker-overlay"),a=document.getElementById("addon-item-name"),o=document.getElementById("addon-sheet-list");a.textContent=e+" ‚Äî ‚Çπ"+t,o.innerHTML=ae.map(function(r,i){return'<div class="addon-option" data-idx="'+i+'" onclick="toggleAddonOption(this, '+i+')"><div class="addon-checkbox"></div><div class="addon-option-info"><div class="addon-option-name">'+r.name+'</div><div class="addon-option-cat">'+(r.category||"")+'</div></div><div class="addon-option-price">+‚Çπ'+r.price+"</div></div>"}).join(""),He(),n.style.display="flex"}function kt(e,t){e.classList.toggle("selected");var n=ae[t],a=e.querySelector(".addon-checkbox");if(e.classList.contains("selected"))J.push({name:n.name,price:n.price}),a.textContent="‚úì";else{var o=J.findIndex(function(r){return r.name===n.name});o!==-1&&J.splice(o,1),a.textContent=""}He()}function He(){if(U){var e=J.reduce(function(n,a){return n+a.price},0),t=U.price+e;document.getElementById("addon-total").textContent="Total: ‚Çπ"+t}}function Mt(){document.getElementById("addon-picker-overlay").style.display="none",U&&(be(U.name,U.price,U.spiceLevel,[]),U=null,J.length=0)}function Tt(){if(U){var e=U,t=J.slice();U=null,J.length=0,document.getElementById("addon-picker-overlay").style.display="none",be(e.name,e.price,e.spiceLevel,t)}}function qt(e){var t=e.closest(".add-to-cart")||e,n=document.createElement("span");n.className="atc-checkmark",n.textContent="‚úì",t.appendChild(n),setTimeout(function(){n.remove()},800)}function Nt(){var e=document.getElementById("signin-prompt");e||(e=document.createElement("div"),e.id="signin-prompt",e.innerHTML='<div class="signin-prompt-content"><span class="signin-prompt-icon">üéâ</span><div class="signin-prompt-text"><strong>Sign up & get 25% OFF!</strong><span>Create an account to unlock your welcome bonus</span></div><button class="signin-prompt-btn" onclick="closeSignInPrompt(); openAuthModal();">Sign Up</button><button class="signin-prompt-close" onclick="closeSignInPrompt()">&times;</button></div>',document.body.appendChild(e)),e.classList.remove("visible"),e.offsetWidth,e.classList.add("visible"),setTimeout(function(){Fe()},8e3)}function Fe(){var e=document.getElementById("signin-prompt");e&&e.classList.remove("visible")}function te(e){document.querySelectorAll(".add-to-cart").forEach(t=>{if(t.dataset.item===e){const n=I.find(o=>o.name===e),a=n?n.quantity:0;a>0&&!t.classList.contains("has-qty")?(t.classList.add("has-qty"),t.innerHTML='<span class="qty-minus" data-item="'.concat(e,'">‚àí</span><span class="qty-count">').concat(a,'</span><span class="qty-plus" data-item="').concat(e,'">+</span>')):a>0?t.querySelector(".qty-count").textContent=a:(t.classList.remove("has-qty"),t.innerHTML="Add to Order")}})}function At(){I.forEach(e=>te(e.name))}function ne(){let e=document.getElementById("floating-cart");e||(e=document.createElement("div"),e.id="floating-cart",e.innerHTML='\n            <div class="fc-header">\n                <span class="fc-title">Your Order</span>\n                <span class="fc-close" onclick="closeFloatingCart()">&times;</span>\n            </div>\n            <div class="fc-items"></div>\n            <div class="fc-footer">\n                <span class="fc-total"></span>\n                <button class="fc-checkout" onclick="document.getElementById(\'cart-icon\').click(); closeFloatingCart();">View Cart</button>\n            </div>\n        ',document.body.appendChild(e));const t=e.querySelector(".fc-items"),n=e.querySelector(".fc-total");if(I.length===0){e.classList.remove("visible"),ge();return}let a="",o=0;I.forEach(r=>{const i=r.price*r.quantity;o+=i,a+='<div class="fc-item"><span>'.concat(r.name," x").concat(r.quantity,"</span><span>‚Çπ").concat(i,"</span></div>")}),t.innerHTML=a,n.textContent="Total: ‚Çπ".concat(o),e.classList.add("visible"),ge()}function Se(){var e=document.getElementById("floating-cart-bar");if(e){var t=I.reduce(function(i,s){return i+s.quantity},0),n=I.reduce(function(i,s){return i+s.price*s.quantity},0);if(t===0){e.classList.remove("visible");return}var a=e.querySelector(".floating-cart-count"),o=e.querySelector(".floating-cart-total"),r=e.querySelector(".floating-cart-label");a&&(a.textContent=t),o&&(o.textContent="‚Çπ"+n),r&&(r.textContent=t===1?"1 item":t+" items"),e.classList.add("visible")}}function ge(e){var t=document.getElementById("cart-fab");t||(t=document.createElement("div"),t.id="cart-fab",t.className="cart-fab",t.innerHTML='<svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg><span class="cart-fab-badge">0</span>',t.addEventListener("click",function(){var o=document.getElementById("cart-icon");o&&o.click()}),document.body.appendChild(t));var n=t.querySelector(".cart-fab-badge"),a=I.reduce(function(o,r){return o+r.quantity},0);a>0?(n.textContent=a,t.classList.add("visible"),t.classList.remove("pop"),t.offsetWidth,t.classList.add("pop")):t.classList.remove("visible")}function Pt(){const e=document.getElementById("floating-cart");e&&e.classList.remove("visible")}function me(){const e=document.getElementById("cart-items");if(!e)return;if(I.length===0){e.innerHTML='<div class="empty-cart">Your cart is empty</div>';var t=document.getElementById("subtotal-amount"),n=document.getElementById("total-amount");t&&(t.textContent="0.00"),n&&(n.textContent="0.00");return}let a="",o=0;I.forEach((c,f)=>{const g=(c.addons||[]).reduce((C,B)=>C+B.price,0),b=(c.price+g)*c.quantity;o+=b;const h=c.spiceLevel&&c.spiceLevel!=="medium"?' <span style="font-size:0.7rem;color:#e67e22">('+c.spiceLevel+")</span>":"",L=(c.addons||[]).map(C=>'<span style="font-size:0.7rem;color:var(--gold,#D4A017)">+ '+C.name+" ‚Çπ"+C.price+"</span>").join(" ");a+='\n            <div class="cart-item">\n                <div class="cart-item-info">\n                    <div class="cart-item-name">'.concat(c.name).concat(h,"</div>\n                    ").concat(L?'<div style="margin-top:2px">'+L+"</div>":"",'\n                    <div class="cart-item-price">‚Çπ').concat((c.price+g).toFixed(2),'</div>\n                </div>\n                <div class="cart-item-quantity">\n                    <button class="qty-btn" onclick="updateQuantity(').concat(f,', -1)">-</button>\n                    <span>').concat(c.quantity,'</span>\n                    <button class="qty-btn" onclick="updateQuantity(').concat(f,', 1)">+</button>\n                </div>\n                <button class="remove-item" onclick="removeItem(').concat(f,')">Remove</button>\n            </div>\n        ')}),e.innerHTML=a;const r=o>=se?0:ce,i=o+r;var s=document.getElementById("subtotal-amount"),l=document.getElementById("total-amount");s&&(s.textContent=o.toFixed(2)),l&&(l.textContent=i.toFixed(2))}function Ot(e,t){const n=I[e].name;I[e].quantity+=t,I[e].quantity<=0&&I.splice(e,1),K(),ee(),me(),te(n),ne()}function Rt(e){const t=I[e].name;I.splice(e,1),K(),ee(),me(),te(t),ne()}function _e(){if(confirm("Are you sure you want to clear your cart?")){const e=I.map(t=>t.name);I.length=0,K(),ee(),me(),e.forEach(t=>te(t)),ne(),document.getElementById("cart-modal").style.display="none",P()}}function Dt(){var e=document.getElementById("cart-icon"),t=document.getElementById("cart-modal");e&&e.addEventListener("click",r=>{r.preventDefault(),me(),t&&(t.style.display="block"),X()});var n=document.querySelectorAll(".close");n.forEach(r=>{r.addEventListener("click",()=>{if(!r.closest("#auth-modal")){t&&(t.style.display="none");var i=document.getElementById("reservation-modal");i&&(i.style.display="none"),P()}})}),window.addEventListener("click",r=>{r.target===t&&(t.style.display="none",P()),r.target===document.getElementById("reservation-modal")&&(document.getElementById("reservation-modal").style.display="none",P())}),document.addEventListener("click",r=>{if(r.target.classList.contains("qty-plus")){const i=r.target.dataset.item,s=r.target.closest(".add-to-cart");ie(i,s.dataset.price);return}if(r.target.classList.contains("qty-minus")){const i=r.target.dataset.item,s=I.find(l=>l.name===i);s&&(s.quantity--,s.quantity<=0&&I.splice(I.indexOf(s),1),K(),ee(),te(i),ne());return}if(r.target.classList.contains("add-to-cart")&&!r.target.classList.contains("has-qty")){const i=r.target.dataset.item,s=r.target.dataset.price;ie(i,s,r.target),qt(r.target)}});var a=document.getElementById("clear-cart");a&&a.addEventListener("click",_e);var o=document.getElementById("checkout");o&&o.addEventListener("click",function(){typeof window.checkout=="function"&&window.checkout()})}Object.assign(window,{addToCart:ie,finalizeAddToCart:be,updateQuantity:Ot,removeItem:Rt,clearCart:_e,closeAddonPicker:Mt,toggleAddonOption:kt,confirmAddonSelection:Tt,closeFloatingCart:Pt,closeSignInPrompt:Fe,updateFloatingCartBar:Se});var q=null,H=null,Ue=500;function Be(){var e=I.reduce(function(r,i){return r+i.price*i.quantity},0),t=e>=se?0:ce,n=0,a=e+t;if(q&&(q.type==="percent"?n=Math.floor(e*q.discount/100):q.type==="flat"&&(n=q.discount),n=Math.min(n,e),a=e-n+t),H&&H.balance>0){var o=Math.min(H.balance,a);a=Math.max(0,a-o)}return{subtotal:e,deliveryFee:t,discount:n,total:a}}function Ht(e,t){return e?e.active?e.expiresAt&&new Date(e.expiresAt)<new Date?{valid:!1,reason:"This coupon has expired."}:e.usageLimit&&e.usedCount>=e.usageLimit?{valid:!1,reason:"This coupon has reached its usage limit."}:e.minOrder&&t<e.minOrder?{valid:!1,reason:"Minimum order ‚Çπ"+e.minOrder+" required."}:{valid:!0}:{valid:!1,reason:"This coupon is no longer active."}:{valid:!1,reason:"No coupon"}}function We(e,t){if(!e)return 0;var n=e.type==="percent"?t*e.discount/100:e.discount;return e.maxDiscount&&e.type==="percent"&&(n=Math.min(n,e.maxDiscount)),n=Math.min(n,t),n}function Ft(){if(I.length===0){k("Your cart is empty!");return}if(!N()){document.getElementById("cart-modal").style.display="none",P(),typeof window.openAuthModal=="function"&&window.openAuthModal(),k("Please sign in to continue with your order");return}document.getElementById("cart-modal").style.display="none",X(),Ge()}function Ge(){var e=I.reduce(function(b,h){return b+h.price*h.quantity},0),t=e>=se?0:ce,n=e+t,a="";I.forEach(function(b){a+='<div class="co-item"><span>'+b.name+" x"+b.quantity+"</span><span>‚Çπ"+b.price*b.quantity+"</span></div>"}),document.getElementById("checkout-items").innerHTML=a,document.getElementById("co-subtotal").textContent="‚Çπ"+e,document.getElementById("co-delivery").textContent=t===0?"FREE":"‚Çπ"+t,document.getElementById("co-total").textContent="‚Çπ"+n;var o=document.getElementById("loyalty-redeem-btn");if(o){var r=N();if(r&&r.loyaltyPoints>=100){var i=Math.floor(r.loyaltyPoints/100)*10;o.textContent="Redeem "+r.loyaltyPoints+" pts (‚Çπ"+i+" off)",o.style.display="block"}else o.style.display="none"}we(1),document.getElementById("checkout-modal").style.display="block";var s=N(),l=document.getElementById("coupon-code"),c=document.getElementById("coupon-msg");if(s&&!s.usedWelcomeBonus){q={discount:25,type:"percent",label:"25% off (Welcome Bonus!)"},l.value="WELCOME25",c.textContent="Welcome bonus applied! You get 25% off!",c.className="coupon-msg success";var f=e*.25;f=Math.min(f,e);var g=e-f+t;document.getElementById("co-total").textContent="‚Çπ"+g.toFixed(0)}else q=null,l.value="",c.textContent="",c.className="coupon-msg"}function _t(){document.getElementById("checkout-modal").style.display="none",P(),document.getElementById("co-name").value="",document.getElementById("co-phone").value="",document.getElementById("co-address").value="",document.getElementById("co-notes").value=""}function we(e){document.querySelectorAll(".checkout-step").forEach(function(t){t.classList.remove("active")}),document.getElementById("checkout-step-"+e).classList.add("active"),e===3&&Ee()}function Ee(){var e=Be(),t=e.total,n="‚Çπ"+t.toFixed(0);document.getElementById("pay-total").textContent=n;var a=document.getElementById("cod-total");a&&(a.textContent=n),Ve("razorpay")}function Ve(e){["razorpay","cod"].forEach(function(t){var n=document.getElementById("tab-"+t),a=document.getElementById("pay-panel-"+t);n&&n.classList.toggle("active",t===e),a&&a.classList.toggle("active",t===e)})}function Ut(){var e=document.getElementById("co-name").value.trim(),t=document.getElementById("co-phone").value.trim(),n=document.getElementById("co-address").value.trim();if(!e||!t||!n){k("Please fill in all required fields.");return}if(t.length<10){k("Please enter a valid phone number.");return}var a=window.getScheduleInfo?window.getScheduleInfo():null;if(a&&(!a.date||!a.time)){k("Please select both date and time for scheduled order.");return}we(3)}function Wt(){if(typeof Razorpay>"u"){k("Payment gateway loading... please try again");return}var e=Be(),t=document.getElementById("co-name").value.trim(),n=document.getElementById("co-phone").value.trim(),a={key:mt,amount:Math.round(e.total*100),currency:"INR",name:vt,description:"Food Order - Amogha Cafe",image:window.location.origin+"/amogha-logo.png",handler:function(i){var s=i.razorpay_payment_id;xe("Razorpay",s,"paid")},prefill:{name:t,contact:n,method:"upi"},method:{upi:!0,card:!0,netbanking:!0,wallet:!0},config:{display:{blocks:{upi:{name:"Pay via UPI",instruments:[{method:"upi",flows:["qrcode","collect","intent"]}]}},sequence:["block.upi"],preferences:{show_default_blocks:!0}}},notes:{items:I.map(function(i){return i.name+" x"+i.quantity}).join(", ")},theme:{color:"#D4A017",backdrop_color:"rgba(8,6,4,0.85)"},modal:{ondismiss:function(){var i=document.getElementById("razorpay-pay-btn");i&&(i.disabled=!1,i.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Pay Now')}}},o=document.getElementById("razorpay-pay-btn");o&&(o.disabled=!0,o.innerHTML="Opening payment...");try{var r=new Razorpay(a);r.on("payment.failed",function(i){k("Payment failed: "+(i.error.description||"Please try again"));var s=document.getElementById("razorpay-pay-btn");s&&(s.disabled=!1,s.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Retry Payment')}),r.open()}catch(i){k("Error opening payment: "+i.message),o&&(o.disabled=!1,o.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg> Pay Now')}}function Gt(){xe("Cash on Delivery",null,"cod-pending")}function xe(e,t,n){var a=T();if(typeof a>"u"||!a){k("Service unavailable. Please refresh and try again.");return}var o=document.getElementById("co-name").value.trim(),r=document.getElementById("co-phone").value.trim(),i=document.getElementById("co-address").value.trim(),s=document.getElementById("co-notes").value.trim(),l=Be(),c=document.getElementById("schedule-order-check"),f=null;if(c&&c.checked){var g=document.getElementById("schedule-date"),b=document.getElementById("schedule-time");g&&b&&g.value&&b.value&&(f=new Date(g.value+"T"+b.value).toISOString())}document.getElementById("confirm-detail").textContent="Payment: "+e+(t?" (Ref: "+t+")":"")+" | Total: ‚Çπ"+l.total.toFixed(0);var h="*New Order - Amogha Cafe*\n\n";h+="*Customer:* "+o+"\n*Phone:* "+r+"\n*Address:* "+i+"\n",s&&(h+="*Notes:* "+s+"\n"),h+="\n*Items:*\n",I.forEach(function(x){h+="- "+x.name+" x"+x.quantity+" = ‚Çπ"+x.price*x.quantity+"\n"}),h+="\n*Subtotal:* ‚Çπ"+l.subtotal,h+="\n*Delivery:* "+(l.deliveryFee===0?"FREE":"‚Çπ"+l.deliveryFee),h+="\n*Total:* ‚Çπ"+l.total.toFixed(0),h+="\n*Payment:* "+e,t&&(h+="\n*Payment Ref:* "+t);var L="https://wa.me/"+ft+"?text="+encodeURIComponent(h);document.getElementById("whatsapp-link").href=L,we(4);var C=N(),B={customer:o,phone:r,address:i,notes:s,items:I.map(function(x){return{name:x.name,qty:x.quantity,price:x.price,spiceLevel:x.spiceLevel||"medium",addons:x.addons||[]}}),subtotal:l.subtotal,deliveryFee:l.deliveryFee,total:l.total,payment:e,paymentRef:t||null,paymentStatus:n,paymentVerifiedAt:t?new Date().toISOString():null,status:f?"scheduled":"pending",createdAt:new Date().toISOString(),scheduledFor:f||null,userId:C?C.phone:null},_=I.map(function(x){return x.name});a.collection("orders").add(B).then(function(x){try{window.analytics&&window.analytics.logEvent("purchase",{transaction_id:x.id,value:B.total,payment_type:e})}catch(m){}var O=window.location.origin+"/track/index.html?id="+x.id,R=document.getElementById("order-tracking-link");if(R&&(R.innerHTML='<div style="margin-top:1rem;padding:1rem;background:rgba(212,160,23,0.08);border:1px solid rgba(212,160,23,0.15);border-radius:12px;text-align:center"><p style="font-size:0.82rem;color:#a09080;margin-bottom:0.5rem">Track your order in real-time:</p><a href="'+O+'" target="_blank" rel="noopener noreferrer" style="color:#D4A017;font-weight:600;font-size:0.9rem;word-break:break-all">'+O+"</a><br><button onclick=\"safeCopy('"+O+'\',this)" style="margin-top:0.6rem;padding:0.4rem 1rem;background:linear-gradient(135deg,#D4A017,#B8860B);color:#1a0f08;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:0.78rem">Copy Link</button></div>'),C&&!C.usedWelcomeBonus&&q&&q.label&&q.label.indexOf("Welcome")!==-1&&(C.usedWelcomeBonus=!0,Z(C),a.collection("users").doc(C.phone).update({usedWelcomeBonus:!0}).catch(function(m){console.error("Bonus update error:",m)})),q=null,H&&H.code){var V=Math.min(H.balance,B.total);a.collection("giftCards").doc(H.code).update({balance:firebase.firestore.FieldValue.increment(-V),redeemedAt:new Date().toISOString()}).catch(function(m){console.error("Gift card deduction error:",m)}),H=null}if(I.length=0,K(),ee(),_.forEach(function(m){te(m)}),ne(),typeof launchConfetti=="function"&&launchConfetti(),typeof awardLoyaltyPoints=="function"&&awardLoyaltyPoints(B.total),C&&a&&a.collection("referrals").where("refereePhone","==",C.phone).where("redeemed","==",!1).limit(1).get().then(function(m){if(!m.empty){var u=m.docs[0],v=u.data().referrerPhone;a.collection("users").doc(v).get().then(function(y){if(y.exists){var p=(y.data().loyaltyPoints||0)+100;a.collection("users").doc(v).update({loyaltyPoints:p}).catch(function(w){console.error("Referrer points error:",w)})}}),u.ref.update({redeemed:!0}).catch(function(y){console.error("Referral redeem error:",y)})}}).catch(function(m){console.error("Referral lookup error:",m)}),typeof scheduleReviewPrompt=="function"&&scheduleReviewPrompt(B.items.map(function(m){return{name:m.name}})),typeof sendPushNotification=="function"&&sendPushNotification("Order Placed!","Your order from Amogha has been placed successfully."),r){var G=r.replace(/\D/g,"");G.length===10&&(G="91"+G);var d="Hi "+o+"! üôè\n\nYour order at *Amogha Cafe & Restaurant* has been placed successfully!\n\n";d+="*Order ID:* "+x.id+"\n",d+="*Items:* "+B.items.map(function(m){return m.name+" x"+m.qty}).join(", ")+"\n",d+="*Total:* ‚Çπ"+l.total.toFixed(0)+"\n\n",d+="üìç Track your order: "+window.location.origin+"/track/?id="+x.id+"\n\n",d+="Thank you for dining with us! üçõ",window.open("https://wa.me/"+G+"?text="+encodeURIComponent(d),"_blank")}a.collection("inventory").get().then(function(m){var u={};m.forEach(function(p){var w=p.data();u[(w.name||"").toLowerCase()]={id:p.id,qty:w.quantity||0}});var v=a.batch(),y=!1;B.items.forEach(function(p){var w=p.name.toLowerCase();if(u[w]&&u[w].qty>0){var E=a.collection("inventory").doc(u[w].id);v.update(E,{quantity:Math.max(0,u[w].qty-p.qty)}),y=!0}}),y&&v.commit().catch(function(p){console.error("Inventory deduction error:",p)})}).catch(function(m){console.error("Inventory fetch error:",m)})}).catch(function(x){console.error("Order save error:",x),k("Order failed to save. Please try again or check your connection.")})}function Vt(){var e=document.getElementById("coupon-code"),t=document.getElementById("coupon-msg"),n=e.value.trim().toUpperCase(),a={AMOGHA20:{discount:20,type:"percent",label:"20% off"},WELCOME50:{discount:50,type:"flat",label:"‚Çπ50 off"},FIRST10:{discount:10,type:"percent",label:"10% off"},WELCOME25:{discount:25,type:"percent",label:"25% off (Welcome Bonus!)"}};function o(i){q=i,t.textContent="Coupon applied! "+i.label,t.className="coupon-msg success";var s=I.reduce((g,b)=>g+b.price*b.quantity,0),l=s>=se?0:ce,c=We(i,s),f=s-c+l;document.getElementById("co-total").textContent="‚Çπ"+f.toFixed(0)}var r=T();r?r.collection("coupons").doc(n).get().then(function(i){if(i.exists){var s=i.data(),l=I.reduce((f,g)=>f+g.price*g.quantity,0),c=Ht(s,l);if(!c.valid){t.textContent=c.reason,t.className="coupon-msg error",q=null;return}o(s),r.collection("coupons").doc(n).update({usedCount:firebase.firestore.FieldValue.increment(1)})}else a[n]?o(a[n]):(q=null,t.textContent="Invalid coupon code. Please check and try again.",t.className="coupon-msg error")}).catch(function(){a[n]?o(a[n]):(q=null,t.textContent="Invalid coupon code.",t.className="coupon-msg error")}):a[n]?o(a[n]):(q=null,t.textContent="Invalid coupon code. Please check and try again.",t.className="coupon-msg error")}function Yt(){q=null;var e=document.getElementById("coupon-code"),t=document.getElementById("coupon-msg");e&&(e.value=""),t&&(t.textContent="",t.className="coupon-msg"),Ee()}function zt(){var e=document.getElementById("giftcard-code"),t=document.getElementById("giftcard-msg"),n=e.value.trim().toUpperCase();if(!n){t.textContent="Please enter a gift card code",t.className="coupon-msg error";return}var a=T();if(!a){t.textContent="Service unavailable",t.className="coupon-msg error";return}a.collection("giftCards").doc(n).get().then(function(o){if(!o.exists){t.textContent="Invalid gift card code",t.className="coupon-msg error",H=null;return}var r=o.data();if(!r.active){t.textContent="This gift card is no longer active",t.className="coupon-msg error",H=null;return}if(r.balance<=0){t.textContent="This gift card has no remaining balance",t.className="coupon-msg error",H=null;return}H={code:n,balance:r.balance},t.textContent="Gift card applied! Balance: ‚Çπ"+r.balance,t.className="coupon-msg success";var i=I.reduce(function(b,h){return b+h.price*h.quantity},0),s=i>=se?0:ce,l=q?We(q,i):0,c=i-l+s,f=Math.min(r.balance,c),g=c-f;document.getElementById("co-total").textContent="‚Çπ"+g.toFixed(0)}).catch(function(o){t.textContent="Error: "+o.message,t.className="coupon-msg error"})}function jt(){H=null;var e=document.getElementById("giftcard-code"),t=document.getElementById("giftcard-msg");e&&(e.value=""),t&&(t.textContent="",t.className="coupon-msg"),Ee()}function $t(){document.getElementById("giftcard-modal").style.display="block",X()}function Jt(){document.getElementById("giftcard-modal").style.display="none",P()}function Xt(e,t){Ue=e,document.querySelectorAll(".gc-amount-btn").forEach(function(n){n.classList.remove("active")}),t&&t.classList.add("active")}function Kt(){var e=document.getElementById("gc-recipient-phone").value.trim(),t=document.getElementById("gc-msg");if(!e||e.length!==10){t.textContent="Please enter a valid 10-digit phone number",t.className="coupon-msg error";return}var n=N(),a=n?n.phone:"guest",o=Ue,r="GC-"+Date.now().toString(36).toUpperCase().slice(-4)+"-"+Math.random().toString(36).toUpperCase().slice(2,6);if(typeof Razorpay>"u"){t.textContent="Payment system loading. Please try again.",t.className="coupon-msg error";return}var i=T(),s={key:"rzp_live_bfHYCYWDyoSHFn",amount:o*100,currency:"INR",name:"Amogha Cafe",description:"Gift Card - "+r,image:"https://amogha-cafe.web.app/amogha-logo.png",handler:function(c){i.collection("giftCards").doc(r).set({code:r,amount:o,balance:o,purchaserPhone:a,recipientPhone:e,paymentRef:c.razorpay_payment_id,active:!0,createdAt:new Date().toISOString()}).then(function(){t.textContent="Gift card "+r+" created successfully! Share this code with the recipient.",t.className="coupon-msg success",document.getElementById("gc-recipient-phone").value=""}).catch(function(f){t.textContent="Payment received but error saving: "+f.message,t.className="coupon-msg error"})},prefill:{name:n?n.name:"",contact:a},theme:{color:"#D4A017"}},l=new Razorpay(s);l.open()}function Qt(){var e=N();if(!(!e||!e.loyaltyPoints||e.loyaltyPoints<100)){var t=Math.floor(e.loyaltyPoints/100)*10,n=Math.floor(e.loyaltyPoints/100)*100,a=I.reduce(function(c,f){return c+f.price*f.quantity},0),o=Math.min(t,a);if(!(o<=0)){var r=a>=se?0:ce,i=a-o+r;q={discount:o,type:"flat",label:"Rs."+o+" (Loyalty Points)"},document.getElementById("co-total").textContent="Rs."+i.toFixed(0);var s=document.getElementById("coupon-msg");s.textContent="Redeemed "+n+" points for Rs."+o+" off!",s.className="coupon-msg success",document.getElementById("coupon-code").value="LOYALTY",e.loyaltyPoints-=n,Z(e);var l=T();l&&l.collection("users").doc(e.phone).update({loyaltyPoints:e.loyaltyPoints}).catch(function(c){console.error("Loyalty update error:",c)}),typeof updateLoyaltyWidget=="function"&&updateLoyaltyWidget()}}}Object.assign(window,{checkout:Ft,openCheckout:Ge,closeCheckout:_t,goToStep:we,setupPayment:Ee,switchPayTab:Ve,validateAndPay:Ut,openRazorpay:Wt,placeCodOrder:Gt,placeOrderToFirestore:xe,applyCoupon:Vt,removeCoupon:Yt,applyGiftCard:zt,removeGiftCard:jt,openGiftCardModal:$t,closeGiftCardModal:Jt,buyGiftCard:Kt,selectGcAmount:Xt,redeemLoyaltyAtCheckout:Qt});function fe(e,t,n,a,o,r){var i=T();if(!(typeof i>"u"||!i)){try{var s=localStorage.getItem(t);if(s){var l=JSON.parse(s);if(l.ts&&Date.now()-l.ts<n*1e3){o(l.data);return}}}catch(f){}var c=i.collection(e);r&&r.orderBy&&(c=c.orderBy(r.orderBy[0])),r&&r.where&&(c=c.where(r.where[0],r.where[1],r.where[2])),c.get().then(function(f){var g=a(f);o(g);try{localStorage.setItem(t,JSON.stringify({ts:Date.now(),data:g}))}catch(b){}}).catch(function(f){console.error("cachedGet "+e+" error:",f);try{var g=localStorage.getItem(t);g&&o(JSON.parse(g).data)}catch(b){}})}}function Zt(){var e=T();if(!e)return;function t(o){document.querySelectorAll(".menu-item-card").forEach(function(r){var i=r.querySelector("h4");if(i){var s=i.textContent.replace(/Bestseller|Must Try|New/gi,"").trim(),l=o[s];if(l&&l.count>0){var c=(l.total/l.count).toFixed(1),f=r.querySelector(".item-rating");f&&f.remove();var g=document.createElement("div");g.className="item-rating",g.innerHTML='<span class="rating-stars">'+en(parseFloat(c))+'</span><span class="rating-text">'+c+" ("+l.count+")</span>";var b=r.querySelector(".item-description");b&&b.after(g)}}})}try{var n=W("amoghaRatings");if(n){var a=JSON.parse(n);if(a.ts&&Date.now()-a.ts<6e5&&a.data){t(a.data);return}}}catch(o){}e.collection("reviews").get().then(function(o){var r={};o.forEach(function(i){var s=i.data();r[s.itemName]||(r[s.itemName]={total:0,count:0}),r[s.itemName].total+=s.rating,r[s.itemName].count++}),t(r),z("amoghaRatings",JSON.stringify({ts:Date.now(),data:r}))}).catch(function(){try{var o=W("amoghaRatings");if(o){var r=JSON.parse(o);r.data&&t(r.data)}}catch(i){}})}function en(e){for(var t="",n=1;n<=5;n++)n<=Math.floor(e)?t+='<span class="star filled">&#9733;</span>':n-.5<=e?t+='<span class="star half">&#9733;</span>':t+='<span class="star empty">&#9734;</span>';return t}function tn(e){var t=document.querySelector(".specials-grid");if(t){if(e.length===0){var n=t.closest(".specials");n&&(n.style.display="none");return}var n=t.closest(".specials");n&&(n.style.display=""),t.innerHTML=e.map(function(a){var o=a.available?"":" item-unavailable";return'<div class="special-card'+o+'" data-id="'+a.name+'"><div class="glow-border"></div><div class="special-badge">'+(a.badge||"Special")+"</div><h3>"+a.name+"</h3><p>"+(a.description||"")+'</p><div class="special-price"><span class="new-price">&#8377;'+a.price+'</span></div><button class="add-to-cart" data-item="'+a.name+'" data-price="'+a.price+'">Order Now</button></div>'}).join("")}}function nn(){var e='<div class="menu-skeleton-card"><div class="skeleton-line h-img"></div><div class="skeleton-line w-60"></div><div class="skeleton-line w-100"></div><div class="skeleton-line w-80"></div><div class="skeleton-btn"></div></div>';document.querySelectorAll(".menu-items").forEach(function(t){t.querySelector(".menu-skeleton-card")||t.insertAdjacentHTML("afterbegin",e+e+e)})}function Pe(){document.querySelectorAll(".menu-skeleton-card").forEach(function(e){e.remove()})}function an(){document.querySelectorAll(".menu-item-card").forEach(function(e){var t=e.querySelector(".menu-badge"),n=e.querySelector("h4"),a=t||n;if(a){var o=(t?t.textContent:"")+a.closest(".menu-item-card").dataset.id,r=/chef|spicy|hot|bestseller/i.test(o);if(r&&!e.querySelector(".flame-badge")){var i=document.createElement("span");i.className="flame-badge",i.textContent="üî•",i.title="Popular pick!",t?t.after(i):n&&n.appendChild(i)}}})}function on(){var e=T();if(!e)return;nn();function t(i){var s=i.querySelector(".menu-item-img-wrap");if(s)return s;s=document.createElement("div"),s.className="menu-item-img-wrap";var l=document.createElement("img");l.className="menu-item-img",l.alt="",l.loading="lazy";var c=document.createElement("div");return c.className="menu-item-img-placeholder",c.innerHTML='<svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg><span>Image coming soon</span>',s.appendChild(l),s.appendChild(c),i.insertBefore(s,i.firstChild),s}e.collection("menu").onSnapshot(function(i){Pe();var s={};i.forEach(function(l){s[l.id]=l.data()}),document.querySelectorAll(".menu-item-card[data-id]").forEach(function(l){var c=l.dataset.id,f=s[c];if(!f){l.style.display="none";return}l.style.display="",f.available?(l.classList.remove("item-unavailable"),l.style.opacity="",l.style.pointerEvents="",l.style.filter=""):(l.classList.add("item-unavailable"),l.style.opacity="0.45",l.style.pointerEvents="none",l.style.filter="grayscale(0.3)");var g=l.querySelector(".add-to-cart");if(g&&f.price!==parseInt(g.dataset.price)){g.dataset.price=f.price;var b=l.querySelector(".price");b&&(b.innerHTML="&#8377;"+f.price)}var h=t(l),L=h.querySelector(".menu-item-img");f.imageUrl?(L.dataset.currentUrl!==f.imageUrl&&(L.dataset.currentUrl=f.imageUrl,L.src=f.imageUrl,L.onload=function(){L.classList.add("loaded"),h.classList.add("has-image")},L.onerror=function(){L.classList.remove("loaded"),h.classList.remove("has-image"),L.src=""}),l.dataset.imageUrl=f.imageUrl):(L.classList.remove("loaded"),h.classList.remove("has-image"),L.src="",L.dataset.currentUrl="",delete l.dataset.imageUrl)}),an()},function(i){console.error("Menu listener error:",i),Pe()}),fe("specials","specials_cache",300,function(i){var s=[];return i.forEach(function(l){var c=l.data();c.id=l.id,s.push(c)}),s},tn,{orderBy:["sortOrder"]}),fe("heroSlides","heroSlides_cache",300,function(i){var s=[];return i.forEach(function(l){var c=l.data();c.active&&s.push(c)}),s},function(i){i.length!==0&&typeof window.updateHeroSlides=="function"&&window.updateHeroSlides(i)},{orderBy:["sortOrder"]});try{var n=localStorage.getItem("theme_cache");if(n){var a=JSON.parse(n);if(a.ts&&Date.now()-a.ts<6e5&&a.theme&&a.theme!=="default"){document.body.classList.add("theme-"+a.theme);return}}}catch(i){}e.collection("settings").doc("global").get().then(function(i){var s=i.exists&&i.data().activeTheme?i.data().activeTheme:"default";s!=="default"&&document.body.classList.add("theme-"+s);try{localStorage.setItem("theme_cache",JSON.stringify({ts:Date.now(),theme:s}))}catch(l){}}).catch(function(){});var o=document.getElementById("testimonials-grid");o&&fe("testimonials","testimonials_cache",600,function(s){var l=[];return s.forEach(function(c){var f=c.data();f.active&&l.push(f)}),l},function(s){if(s.length===0){var l=o.closest(".testimonials");l&&(l.style.display="none");return}o.innerHTML=s.map(function(c){var f=c.thumbnailUrl||(c.videoUrl?c.videoUrl.replace("/upload/","/upload/f_jpg,so_1/"):"");return'<div class="testimonial-card" onclick="openVideoLightbox(\''+(c.videoUrl||"")+'\')"><div class="testimonial-thumb">'+(f?'<img src="'+f+'" alt="" loading="lazy">':'<div class="testimonial-placeholder">üé¨</div>')+'<div class="testimonial-play">&#9654;</div></div><p class="testimonial-name">'+(c.customerName||"")+"</p>"+(c.caption?'<p class="testimonial-caption">'+c.caption+"</p>":"")+"</div>"}).join("")},{orderBy:["sortOrder"]});var r=document.getElementById("social-feed-strip");r&&fe("socialPosts","socialPosts_cache",600,function(s){var l=[];return s.forEach(function(c){var f=c.data();f.active&&l.push(f)}),l},function(s){if(s.length===0){var l=r.closest(".social-feed");l&&(l.style.display="none");return}r.innerHTML=s.map(function(c){var f=c.link?'<a href="'+c.link+'" target="_blank" rel="noopener">':"<div>",g=c.link?"</a>":"</div>";return f+'<div class="social-card"><img src="'+c.imageUrl+'" alt="" loading="lazy">'+(c.caption?'<span class="social-caption">'+c.caption+"</span>":"")+"</div>"+g}).join("")},{orderBy:["sortOrder"]})}function rn(){const e=["Authentic Indian Cuisine","Crafted with Passion","A Legacy of Flavour","Where Taste Meets Art","Born from Tradition"],t=["Tradition, Perfection & Soul in Every Dish","Handcrafted Recipes Passed Down Generations","An Unforgettable Culinary Journey Awaits","Every Flavour Tells a Story of Heritage","Experience the Art of Indian Fine Dining"],n=document.querySelector(".hero-tagline .hero-text-inner"),a=document.querySelector(".hero-subtitle .hero-text-inner");if(!n||!a)return;let o=0;function r(){o=(o+1)%e.length,n.classList.add("fade-out"),a.classList.add("fade-out"),setTimeout(()=>{n.textContent=e[o],a.textContent=t[o],window._scrambleReveal?window._scrambleReveal(e[o],n):n.classList.remove("fade-out"),a.classList.remove("fade-out")},700)}setTimeout(()=>{setInterval(r,6e3)},5e3)}function sn(){const e=document.querySelectorAll(".header-slideshow .slide");if(e.length===0)return;let t=0;setInterval(()=>{e[t].classList.remove("active");let n;do n=Math.floor(Math.random()*e.length);while(n===t&&e.length>1);t=n,e[t].classList.add("active")},3e3)}function cn(){var e=document.querySelectorAll("#hero-slideshow .hero-slide"),t=document.getElementById("hero-sparkles"),n=0,a=window.innerWidth<=768;function o(){if(t){t.innerHTML="";for(var c=a?5:12,f=a?3:6,g=a?4:10,b=a?2:4,h=0;h<b;h++){var L=document.createElement("span");L.className="sp-glow";var C=200+Math.random()*250,B=10+h/b*70+Math.random()*15,_=20+Math.random()*50,x=10+Math.random()*8,O=h*3+Math.random()*2;L.style.cssText="left:"+B+"%;top:"+_+"%;width:"+C+"px;height:"+C+"px;--glow-dur:"+x+"s;--glow-delay:"+O+"s;",t.appendChild(L)}for(var R=0;R<c;R++){var V=document.createElement("span"),G=["","thin","accent","thin",""],d=G[R%G.length];V.className="sp-line"+(d?" "+d:"");var m=140+Math.random()*180,u=3+R/c*90+Math.random()*6,v=12+Math.random()*10,y=R/c*v,p=7+Math.random()*6,w=2.5+Math.random()*2;V.style.cssText="left:"+u+"%;height:"+m+"px;--line-dur:"+v+"s;--line-delay:"+y+"s;--sway-dur:"+p+"s;--shimmer-dur:"+w+"s;",t.appendChild(V)}for(var E=0;E<f;E++){var S=document.createElement("span");S.className="sp-dot";var M=4+Math.random()*5,A=8+Math.random()*84,F=18+Math.random()*12,D=E*3.5+Math.random()*4;S.style.cssText="left:"+A+"%;width:"+M+"px;height:"+M+"px;--dot-dur:"+F+"s;--dot-delay:"+D+"s;",t.appendChild(S)}for(var j=0;j<g;j++){var Ce=document.createElement("span");Ce.className="sp-mote";var qe=2+Math.random()*3,st=5+Math.random()*90,ct=18+Math.random()*14,lt=j*2.5+Math.random()*3,dt=1.5+Math.random()*2;Ce.style.cssText="left:"+st+"%;width:"+qe+"px;height:"+qe+"px;--mote-dur:"+ct+"s;--mote-delay:"+lt+"s;--twinkle-dur:"+dt+"s;",t.appendChild(Ce)}}}o();var r=["kb-zoom-left","kb-zoom-right","kb-pan-down","kb-zoom-center"],i=null;function s(){i&&clearInterval(i),e=document.querySelectorAll("#hero-slideshow .hero-slide"),n=0,e.length>1&&(i=setInterval(function(){e[n].classList.remove("active"),n=(n+1)%e.length;for(var c=0;c<r.length;c++)e[n].classList.remove(r[c]);e[n].classList.add(r[Math.floor(Math.random()*r.length)]),e[n].classList.add("active")},2e3))}s(),window.updateHeroSlides=function(c){var f=document.getElementById("hero-slideshow");if(!(!f||c.length===0)){i&&clearInterval(i);for(var g=f.querySelectorAll(".hero-slide"),b=0;b<g.length;b++)g[b].remove();c.forEach(function(h,L){var C=document.createElement("div");if(C.className="hero-slide"+(L===0?" active":""),L===0&&C.classList.add(r[Math.floor(Math.random()*r.length)]),h.type==="video"){C.classList.add("hero-slide-video");var B=document.createElement("video");B.src=h.url,B.autoplay=!0,B.muted=!0,B.loop=!0,B.playsInline=!0,B.setAttribute("playsinline",""),B.setAttribute("webkit-playsinline",""),C.appendChild(B)}else C.style.backgroundImage="url("+h.url+")";f.appendChild(C)}),e=f.querySelectorAll(".hero-slide"),n=0,e.length>1&&(i=setInterval(function(){e[n].classList.remove("active");var h=e[n].querySelector("video");h&&h.pause(),n=(n+1)%e.length;for(var L=0;L<r.length;L++)e[n].classList.remove(r[L]);e[n].classList.add(r[Math.floor(Math.random()*r.length)]),e[n].classList.add("active");var C=e[n].querySelector("video");C&&(C.currentTime=0,C.play())},2e3))}};var l=document.querySelector(".hero-tagline .hero-text-inner");if(l&&(window._scrambleReveal=function(c,f){f.textContent=c,f.classList.remove("fade-out"),f.style.opacity="1",f.style.transform="translateY(0)",f.classList.remove("blur-reveal"),f.offsetWidth,f.classList.add("blur-reveal")},setTimeout(function(){window._scrambleReveal(l.textContent,l)},2800)),window.innerWidth>768){const c=document.querySelector(".hero"),f=document.querySelector(".hero-mouse-spotlight");c&&f&&c.addEventListener("mousemove",function(g){const b=c.getBoundingClientRect(),h=g.clientX-b.left,L=g.clientY-b.top;f.style.setProperty("--mouse-x",h+"px"),f.style.setProperty("--mouse-y",L+"px")})}}function ln(){const e=document.getElementById("confetti-canvas");if(!e)return;const t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const n=[],a=["#EFB31A","#8B1A1A","#27ae60","#e74c3c","#3498db","#f39c12","#9b59b6"];for(let i=0;i<150;i++)n.push({x:Math.random()*e.width,y:Math.random()*e.height-e.height,w:Math.random()*10+5,h:Math.random()*6+3,color:a[Math.floor(Math.random()*a.length)],vy:Math.random()*3+2,vx:Math.random()*2-1,rot:Math.random()*360,rotSpeed:Math.random()*6-3});let o=0;function r(){t.clearRect(0,0,e.width,e.height),n.forEach(i=>{i.y+=i.vy,i.x+=i.vx,i.rot+=i.rotSpeed,t.save(),t.translate(i.x,i.y),t.rotate(i.rot*Math.PI/180),t.fillStyle=i.color,t.fillRect(-i.w/2,-i.h/2,i.w,i.h),t.restore()}),o++,o<200?requestAnimationFrame(r):t.clearRect(0,0,e.width,e.height)}r()}function ve(){var e=document.getElementById("nav-links"),t=document.getElementById("mobile-menu-overlay"),n=document.getElementById("mobile-menu-toggle");e&&e.classList.remove("active"),t&&t.classList.remove("active"),n&&(n.textContent="‚ò∞"),P()}function dn(){"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.scrollTo(0,0),window.addEventListener("load",()=>{const d=document.getElementById("page-transition");d&&setTimeout(()=>d.classList.add("loaded"),100),setTimeout(()=>{const m=document.getElementById("preloader");m&&m.classList.add("hidden")},2200)}),function(){const d=document.getElementById("theme-toggle");if(!d)return;W("amogha-dark-mode")==="true"&&(document.body.classList.add("dark-mode"),d.textContent="‚òÄÔ∏è"),d.addEventListener("click",()=>{document.body.classList.toggle("dark-mode");const u=document.body.classList.contains("dark-mode");d.textContent=u?"‚òÄÔ∏è":"üåô",z("amogha-dark-mode",u)})}(),function(){const d=document.querySelectorAll(".stat-number");function m(){if(window.innerWidth<=768){d.forEach(function(E){var S=parseFloat(E.dataset.target);E.textContent=S%1!==0?S.toFixed(1):S.toLocaleString()});return}var v=[];d.forEach(function(E){v.push({el:E,target:parseFloat(E.dataset.target),isDecimal:parseFloat(E.dataset.target)%1!==0,lastValue:-1})});var y=2e3,p=performance.now();function w(E){for(var S=E-p,M=Math.min(S/y,1),A=1-Math.pow(1-M,3),F=0;F<v.length;F++){var D=v[F],j=D.isDecimal?+(D.target*A).toFixed(1):Math.floor(D.target*A);j!==D.lastValue&&(D.el.textContent=D.isDecimal?j.toFixed(1):j.toLocaleString(),D.lastValue=j)}M<1&&requestAnimationFrame(w)}requestAnimationFrame(w)}const u=document.querySelector(".stats-section");if(u){let v=!1;const y=new IntersectionObserver(p=>{p[0].isIntersecting&&!v&&(v=!0,m(),y.unobserve(u))},{threshold:.3});y.observe(u)}}(),function(){var d=document.querySelectorAll(".reveal");if(!(!d.length||typeof IntersectionObserver>"u")){var m=new IntersectionObserver(function(u){u.forEach(function(v){v.isIntersecting&&(v.target.classList.add("in-view"),m.unobserve(v.target))})},{threshold:.12,rootMargin:"0px 0px -40px 0px"});d.forEach(function(u){m.observe(u)})}}(),function(){var d=document.getElementById("nav-links"),m=document.getElementById("mobile-menu-toggle"),u=document.getElementById("mobile-menu-overlay");if(!d||!m)return;var v=d.parentElement;function y(){window.innerWidth<=768?d.parentElement!==document.body&&document.body.appendChild(d):d.parentElement===document.body&&v.appendChild(d)}y();var p;window.addEventListener("resize",function(){clearTimeout(p),p=setTimeout(y,100)}),m.addEventListener("click",()=>{const w=d.classList.toggle("active");u&&u.classList.toggle("active",w),m.textContent=w?"‚úï":"‚ò∞",w?X():P()}),u&&u.addEventListener("click",ve),d.querySelectorAll("a").forEach(function(w){w.addEventListener("click",function(E){var S=w.getAttribute("href"),M=w.id==="signin-btn"||w.closest("#signin-btn");if(M){d.classList.remove("active"),u&&u.classList.remove("active"),m.textContent="‚ò∞";return}if(ve(),S&&S.startsWith("#")){E.preventDefault();var A=document.querySelector(S);A&&setTimeout(function(){A.scrollIntoView({behavior:"smooth",block:"start"})},50)}})})}(),document.querySelectorAll('a[href^="#"]').forEach(d=>{d.addEventListener("click",function(m){if(this.id==="cart-icon")return;m.preventDefault();const u=document.querySelector(this.getAttribute("href"));u&&(u.scrollIntoView({behavior:"smooth",block:"start"}),ve())})});const e=document.getElementById("back-to-top");e&&e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const t=document.querySelector(".hero-slideshow"),n=document.querySelectorAll("section[id]"),a=document.querySelectorAll('.nav-links a[href^="#"]'),o=document.querySelector("header");var r=0,i=document.querySelector(".hero-scroll-indicator"),s=document.getElementById("btt-ring-fill"),l=document.getElementById("sticky-order-bar"),c=document.querySelector(".hero"),f=2*Math.PI*16,g=c?c.offsetHeight:600,b=[];(function(){n.forEach(function(m){b.push({id:m.getAttribute("id"),top:m.offsetTop})})})();var h=document.querySelector(".about"),L=document.querySelector(".chef-content"),C=document.querySelector(".stats-grid"),B=h?h.offsetTop:0,_=L?L.closest("section")||L.closest(".chef-section"):null,x=_?_.offsetTop:0,O=C?C.closest(".stats-section"):null,R=O?O.offsetTop:0;window.addEventListener("resize",function(){g=c?c.offsetHeight:600,b=[],n.forEach(function(d){b.push({id:d.getAttribute("id"),top:d.offsetTop})}),B=h?h.offsetTop:0,x=_?_.offsetTop:0,R=O?O.offsetTop:0});var V=!1;window.addEventListener("scroll",function(){V||(requestAnimationFrame(function(){var d=window.pageYOffset,m=window.innerWidth>768;if(t&&m&&(t.style.transform="translateY("+d*.35+"px)"),m){var u=window.innerHeight;if(h&&d>B-u&&d<B+h.offsetHeight){var v=(d-B+u)*.06;h.style.setProperty("--section-parallax",v+"px")}L&&d>x-u&&d<x+800&&(L.style.transform="translateY("+(d-x+u)*.04+"px)"),C&&d>R-u&&d<R+600&&(C.style.transform="translateY("+(d-R+u)*.035+"px)")}if(i&&d<300?i.style.opacity=Math.max(0,1-d/300):i&&i.style.opacity!=="0"&&(i.style.opacity=0),o&&m&&(d>r&&d>100?o.style.transform="translateY(-100%)":o.style.transform="translateY(0)"),r=d,e){var y=d>400,p=e.classList.contains("visible");y&&!p?e.classList.add("visible"):!y&&p&&e.classList.remove("visible")}if(s){var w=document.documentElement.scrollHeight-document.documentElement.clientHeight,E=w>0?d/w:0;s.style.strokeDashoffset=f*(1-E)}if(l){var S=d>g,M=l.classList.contains("visible");S&&!M?l.classList.add("visible"):!S&&M&&l.classList.remove("visible")}if(m){for(var A="",F=0;F<b.length;F++)d>=b[F].top-150&&(A=b[F].id);a.forEach(function(D){D.classList.remove("active"),D.getAttribute("href")==="#"+A&&D.classList.add("active")})}V=!1}),V=!0)},{passive:!0}),function(){document.querySelectorAll(".about-text, .special-card, .menu-category, .gallery-item, .review-card, .faq-item, .info-block, .contact-form-section, .stat-item, .chef-content, .trust-badge").forEach(p=>{p.classList.add("reveal");const E=(p.parentElement?Array.from(p.parentElement.children).filter(M=>M.classList.contains(p.classList[0])):[]).indexOf(p);if(E>0){var S=.07*E+.04*Math.sin(E*Math.PI/4);p.style.transitionDelay=Math.max(0,S).toFixed(3)+"s"}}),document.querySelectorAll(".menu-item-card").forEach(p=>{p.classList.add("reveal");const E=(p.parentElement?Array.from(p.parentElement.children):[]).indexOf(p);var S=Math.floor(E/2),M=E%2;p.style.transitionDelay=(S*.12+M*.06).toFixed(3)+"s"}),document.querySelectorAll(".about, .specials, .menu, .gallery, .reviews, .contact, .faq").forEach(p=>{p.classList.add("section-reveal")});const m=document.querySelector(".chef-image"),u=document.querySelector("#chef-info");m&&m.classList.add("reveal-left"),u&&u.classList.add("reveal-right"),document.querySelectorAll(".stat-item").forEach(p=>{p.classList.remove("reveal"),p.classList.add("reveal-scale")});const v=document.querySelectorAll(".reveal, .reveal-left, .reveal-right, .reveal-scale, .section-reveal"),y=new IntersectionObserver(p=>{p.forEach(w=>{w.isIntersecting&&w.target.classList.add("visible")})},{threshold:.08,rootMargin:"0px 0px -50px 0px"});v.forEach(p=>y.observe(p))}(),function(){const d=document.querySelectorAll("#chef-slideshow .chef-slide"),m=document.querySelectorAll(".chef-info-slide");if(d.length<=1)return;let u=0;setInterval(()=>{d[u].classList.remove("active"),m[u]&&m[u].classList.remove("active"),u=(u+1)%d.length,d[u].classList.add("active"),m[u]&&m[u].classList.add("active")},4e3)}(),function(){const d=document.getElementById("category-carousel"),m=document.getElementById("cat-arrow-left"),u=document.getElementById("cat-arrow-right");if(!d||!m||!u)return;const v=250;function y(){m.disabled=d.scrollLeft<=5,u.disabled=d.scrollLeft>=d.scrollWidth-d.clientWidth-5}m.addEventListener("click",()=>{d.scrollBy({left:-v,behavior:"smooth"})}),u.addEventListener("click",()=>{d.scrollBy({left:v,behavior:"smooth"})}),d.addEventListener("scroll",y,{passive:!0}),y(),d.querySelectorAll(".category-item").forEach(p=>{p.addEventListener("click",w=>{w.preventDefault();const E=p.getAttribute("href"),S=document.querySelector(E);if(S){const A=S.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:A,behavior:"smooth"})}})})}(),function(){var d=document.getElementById("menu-search");d&&d.addEventListener("input",function(m){var u=m.target.value.toLowerCase();document.querySelectorAll(".menu-item-card").forEach(function(v){var y=v.querySelector("h4"),p=v.querySelector(".item-description"),w=y?y.textContent.toLowerCase():"",E=p?p.textContent.toLowerCase():"";v.style.display=w.includes(u)||E.includes(u)?"":"none"})})}(),document.querySelectorAll(".filter-btn").forEach(d=>{d.addEventListener("click",()=>{document.querySelectorAll(".filter-btn").forEach(u=>u.classList.remove("active")),d.classList.add("active");const m=d.dataset.filter;document.querySelectorAll(".menu-item-card").forEach(u=>{const v=u.querySelector(".veg-badge"),y=u.querySelector(".nonveg-badge");m==="all"?u.style.display="":m==="veg"?u.style.display=v?"":"none":m==="non-veg"&&(u.style.display=y?"":"none")})})});var G=document.getElementById("contact-form");G&&G.addEventListener("submit",d=>{d.preventDefault(),typeof showAuthToast=="function"&&showAuthToast("Thank you for your message! We will get back to you shortly."),d.target.reset()}),function(){const d=document.getElementById("food-particles");if(!d)return;const m=["üçõ","üçö","üå∂Ô∏è","üçó","ü•ò","ü´ì","‚òï","üç≤"];for(let u=0;u<12;u++){const v=document.createElement("span");v.className="food-particle",v.textContent=m[Math.floor(Math.random()*m.length)],v.style.left=Math.random()*100+"%",v.style.animationDuration=15+Math.random()*20+"s",v.style.animationDelay=Math.random()*15+"s",v.style.fontSize=1+Math.random()*1.5+"rem",d.appendChild(v)}}(),function(){let d;var m=document.getElementById("pwa-prompt"),u=document.getElementById("pwa-install-btn"),v=document.getElementById("pwa-dismiss-btn");function y(){m&&(m.style.opacity="0",m.style.transform="translateX(-50%) translateY(30px)",setTimeout(function(){m.style.display="none"},400))}window.addEventListener("beforeinstallprompt",function(p){p.preventDefault(),d=p,m&&(m.style.display="flex")}),u&&u.addEventListener("click",function(){d&&(d.prompt(),d.userChoice.then(function(){d=null,y()}))}),v&&v.addEventListener("click",y)}(),function(){if(window.innerWidth<=768)return;document.querySelectorAll(".cta-button, .add-to-cart").forEach(m=>{m.addEventListener("mousemove",u=>{const v=m.getBoundingClientRect(),y=u.clientX-v.left-v.width/2,p=u.clientY-v.top-v.height/2;m.style.transform="translate(".concat(y*.15,"px, ").concat(p*.15,"px)")}),m.addEventListener("mouseleave",()=>{m.style.transform=""})})}(),function(){function d(u){u.complete&&u.naturalHeight>0?u.classList.add("loaded"):u.addEventListener("load",()=>u.classList.add("loaded"))}document.querySelectorAll('img[loading="lazy"]').forEach(d),new MutationObserver(u=>{u.forEach(v=>{v.addedNodes.forEach(y=>{y.tagName==="IMG"&&y.loading==="lazy"&&d(y)})})}).observe(document.body,{childList:!0,subtree:!0})}(),function(){if(window.innerWidth<=768)return;const d=document.querySelectorAll(".menu-item-card"),m=4;d.forEach(function(u){var v=null;u.addEventListener("mouseenter",function(){v=u.getBoundingClientRect()}),u.addEventListener("mousemove",function(y){if(!v)return;const p=y.clientX-v.left,w=y.clientY-v.top,E=v.width/2,S=v.height/2,M=(w-S)/S*-m,A=(p-E)/E*m;u.style.transform="perspective(800px) rotateX("+M+"deg) rotateY("+A+"deg) translateY(-4px)"}),u.addEventListener("mouseleave",function(){v=null,u.style.transition="transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",u.style.transform="perspective(800px) rotateX(0) rotateY(0) translateY(0)",setTimeout(function(){u.style.transition=""},500)})})}(),function(){if(window.innerWidth<=768)return;var d=document.getElementById("cursor-glow");if(!d)return;var m=0,u=0,v=0,y=0,p=!1;document.addEventListener("mousemove",function(E){m=E.clientX,u=E.clientY,p||(p=!0,d.classList.add("active"))}),document.addEventListener("mouseleave",function(){p=!1,d.classList.remove("active")});function w(){v+=(m-v)*.12,y+=(u-y)*.12,d.style.left=v+"px",d.style.top=y+"px",requestAnimationFrame(w)}w()}(),function(){var d=document.querySelectorAll(".svg-ornament");if(d.length!==0){var m=new IntersectionObserver(function(u){u.forEach(function(v){v.isIntersecting&&v.target.classList.add("visible")})},{threshold:.5});d.forEach(function(u){m.observe(u)})}}(),function(){if(window.innerWidth<=768)return;var d=document.getElementById("menu-preview-img");if(!d)return;var m={starters:"pics/Gemini_Generated_Image_wnzsqxwnzsqxwnzs.png",curries:"pics/Gemini_Generated_Image_tu348stu348stu34.png",biryanis:"pics/Gemini_Generated_Image_h1vezgh1vezgh1ve.png",kebabs:"pics/Gemini_Generated_Image_5jdcgq5jdcgq5jdc.png",noodles:"pics/Gemini_Generated_Image_1ojbou1ojbou1ojb.png",friedrice:"pics/Gemini_Generated_Image_bfgo8abfgo8abfgo.png",rotis:"pics/Gemini_Generated_Image_6lqqu6lqqu6lqqu6.png"};function u(v){var y=v.closest(".menu-category");if(!y)return null;var p=y.id||"";return p.indexOf("starters")!==-1?"starters":p.indexOf("curries")!==-1?"curries":p.indexOf("biryanis")!==-1?"biryanis":p.indexOf("kebabs")!==-1?"kebabs":p.indexOf("noodles")!==-1?"noodles":p.indexOf("friedrice")!==-1?"friedrice":p.indexOf("rotis")!==-1?"rotis":null}document.querySelectorAll(".menu-item-card").forEach(function(v){v.addEventListener("mouseenter",function(){var y=v.dataset.imageUrl;if(y)d.src=y,d.classList.add("active");else{var p=u(v);p&&m[p]&&(d.src=m[p],d.classList.add("active"))}}),v.addEventListener("mousemove",function(y){d.style.left=y.clientX+20+"px",d.style.top=y.clientY-90+"px"}),v.addEventListener("mouseleave",function(){d.classList.remove("active")})})}(),function(){if(!(window.innerWidth<=768)){var d=document.querySelectorAll(".chef-slide, .gallery-slide-item img, .gallery-item img"),m=.03;d.forEach(function(u){u.classList.add("magnetic-image");var v=null;u.addEventListener("mouseenter",function(){v=u.getBoundingClientRect()}),u.addEventListener("mousemove",function(y){if(v){var p=y.clientX-v.left-v.width/2,w=y.clientY-v.top-v.height/2;u.style.transform="translate("+p*m+"px, "+w*m+"px) scale(1.02)"}}),u.addEventListener("mouseleave",function(){v=null,u.style.transform=""})})}}(),function(){if(!(window.innerWidth<=768)){var d=document.querySelectorAll(".menu-item-card, .about-text");d.forEach(function(m){var u=document.createElement("div");u.className="card-reflection",m.appendChild(u);var v=null;m.addEventListener("mouseenter",function(){v=m.getBoundingClientRect()}),m.addEventListener("mousemove",function(y){v&&(u.style.setProperty("--ref-x",y.clientX-v.left+"px"),u.style.setProperty("--ref-y",y.clientY-v.top+"px"))}),m.addEventListener("mouseleave",function(){v=null})})}}(),function(){var d=document.querySelectorAll(".section-wipe");if(d.length!==0){var m=new IntersectionObserver(function(u){u.forEach(function(v){v.isIntersecting&&!v.target.classList.contains("wipe-active")&&v.target.classList.add("wipe-active")})},{threshold:.15});d.forEach(function(u){m.observe(u)})}}(),function(){document.addEventListener("click",function(d){var m=d.target.closest(".add-to-cart, .cta-button, .btn-primary, .pay-now-btn, .combo-add-btn");if(m){var u=document.createElement("span");u.className="btn-ripple";var v=m.getBoundingClientRect(),y=Math.max(v.width,v.height)*2;u.style.width=u.style.height=y+"px",u.style.left=d.clientX-v.left-y/2+"px",u.style.top=d.clientY-v.top-y/2+"px",m.appendChild(u),setTimeout(function(){u.remove()},700)}})}(),function(){if(window.innerWidth<=768)return;function d(m,u){for(var v=10,y=0;y<v;y++){var p=document.createElement("span");p.className="gold-particle";var w=y/v*Math.PI*2,E=40+Math.random()*30,S=Math.cos(w)*E,M=Math.sin(w)*E;p.style.left=m+"px",p.style.top=u+"px",p.style.setProperty("--tx",S+"px"),p.style.setProperty("--ty",M+"px"),p.style.animationDelay=Math.random()*.1+"s",document.body.appendChild(p),p.addEventListener("animationend",function(){this.remove()})}}document.addEventListener("click",function(m){(m.target.classList.contains("add-to-cart")||m.target.closest(".add-to-cart"))&&d(m.clientX,m.clientY)})}(),function(){var d={Mild:"Subtle warmth, family-friendly",Medium:"Balanced heat, our recommendation",Spicy:"Andhra-level heat, for the brave!"};document.querySelectorAll(".spice-level").forEach(function(m){var u=m.textContent.trim();d[u]&&(m.setAttribute("data-tooltip",d[u]),m.classList.add("has-tooltip"))})}(),function(){var d=50;function m(u,v){if(u){var y=0,p=0,w=!1;u.addEventListener("touchstart",function(E){y=E.touches[0].clientX,p=E.touches[0].clientY,w=!0},{passive:!0}),u.addEventListener("touchmove",function(E){if(w){var S=E.touches[0].clientX-y,M=E.touches[0].clientY-p;Math.abs(S)>Math.abs(M)&&Math.abs(S)>10&&E.preventDefault()}},{passive:!1}),u.addEventListener("touchend",function(E){if(w){w=!1;var S=E.changedTouches[0].clientX-y;Math.abs(S)>d&&v(S<0?1:-1)}},{passive:!0})}}m(document.querySelector(".gallery-slideshow-wrapper"),function(u){typeof window.moveGallerySlide=="function"&&window.moveGallerySlide(u)}),m(document.querySelector(".reviews-carousel-wrapper"),function(u){typeof window.moveCarousel=="function"&&window.moveCarousel(u)})}(),function(){var d=document.getElementById("menu-search");if(d){var m=document.createElement("div");m.id="search-autocomplete",m.className="search-autocomplete-dropdown",d.parentElement.classList.add("search-autocomplete-wrap"),d.parentElement.appendChild(m);var u=[];document.querySelectorAll(".menu-item-card").forEach(function(y){var p=y.querySelector("h4"),w=y.querySelector(".item-description"),E=y.querySelector(".price"),S=!!y.querySelector(".veg-badge"),M=y.closest(".menu-category"),A=M?M.querySelector(".category-title"):null,F=A?A.textContent:"";u.push({name:p?p.textContent.replace(/Bestseller|Popular|Chef's Pick|Must Try/g,"").trim():"",desc:w?w.textContent:"",price:E?E.textContent:"",isVeg:S,category:F,card:y})});var v;d.addEventListener("input",function(){clearTimeout(v),v=setTimeout(function(){var y=d.value.toLowerCase().trim();if(document.querySelectorAll(".menu-item-card").forEach(function(w){var E=w.querySelector("h4"),S=w.querySelector(".item-description"),M=E?E.textContent.toLowerCase():"",A=S?S.textContent.toLowerCase():"";w.style.display=!y||M.includes(y)||A.includes(y)?"":"none"}),y.length<2){m.classList.remove("visible"),m.innerHTML="";return}var p=u.filter(function(w){return w.name.toLowerCase().includes(y)||w.desc.toLowerCase().includes(y)}).slice(0,6);if(p.length===0){m.classList.remove("visible"),m.innerHTML="";return}m.innerHTML=p.map(function(w){var E=w.isVeg?'<span class="ac-badge veg">VEG</span>':'<span class="ac-badge non-veg">NON-VEG</span>';return'<button class="ac-item" data-name="'+w.name+'"><div class="ac-info"><span class="ac-name">'+w.name+'</span><span class="ac-meta">'+E+' <span class="ac-cat">'+w.category+'</span></span></div><span class="ac-price">'+w.price+"</span></button>"}).join(""),m.classList.add("visible")},150)}),m.addEventListener("click",function(y){var p=y.target.closest(".ac-item");if(p){var w=p.dataset.name;d.value=w,m.classList.remove("visible");var E=u.find(function(S){return S.name===w});E&&E.card&&(document.querySelectorAll(".menu-item-card").forEach(function(S){S.style.display=""}),E.card.scrollIntoView({behavior:"smooth",block:"center"}),E.card.classList.add("search-highlight"),setTimeout(function(){E.card.classList.remove("search-highlight")},2e3))}}),document.addEventListener("click",function(y){y.target.closest(".search-autocomplete-wrap")||m.classList.remove("visible")}),d.addEventListener("keydown",function(y){y.key==="Escape"&&(m.classList.remove("visible"),d.blur())})}}(),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('img[loading="lazy"]').forEach(function(m){m.complete?m.classList.add("loaded"):(m.addEventListener("load",function(){m.classList.add("loaded")}),m.addEventListener("error",function(){m.classList.add("loaded")}))});var d=new MutationObserver(function(m){m.forEach(function(u){u.addedNodes.forEach(function(v){if(v.nodeType===1){var y=v.querySelectorAll?v.querySelectorAll('img[loading="lazy"]'):[];y.forEach(function(p){p.complete?p.classList.add("loaded"):p.addEventListener("load",function(){p.classList.add("loaded")})})}})})});d.observe(document.body,{childList:!0,subtree:!0})})}Object.assign(window,{closeMobileMenu:ve,launchConfetti:ln});function un(){if("Notification"in window){if(Notification.permission==="granted"){z("amoghaNotifPerm","granted");return}if(Notification.permission!=="denied"){var e=document.getElementById("notif-banner");!e&&!W("amoghaNotifDismissed")&&(e=document.createElement("div"),e.id="notif-banner",e.className="notif-banner",e.innerHTML='<span class="notif-icon">üîî</span><span class="notif-text">Get notified when your order is ready!</span><button class="notif-allow" onclick="enableNotifications()">Enable</button><button class="notif-dismiss" onclick="dismissNotifBanner()">&times;</button>',document.body.appendChild(e),setTimeout(function(){e.classList.add("visible")},3e3))}}}function mn(){Notification.requestPermission().then(function(e){z("amoghaNotifPerm",e),Ye(),e==="granted"&&k("Notifications enabled!")})}function Ye(){var e=document.getElementById("notif-banner");e&&(e.classList.remove("visible"),setTimeout(function(){e.remove()},400)),z("amoghaNotifDismissed","true")}function fn(e,t){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{new Notification(e,{body:t,icon:"amogha-logo.png",badge:"amogha-logo.png",tag:"amogha-order"})}catch(n){navigator.serviceWorker&&navigator.serviceWorker.ready&&navigator.serviceWorker.ready.then(function(a){a.showNotification(e,{body:t,icon:"amogha-logo.png",tag:"amogha-order"})})}}function vn(){setTimeout(un,5e3)}Object.assign(window,{enableNotifications:mn,dismissNotifBanner:Ye,sendPushNotification:fn});function ze(){var e=document.getElementById("reservation-modal");if(e){var t=document.getElementById("reservation-form");if(!t||t.dataset.enhanced==="true"){e.style.display="block";return}t.dataset.enhanced="true";var n=new Date().toISOString().split("T")[0],a=new Date(Date.now()+7*864e5).toISOString().split("T")[0];t.innerHTML='<input type="text" id="res-name" placeholder="Your Name" required><input type="tel" id="res-phone" placeholder="Phone Number (10 digits)" required maxlength="10"><input type="date" id="res-date" min="'+n+'" max="'+a+'" required><div class="res-time-slots" id="res-time-slots"></div><input type="hidden" id="res-time" value=""><div class="res-party-size"><label>Party Size</label><div class="party-btns" id="party-btns"></div></div><textarea id="res-requests" placeholder="Special Requests (Optional)" rows="2"></textarea><div id="res-msg" class="auth-msg"></div><button type="submit" class="cta-button">Confirm Reservation</button>';for(var o=document.getElementById("party-btns"),r=1;r<=12;r++){var i=document.createElement("button");i.type="button",i.className="party-btn",i.textContent=r,i.dataset.size=r,i.onclick=function(){document.querySelectorAll(".party-btn").forEach(function(l){l.classList.remove("active")}),this.classList.add("active")},o.appendChild(i)}document.getElementById("res-date").addEventListener("change",function(){yn(this.value)}),t.onsubmit=function(l){l.preventDefault(),je()};var s=N();s&&(document.getElementById("res-name").value=s.name||"",document.getElementById("res-phone").value=s.phone||""),e.style.display="block"}}function pn(){var e=document.getElementById("reservation-modal");e&&(e.style.display="none")}function yn(e){var t=document.getElementById("res-time-slots");if(t){t.innerHTML='<label>Select Time</label><div class="time-grid" id="time-grid"></div>';for(var n=document.getElementById("time-grid"),a=new Date(e).getDay(),o=a===0?12:11,r=a===5||a===6?22:21,i=o;i<=r;i++)for(var s=0;s<60&&!(i===r&&s>0);s+=30){var l=String(i).padStart(2,"0")+":"+String(s).padStart(2,"0"),c=(i>12?i-12:i)+":"+String(s).padStart(2,"0")+(i>=12?" PM":" AM"),f=document.createElement("button");f.type="button",f.className="time-slot-btn",f.textContent=c,f.dataset.time=l,f.onclick=function(){document.querySelectorAll(".time-slot-btn").forEach(function(g){g.classList.remove("active")}),this.classList.add("active"),document.getElementById("res-time").value=this.dataset.time},n.appendChild(f)}}}function je(){var e=document.getElementById("res-name").value.trim(),t=document.getElementById("res-phone").value.trim(),n=document.getElementById("res-date").value,a=document.getElementById("res-time").value,o=document.querySelector(".party-btn.active"),r=o?parseInt(o.dataset.size):0,i=document.getElementById("res-requests").value.trim(),s=document.getElementById("res-msg");if(!e||!t||!n||!a||!r){s.textContent="Please fill in all required fields.",s.className="auth-msg error";return}if(!/^\d{10}$/.test(t)){s.textContent="Please enter a valid 10-digit phone number.",s.className="auth-msg error";return}s.textContent="Booking your table...",s.className="auth-msg";var l=T();if(!l){s.textContent="Service unavailable. Please refresh and try again.",s.className="auth-msg error";return}var c={name:e,phone:t,date:n,time:a,partySize:r,requests:i,status:"pending",createdAt:new Date().toISOString()};l.collection("reservations").add(c).then(function(f){var g=document.getElementById("reservation-form"),b=new Date(n).toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"}),h=a,L=parseInt(a.split(":")[0]),C=a.split(":")[1];h=(L>12?L-12:L)+":"+C+(L>=12?" PM":" AM"),g.innerHTML='<div class="res-confirmed"><div class="res-check">&#10003;</div><h3>Reservation Confirmed!</h3><p class="res-id">Booking #'+f.id.slice(-6).toUpperCase()+'</p><div class="res-details"><p>'+b+" at "+h+"</p><p>"+r+" Guest"+(r>1?"s":"")+'</p></div><a class="whatsapp-btn" href="https://wa.me/919121004999?text='+encodeURIComponent("Hi Amogha! I have a reservation:\nDate: "+b+"\nTime: "+h+"\nGuests: "+r+"\nName: "+e+"\nBooking: #"+f.id.slice(-6).toUpperCase())+'" target="_blank">Confirm via WhatsApp</a><button class="cta-button" onclick="document.getElementById(\'reservation-modal\').style.display=\'none\'" style="margin-top:1rem">Done</button></div>'}).catch(function(){s.textContent="Failed to book. Please try again.",s.className="auth-msg error"})}function gn(){var e=document.querySelector(".cta-button.secondary");e&&e.textContent.indexOf("Reserve")!==-1&&(e.onclick=function(){ze()});var t=document.getElementById("reservation-form");t&&t.addEventListener("submit",n=>{n.preventDefault(),typeof showAuthToast=="function"&&showAuthToast("Reservation request received! We will confirm shortly."),n.target.reset();var a=document.getElementById("reservation-modal");a&&(a.style.display="none")})}Object.assign(window,{openReservationModal:ze,closeReservationModal:pn,submitReservation:je});function de(e){for(var t=$.length-1;t>=0;t--)if(e>=$[t].min)return $[t];return $[0]}function hn(e){var t=N();if(t){var n=Math.floor(e/10),a=new Date().toISOString().split("T")[0],o=t.orderDates||[];if(o[o.length-1]!==a&&o.push(a),o.length>=3){var r=o.slice(-3),i=new Date(r[0]),s=new Date(r[1]),l=new Date(r[2]),c=(s-i)/864e5,f=(l-s)/864e5;c===1&&f===1&&(n=n*2)}o.length>30&&(o=o.slice(-30));var g=(t.loyaltyPoints||0)+n,b=de(t.loyaltyPoints||0),h=de(g);t.loyaltyPoints=g,t.loyaltyTier=h.name,t.orderDates=o,Z(t);var L=T();L&&L.collection("users").doc(t.phone).update({loyaltyPoints:g,loyaltyTier:h.name,orderDates:o}).catch(function(B){console.error("Loyalty tier update error:",B)});var C=n>Math.floor(e/10)?" (2x Streak Bonus!)":"";k("+"+n+" loyalty points earned!"+C),h.name!==b.name&&setTimeout(function(){k("Congratulations! You are now "+h.icon+" "+h.name+" tier!"),typeof launchConfetti=="function"&&launchConfetti()},2e3),ke()}}function ke(){var e=document.getElementById("loyalty-widget");if(e){var t=N();if(!t){e.style.display="none";return}var n=t.loyaltyPoints||0,a=de(n);e.style.display="flex",e.innerHTML='<span class="loyalty-icon">'+a.icon+'</span><span class="loyalty-pts">'+n+" pts</span>",e.title=a.name+" Tier | "+n+" Points | Redeem 100pts = Rs.10 off",e.style.cursor="pointer",e.onclick=function(){$e()}}}function $e(){var e=N();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}for(var t=e.loyaltyPoints||0,n=de(t),a=null,o=0;o<$.length;o++)if($[o].min>t){a=$[o];break}var r=document.getElementById("loyalty-modal");r||(r=document.createElement("div"),r.id="loyalty-modal",r.className="modal",r.innerHTML='<div class="modal-content loyalty-modal-content"></div>',document.body.appendChild(r),r.addEventListener("click",function(c){c.target===r&&(r.style.display="none")}));var i=a?Math.min(100,(t-n.min)/(a.min-n.min)*100):100,s=a?'<p class="loyalty-next">'+(a.min-t)+" points to "+a.icon+" "+a.name+"</p>":'<p class="loyalty-next">You have reached the highest tier!</p>',l=Math.floor(t/100)*10;r.querySelector(".loyalty-modal-content").innerHTML='<span class="close" onclick="document.getElementById(\'loyalty-modal\').style.display=\'none\'">&times;</span><div class="loyalty-header"><div class="loyalty-tier-badge" style="background:'+n.color+'">'+n.icon+" "+n.name+"</div><h2>"+t+' Points</h2></div><div class="loyalty-progress-bar"><div class="loyalty-progress-fill" style="width:'+i+"%;background:"+n.color+'"></div></div>'+s+'<div class="loyalty-info"><div class="loyalty-info-row"><span>Redeemable Value</span><span>Rs.'+l+'</span></div><div class="loyalty-info-row"><span>Points per Rs.10 spent</span><span>1 point</span></div><div class="loyalty-info-row"><span>3-Day Streak Bonus</span><span>2x points</span></div></div><div class="loyalty-tiers-list">'+$.map(function(c){var f=c.name===n.name?" active":"";return'<div class="loyalty-tier-item'+f+'"><span>'+c.icon+" "+c.name+"</span><span>"+c.min+"+ pts</span></div>"}).join("")+"</div>",r.style.display="block"}function bn(){var e=document.getElementById("loyalty-modal");e&&(e.style.display="none")}function wn(){setTimeout(ke,500)}Object.assign(window,{openLoyaltyModal:$e,closeLoyaltyModal:bn,updateLoyaltyWidget:ke,awardLoyaltyPoints:hn,getLoyaltyTier:de});function Je(e){e.parentElement.querySelectorAll(".spice-level").forEach(n=>n.classList.remove("active")),e.classList.add("active")}window.selectSpice=Je;function En(){const e=document.getElementById("reviews-carousel");if(!e)return;let t=0,n;function a(){return window.innerWidth<=768?1:window.innerWidth<=1024?2:3}function o(){const c=e.querySelector(".review-card");if(!c)return 0;const f=window.getComputedStyle(c);return c.offsetWidth+parseFloat(f.marginLeft)+parseFloat(f.marginRight)}function r(){const c=o();e.style.transform="translateX(-".concat(t*c,"px)")}window.moveCarousel=function(c){const f=e.querySelectorAll(".review-card"),g=a(),b=Math.max(0,f.length-g);t=Math.max(0,Math.min(t+c,b)),r(),s()};function i(){const c=e.querySelectorAll(".review-card"),f=a(),g=Math.max(0,c.length-f);t++,t>g&&(t=0),r()}function s(){clearInterval(n),n=setInterval(i,4e3)}const l=document.querySelector(".reviews-carousel-wrapper");l&&(l.addEventListener("mouseenter",()=>{clearInterval(n)}),l.addEventListener("mouseleave",()=>{s()})),window.addEventListener("resize",()=>{t=0,r(),s()}),n=setInterval(i,4e3)}function Cn(){const e=document.querySelectorAll(".gallery-slide"),t=document.getElementById("gallery-dots");let n=0;t&&e.length>1&&e.forEach((o,r)=>{const i=document.createElement("button");i.className="gallery-dot"+(r===0?" active":""),i.addEventListener("click",()=>a(r)),t.appendChild(i)});function a(o){e.forEach(i=>i.classList.remove("active")),e[o]&&e[o].classList.add("active"),n=o,document.querySelectorAll(".gallery-dot").forEach((i,s)=>i.classList.toggle("active",s===o))}window.moveGallerySlide=function(o){if(e.length===0)return;let r=(n+o+e.length)%e.length;a(r)},e.length>1&&setInterval(()=>{window.moveGallerySlide(1)},5e3)}function Ln(){const e=document.querySelectorAll(".gallery-item img"),t=document.querySelectorAll(".gallery-slide-item img"),n=[...e,...t],a=document.getElementById("lightbox"),o=document.getElementById("lightbox-img");let r=0;n.forEach((i,s)=>{i.addEventListener("click",()=>{r=s,o.src=i.src,a.classList.add("active"),X()})}),window.closeLightbox=function(){a.classList.remove("active"),P()},window.navigateLightbox=function(i){r=(r+i+n.length)%n.length,o.src=n[r].src},document.addEventListener("keydown",i=>{a.classList.contains("active")&&(i.key==="Escape"&&window.closeLightbox(),i.key==="ArrowLeft"&&window.navigateLightbox(-1),i.key==="ArrowRight"&&window.navigateLightbox(1))})}function In(e){if(e){var t=document.getElementById("video-lightbox"),n=document.getElementById("lightbox-video");!t||!n||(n.src=e,t.style.display="flex",n.play())}}function Sn(){var e=document.getElementById("video-lightbox"),t=document.getElementById("lightbox-video");e&&(e.style.display="none"),t&&(t.pause(),t.src="")}function Xe(e){var t=N();if(t){var n=document.getElementById("review-modal");n||(n=document.createElement("div"),n.id="review-modal",n.className="modal",n.innerHTML='<div class="modal-content review-modal-content"></div>',document.body.appendChild(n),n.addEventListener("click",function(r){r.target===n&&(n.style.display="none")}));var a=e||I.map(function(r){return{name:r.name}}),o="<span class=\"close\" onclick=\"document.getElementById('review-modal').style.display='none'\">&times;</span>";o+='<h2>Rate Your Order</h2><p class="review-subtitle">Help us serve you better!</p>',o+='<div id="review-items">',a.forEach(function(r,i){o+='<div class="review-item" data-item="'+r.name+'"><span class="review-item-name">'+r.name+'</span><div class="review-stars" data-idx="'+i+'">';for(var s=1;s<=5;s++)o+='<span class="review-star" data-star="'+s+'" onclick="setReviewStar(this, '+i+", "+s+')">&#9734;</span>';o+="</div></div>"}),o+="</div>",o+='<textarea id="review-text" class="review-textarea" placeholder="Share your thoughts (optional)" maxlength="200"></textarea>',o+='<button class="cta-button" onclick="submitReviews()">Submit Review</button>',n.querySelector(".review-modal-content").innerHTML=o,n.style.display="block",window._reviewRatings=new Array(a.length).fill(0),window._reviewItems=a}}function Bn(e,t,n){window._reviewRatings[t]=n;var a=e.parentElement;a.querySelectorAll(".review-star").forEach(function(o,r){o.innerHTML=r<n?"&#9733;":"&#9734;",o.classList.toggle("active",r<n)})}function xn(){var e=N();if(e){var t=document.getElementById("review-text").value.trim(),n=T(),a=n.batch(),o=!1;if(window._reviewItems.forEach(function(r,i){var s=window._reviewRatings[i];if(s>0){o=!0;var l=n.collection("reviews").doc();a.set(l,{itemName:r.name,rating:s,text:t,userName:e.name,userPhone:e.phone,createdAt:new Date().toISOString()})}}),!o){k("Please rate at least one item");return}a.commit().then(function(){document.getElementById("review-modal").style.display="none",k("Thank you for your review!"),setTimeout(function(){typeof window.loadMenuRatings=="function"&&window.loadMenuRatings()},1e3)}).catch(function(){k("Failed to submit review. Please try again.")})}}function kn(e){setTimeout(function(){N()&&Xe(e)},6e4)}function Mn(){var e={biryanis:[{name:"Veg Dum Biryani",price:179},{name:"Paneer Biryani",price:219},{name:"Egg Biryani",price:189},{name:"Chicken Fry Piece Biryani",price:219},{name:"Chicken 65 Biryani",price:249},{name:"Boneless Chicken Biryani",price:219}],starters:[{name:"Veg Manchurian",price:169},{name:"Paneer 65",price:189},{name:"Chicken 65",price:200},{name:"Chicken Hot Wings",price:220},{name:"Chilli Chicken",price:200}],drinks:[{name:"Tea",price:30},{name:"Coffee",price:40},{name:"Lassi",price:50},{name:"Buttermilk",price:35},{name:"Fresh Lime Soda",price:45}]},t={biryani:null,starter:null,drink:null},n=.15;function a(s,l,c){var f=document.getElementById(s);f&&(f.innerHTML=l.map(function(g){return'<button class="combo-option" data-category="'+c+'" data-name="'+g.name+'" data-price="'+g.price+'"><span class="combo-opt-name">'+g.name+'</span><span class="combo-opt-price">‚Çπ'+g.price+"</span></button>"}).join(""))}function o(){a("combo-biryanis",e.biryanis,"biryani"),a("combo-starters",e.starters,"starter"),a("combo-drinks",e.drinks,"drink")}document.addEventListener("click",function(s){var l=s.target.closest(".combo-option");if(l){var c=l.dataset.category,f=l.dataset.name,g=parseInt(l.dataset.price);l.parentElement.querySelectorAll(".combo-option").forEach(function(b){b.classList.remove("selected")}),l.classList.add("selected"),t[c]={name:f,price:g},r()}});function r(){var s=document.getElementById("combo-selected"),l=document.getElementById("combo-original"),c=document.getElementById("combo-total"),f=document.getElementById("combo-add-btn");if(s){var g=[],b=0;if(t.biryani&&(g.push(t.biryani.name),b+=t.biryani.price),t.starter&&(g.push(t.starter.name),b+=t.starter.price),t.drink&&(g.push(t.drink.name),b+=t.drink.price),s.textContent=g.length>0?g.join(" + "):"Select items above",b>0){var h=Math.round(b*(1-n));l.textContent="‚Çπ"+b,l.style.textDecoration="line-through",c.textContent="‚Çπ"+h}else l.textContent="",c.textContent="";f&&(f.disabled=!(t.biryani&&t.starter&&t.drink))}}window.openComboModal=function(){o(),t={biryani:null,starter:null,drink:null},r();var s=document.getElementById("combo-modal");s&&(s.style.display="block",X())},window.closeComboModal=function(){var s=document.getElementById("combo-modal");s&&(s.style.display="none",P())};var i=document.getElementById("combo-modal");i&&i.addEventListener("click",function(s){s.target===i&&window.closeComboModal()}),window.addComboToCart=function(){if(!(!t.biryani||!t.starter||!t.drink)){var s=t.biryani.price+t.starter.price+t.drink.price,l=Math.round(s*(1-n)),c="Combo: "+t.biryani.name+" + "+t.starter.name+" + "+t.drink.name,f=I.find(function(g){return g.name===c});f?f.quantity++:I.push({name:c,price:l,quantity:1}),K(),ee(),ne(),ge(),k("Combo added! You saved ‚Çπ"+(s-l)),window.closeComboModal()}}}function Ke(){for(var e=new Date,t=e.getDay(),n=e.getHours(),a=0;a<Ne.length;a++){var o=Ne[a];if(o.days.indexOf(t)!==-1&&n>=o.startHour&&n<o.endHour)return o}return null}function Oe(){var e=Ke(),t=document.getElementById("happy-hour-banner");if(!e){t&&(t.style.display="none"),document.querySelectorAll(".hh-price").forEach(function(s){s.remove()}),document.querySelectorAll(".price.hh-crossed").forEach(function(s){s.classList.remove("hh-crossed")});return}if(!t){t=document.createElement("div"),t.id="happy-hour-banner",t.className="happy-hour-banner";var n=document.getElementById("menu");n&&n.insertBefore(t,n.firstChild)}var a=new Date;a.setHours(e.endHour,0,0,0);var o=Math.max(0,a-new Date),r=Math.floor(o/6e4),i=Math.floor(o%6e4/1e3);t.innerHTML='<span class="hh-icon">üî•</span> <strong class="hh-text">'+e.label+'</strong> <span class="hh-timer">Ends in '+r+"m "+i+"s</span>",t.style.display="flex",document.querySelectorAll(".menu-item-card").forEach(function(s){var l=s.querySelector(".price");if(l){var c=s.closest(".menu-category");if(c){var f=(c.id||"").toLowerCase(),g=e.categories.indexOf("all")!==-1;if(g||e.categories.forEach(function(B){f.indexOf(B)!==-1&&(g=!0)}),!!g){var b=parseInt(l.textContent.replace(/[^\d]/g,"")),h=Math.round(b*(1-e.discount/100));l.classList.add("hh-crossed");var L=s.querySelector(".hh-price");if(L)L.textContent="‚Çπ"+h;else{var C=document.createElement("span");C.className="hh-price",C.textContent="‚Çπ"+h,l.after(C)}}}}})}function Qe(){if(I.length===0)return[];var e={},t=I.map(function(a){return a.name});t.forEach(function(a){var o=pt[a]||[];o.forEach(function(r){t.indexOf(r)===-1&&pe[r]&&(e[r]=(e[r]||0)+1)})});var n=Object.keys(e).sort(function(a,o){return e[o]-e[a]});return n.slice(0,4).map(function(a){return{name:a,price:pe[a]}})}function Me(){var e=document.getElementById("cart-recommendations");if(e){var t=Qe();if(t.length===0){e.style.display="none";return}var n='<p class="rec-title">You might also like:</p><div class="rec-items">';t.forEach(function(a){n+='<button class="rec-item" onclick="addToCart(\''+a.name.replace(/'/g,"\\'")+"', "+a.price+'); displayCart(); showRecommendations();"><span class="rec-name">'+a.name+'</span><span class="rec-price">‚Çπ'+a.price+'</span><span class="rec-add">+</span></button>'}),n+="</div>",e.innerHTML=n,e.style.display="block"}}var oe=!1,Y=null;function Ze(){var e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){Y=new e,Y.continuous=!1,Y.interimResults=!0,Y.lang="en-IN",Y.onresult=function(n){for(var a="",o=n.resultIndex;o<n.results.length;o++)a+=n.results[o][0].transcript;Tn(a),n.results[n.resultIndex].isFinal&&qn(a)},Y.onend=function(){oe&&(oe=!1,re())},Y.onerror=function(){oe=!1,re()};var t=document.createElement("button");t.id="voice-order-btn",t.className="voice-order-btn",t.innerHTML='<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>',t.title="Voice Order",t.onclick=et,document.body.appendChild(t)}}function et(){oe?(Y.stop(),oe=!1,re()):(oe=!0,tt(),Y.start())}function tt(){var e=document.getElementById("voice-overlay");e||(e=document.createElement("div"),e.id="voice-overlay",e.className="voice-overlay",e.innerHTML='<div class="voice-content"><div class="voice-waves"><span></span><span></span><span></span><span></span><span></span></div><p class="voice-status">Listening...</p><p class="voice-transcript" id="voice-transcript"></p><p class="voice-hint">Say "Add chicken biryani" or "2 butter naan"</p><button class="voice-close" onclick="toggleVoice()">Cancel</button></div>',document.body.appendChild(e)),e.classList.add("active"),document.getElementById("voice-transcript").textContent=""}function re(){var e=document.getElementById("voice-overlay");e&&e.classList.remove("active")}function Tn(e){var t=document.getElementById("voice-transcript");t&&(t.textContent=e)}function qn(e){e=e.toLowerCase().trim();var t=e.match(/^(?:add\s+)?(\d+)\s+/),n=t?parseInt(t[1]):1,a=e.replace(/^(?:add\s+)?(\d+\s+)?/,"").replace(/^add\s+/,""),o=null,r=0;if(Object.keys(pe).forEach(function(s){var l=s.toLowerCase(),c=0;if(l===a)c=100;else if(l.indexOf(a)!==-1)c=80;else if(a.indexOf(l)!==-1)c=70;else{var f=a.split(" ");f.forEach(function(g){g.length>2&&l.indexOf(g)!==-1&&(c+=20)})}c>r&&(r=c,o=s)}),o&&r>=20){for(var i=0;i<n;i++)ie(o,pe[o]);k("Added "+n+"x "+o+" to cart"),re()}else e.indexOf("checkout")!==-1||e.indexOf("check out")!==-1?(typeof window.checkout=="function"&&window.checkout(),re()):e.indexOf("clear")!==-1?(typeof window.clearCart=="function"&&window.clearCart(),re()):k('Could not find: "'+a+'". Try again.')}var le=W("amoghaLang")||"en";function Nn(e){le=e,z("amoghaLang",e),Te(),document.querySelectorAll(".lang-btn").forEach(function(t){t.classList.toggle("active",t.dataset.lang===e)})}function Te(){var e=Ae[le]||Ae.en;document.querySelectorAll("[data-i18n]").forEach(function(t){var n=t.dataset.i18n;e[n]&&((t.tagName==="INPUT"||t.tagName==="TEXTAREA")&&t.placeholder!==void 0?t.placeholder=e[n]:t.textContent=e[n])})}function nt(e){if(!e)return"";var t=(e.name||"USER").replace(/[^A-Za-z]/g,"").toUpperCase().slice(0,4),n=(e.phone||"0000").slice(-4);return t+n}function An(){var e=N();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=e.referralCode||nt(e);if(!e.referralCode){e.referralCode=t,Z(e);var n=T();n&&n.collection("users").doc(e.phone).update({referralCode:t}).catch(function(r){console.error("Referral code save error:",r)})}var a=document.getElementById("referral-modal");a||(a=document.createElement("div"),a.id="referral-modal",a.className="modal",a.innerHTML='<div class="modal-content referral-content"></div>',document.body.appendChild(a),a.addEventListener("click",function(r){r.target===a&&(a.style.display="none")}));var o="Order from Amogha Cafe & get Rs.50 off your first order! Use my referral code: "+t+" when signing up. Order at "+window.location.origin;a.querySelector(".referral-content").innerHTML='<span class="close" onclick="document.getElementById(\'referral-modal\').style.display=\'none\'">&times;</span><h2>Refer a Friend</h2><p class="referral-subtitle">Share your code and both get rewarded!</p><div class="referral-code-box"><span class="referral-code">'+t+'</span><button class="referral-copy" onclick="safeCopy(\''+t+'\',this)">Copy</button></div><div class="referral-rewards"><div class="referral-reward"><span class="referral-reward-icon">üéÅ</span><span>Your friend gets <strong>Rs.50 off</strong> first order</span></div><div class="referral-reward"><span class="referral-reward-icon">‚≠ê</span><span>You get <strong>100 loyalty points</strong></span></div></div><a class="whatsapp-btn referral-share" href="https://wa.me/?text='+encodeURIComponent(o)+'" target="_blank">Share via WhatsApp</a>',a.style.display="block"}function Pn(){var e=document.getElementById("referral-modal");e&&(e.style.display="none")}function On(e){if(e){var t=T();t&&(e=e.toUpperCase().trim(),t.collection("users").where("referralCode","==",e).limit(1).get().then(function(n){if(!n.empty){var a=n.docs[0],o=a.data(),r=N();!r||o.phone===r.phone||(t.collection("referrals").add({referrerPhone:o.phone,refereePhone:r.phone,redeemed:!1,createdAt:new Date().toISOString()}).catch(function(i){console.error("Referral save error:",i)}),r.referralDiscount=50,Z(r),k("Referral applied! Rs.50 off your first order!"))}}))}}function Rn(){var e=N();if(!e){typeof window.openAuthModal=="function"&&window.openAuthModal();return}var t=document.getElementById("myorders-modal");t||(t=document.createElement("div"),t.id="myorders-modal",t.className="modal",t.innerHTML='<div class="modal-content myorders-content"><span class="close" onclick="document.getElementById(\'myorders-modal\').style.display=\'none\'">&times;</span><h2>My Orders</h2><div id="myorders-list" class="myorders-list"><p>Loading...</p></div></div>',document.body.appendChild(t),t.addEventListener("click",function(o){o.target===t&&(t.style.display="none")})),t.style.display="block";var n=document.getElementById("myorders-list");n.innerHTML='<p style="text-align:center;color:#a09080">Loading orders...</p>';var a=T();if(!a){n.innerHTML='<p style="text-align:center;color:#a09080;padding:2rem">Service unavailable. Please refresh.</p>';return}a.collection("orders").where("userId","==",e.phone).orderBy("createdAt","desc").limit(10).get().then(function(o){if(o.empty){n.innerHTML='<p style="text-align:center;color:#a09080;padding:2rem">No orders yet. Place your first order!</p>';return}var r="";o.forEach(function(i){var s=i.data(),l=s.createdAt?new Date(s.createdAt):new Date,c=l.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),f={pending:"#f39c12",confirmed:"#3498db",preparing:"#e67e22",delivered:"#27ae60",cancelled:"#e74c3c"},g=f[s.status]||"#999",b=(s.items||[]).map(function(h){return h.name+" x"+h.qty}).join(", ");r+='<div class="myorder-card"><div class="myorder-header"><span class="myorder-date">'+c+'</span><span class="myorder-status" style="color:'+g+'">'+(s.status||"pending").toUpperCase()+'</span></div><p class="myorder-items">'+b+'</p><div class="myorder-footer"><span class="myorder-total">Rs.'+(s.total||0)+'</span><button class="myorder-reorder-btn" onclick="reorderFromHistory(\''+i.id+"')\">Order Again</button></div></div>"}),n.innerHTML=r,z("amoghaMyOrders",JSON.stringify(o.docs.map(function(i){return{id:i.id,data:i.data()}})))}).catch(function(o){console.error("Load orders error:",o);var r=W("amoghaMyOrders");if(r){var i=JSON.parse(r),s="";i.forEach(function(l){var c=l.data,f=c.createdAt?new Date(c.createdAt):new Date,g=f.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),b=(c.items||[]).map(function(h){return h.name+" x"+h.qty}).join(", ");s+='<div class="myorder-card"><div class="myorder-header"><span class="myorder-date">'+g+'</span><span class="myorder-status">'+(c.status||"").toUpperCase()+'</span></div><p class="myorder-items">'+b+'</p><div class="myorder-footer"><span class="myorder-total">Rs.'+(c.total||0)+'</span><button class="myorder-reorder-btn" onclick="reorderFromHistory(\''+l.id+"')\">Order Again</button></div></div>"}),n.innerHTML=s}else n.innerHTML='<p style="text-align:center;color:#e74c3c">Failed to load orders. Please try again.</p>'})}function Dn(){var e=document.getElementById("myorders-modal");e&&(e.style.display="none")}function Hn(e){var t=W("amoghaMyOrders");if(t){var n=JSON.parse(t),a=n.find(function(r){return r.id===e});if(a&&a.data.items){a.data.items.forEach(function(r){for(var i=0;i<r.qty;i++)ie(r.name,r.price)}),document.getElementById("myorders-modal").style.display="none",k("Items added to cart! Review and checkout.");return}}var o=T();o.collection("orders").doc(e).get().then(function(r){r.exists&&r.data().items&&(r.data().items.forEach(function(i){for(var s=0;s<i.qty;s++)ie(i.name,i.price)}),document.getElementById("myorders-modal").style.display="none",k("Items added to cart! Review and checkout."))})}function Fn(){var e=document.getElementById("schedule-order-check"),t=document.getElementById("schedule-fields"),n=document.getElementById("schedule-date"),a=document.getElementById("schedule-time");if(!e||!t||!n||!a)return;e.addEventListener("change",function(){t.style.display=this.checked?"block":"none",this.checked&&(o(),r())});function o(){var i=new Date,s=i.toISOString().split("T")[0],l=new Date(i);l.setDate(l.getDate()+3);var c=l.toISOString().split("T")[0];n.min=s,n.max=c,n.value=s}function r(){var i=["11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM"];a.innerHTML='<option value="">Select Time</option>',i.forEach(function(s){a.innerHTML+='<option value="'+s+'">'+s+"</option>"})}window.getScheduleInfo=function(){return e.checked?{date:n.value,time:a.value}:null}}function _n(){En(),Cn(),Ln(),Mn(),Oe(),setInterval(Oe,6e4),setTimeout(Ze,1e3),setTimeout(function(){var t=document.querySelector(".nav-links");if(t){var n=document.createElement("li");n.className="lang-switcher",n.innerHTML='<button class="lang-btn'+(le==="en"?" active":"")+'" data-lang="en" onclick="switchLanguage(\'en\')">EN</button><button class="lang-btn'+(le==="hi"?" active":"")+'" data-lang="hi" onclick="switchLanguage(\'hi\')">‡§π‡§ø</button><button class="lang-btn'+(le==="te"?" active":"")+'" data-lang="te" onclick="switchLanguage(\'te\')">‡∞§‡±Ü</button>';var a=t.querySelector(".theme-toggle");a?t.insertBefore(n,a.parentElement):t.appendChild(n),Te()}},500),setTimeout(function(){typeof window.loadMenuRatings=="function"&&window.loadMenuRatings()},2e3),Fn();var e=window.displayCart;typeof e=="function"&&(window.displayCart=function(){e(),Me()})}Object.assign(window,{selectSpice:Je,moveCarousel:window.moveCarousel,moveGallerySlide:window.moveGallerySlide,closeLightbox:window.closeLightbox,navigateLightbox:window.navigateLightbox,openVideoLightbox:In,closeVideoLightbox:Sn,openReviewModal:Xe,setReviewStar:Bn,submitReviews:xn,scheduleReviewPrompt:kn,openComboModal:window.openComboModal,closeComboModal:window.closeComboModal,addComboToCart:window.addComboToCart,getActiveHappyHour:Ke,getRecommendations:Qe,showRecommendations:Me,initVoiceOrdering:Ze,toggleVoice:et,showVoiceOverlay:tt,switchLanguage:Nn,applyTranslations:Te,openReferralModal:An,closeReferralModal:Pn,generateReferralCode:nt,applyReferralAtSignup:On,openMyOrders:Rn,closeMyOrders:Dn,reorderFromHistory:Hn,loadDailySpecial:at,initComboBuilder:ot});function Un(){var e=null;try{e=JSON.parse(localStorage.getItem("amoghaMyOrders"))}catch(i){}if(!(!e||!e.length)){var t=e[0].data;if(!(!t||!t.items||!t.items.length)){if(t.createdAt){var n=(Date.now()-new Date(t.createdAt).getTime())/864e5;if(n<1)return}var a=t.items.slice(0,2).map(function(i){return i.name}).join(", ");t.items.length>2&&(a+=" +"+(t.items.length-2)+" more");var o=document.createElement("div");o.className="reorder-toast",o.innerHTML='<div class="reorder-toast-text"><div class="reorder-toast-title">Welcome back! üëã</div><div class="reorder-toast-sub">'+a+'</div></div><button class="reorder-toast-btn" id="reorder-toast-btn">Order Again</button><button class="reorder-toast-close" id="reorder-toast-close">&times;</button>',document.body.appendChild(o),setTimeout(function(){o.classList.add("show")},100);var r=e[0].id;o.querySelector("#reorder-toast-btn").addEventListener("click",function(){typeof window.reorderFromHistory=="function"&&window.reorderFromHistory(r),o.classList.remove("show"),setTimeout(function(){o.remove()},400)}),o.querySelector("#reorder-toast-close").addEventListener("click",function(){o.classList.remove("show"),setTimeout(function(){o.remove()},400)}),setTimeout(function(){o.classList.remove("show"),setTimeout(function(){o.parentNode&&o.remove()},400)},8e3)}}}function at(){var e=document.getElementById("daily-special-section");if(e){var t=null;try{t=window.db}catch(n){}if(!t){e.style.display="none";return}t.collection("settings").doc("dailySpecial").get().then(function(n){if(!n.exists||!n.data().active){e.style.display="none";return}var a=n.data();e.style.display="";var o=e.querySelector(".daily-special-img"),r=e.querySelector(".daily-special-img-placeholder"),i=e.querySelector(".daily-special-title"),s=e.querySelector(".daily-special-desc"),l=e.querySelector(".daily-special-price"),c=e.querySelector(".daily-special-add-btn");a.imageUrl&&o&&(o.src=a.imageUrl,o.style.display="block",r&&(r.style.display="none")),i&&(i.textContent=a.title||"Chef's Special"),s&&(s.textContent=a.description||""),l&&(l.innerHTML="&#8377;"+(a.price||"")),c&&a.title&&(c.dataset.item=a.title,c.dataset.price=a.price||0);function f(){var g=new Date,b=new Date;b.setHours(24,0,0,0);var h=Math.max(0,b-g),L=Math.floor(h/36e5),C=Math.floor(h%36e5/6e4),B=Math.floor(h%6e4/1e3),_=e.querySelector(".cd-h"),x=e.querySelector(".cd-m"),O=e.querySelector(".cd-s");_&&(_.textContent=String(L).padStart(2,"0")),x&&(x.textContent=String(C).padStart(2,"0")),O&&(O.textContent=String(B).padStart(2,"0"))}f(),setInterval(f,1e3)}).catch(function(){e.style.display="none"})}}function ot(){var e=document.getElementById("combo-builder-section");if(!e)return;var t={starter:["Veg Manchurian","Paneer 65","Chicken 65","Chicken Hot Wings","Veg Spring Rolls","Chicken Lollipop","Paneer Tikka","Chicken Seekh Kebab","Tandoori Chicken"],main:["Paneer Butter Masala","Dal Tadka","Butter Chicken","Chicken Curry","Mutton Curry","Gongura Chicken","Veg Dum Biryani","Chicken Dum Biryani","Mutton Dum Biryani"],bread:["Butter Naan","Garlic Naan","Tandoori Roti","Butter Roti","Laccha Paratha"],drink:["Tea","Coffee","Lassi","Buttermilk","Fresh Lime Soda","Hot Chocolate"]},n={};try{document.querySelectorAll(".menu-item-card[data-id]").forEach(function(s){var l=s.querySelector(".add-to-cart");l&&(n[s.dataset.id]=parseFloat(l.dataset.price)||0)})}catch(s){}var a={"Veg Manchurian":169,"Paneer 65":189,"Chicken 65":200,"Chicken Hot Wings":220,"Veg Spring Rolls":149,"Chicken Lollipop":230,"Paneer Tikka":209,"Chicken Seekh Kebab":229,"Tandoori Chicken":269,"Paneer Butter Masala":199,"Dal Tadka":149,"Butter Chicken":249,"Chicken Curry":219,"Mutton Curry":319,"Gongura Chicken":239,"Veg Dum Biryani":199,"Chicken Dum Biryani":249,"Mutton Dum Biryani":349,"Butter Naan":40,"Garlic Naan":50,"Tandoori Roti":30,"Butter Roti":35,"Laccha Paratha":45,Tea:30,Coffee:40,Lassi:50,Buttermilk:35,"Fresh Lime Soda":45,"Hot Chocolate":60};Object.keys(a).forEach(function(s){n[s]||(n[s]=a[s])});function o(s,l){var c=e.querySelector("#"+s);c&&(c.innerHTML='<option value="">‚Äî Choose ‚Äî</option>'+l.map(function(f){var g=n[f]||0;return'<option value="'+f+'" data-price="'+g+'">'+f+" (‚Çπ"+g+")</option>"}).join(""))}o("combo-starter",t.starter),o("combo-main",t.main),o("combo-bread",t.bread),o("combo-drink",t.drink);function r(){var s=0;["combo-starter","combo-main","combo-bread","combo-drink"].forEach(function(L){var C=e.querySelector("#"+L);if(C&&C.value){var B=C.options[C.selectedIndex];s+=parseFloat(B.dataset.price)||0}});var l=Math.round(s*.8),c=s-l,f=e.querySelector(".combo-original"),g=e.querySelector(".combo-discounted"),b=e.querySelector(".combo-savings"),h=e.querySelector(".combo-add-btn");f&&(f.textContent=s>0?"‚Çπ"+s:""),g&&(g.textContent=s>0?"‚Çπ"+l:"‚Çπ0"),b&&(b.textContent=s>0?"Save ‚Çπ"+c:""),h&&(h.disabled=s===0)}e.querySelectorAll("select").forEach(function(s){s.addEventListener("change",r)}),r();var i=e.querySelector(".combo-add-btn");i&&i.addEventListener("click",function(){var s=0;["combo-starter","combo-main","combo-bread","combo-drink"].forEach(function(l){var c=e.querySelector("#"+l);if(!(!c||!c.value)){var f=c.options[c.selectedIndex],g=parseFloat(f.dataset.price)||0,b=Math.round(g*.8);typeof window.finalizeAddToCart=="function"&&window.finalizeAddToCart(c.value,b,"medium",[]),s++}}),s>0&&(i.textContent="‚úì Added to Cart!",i.style.background="linear-gradient(135deg,#27ae60,#2ecc71)",setTimeout(function(){i.textContent="Add Combo to Cart",i.style.background=""},2e3))})}function rt(){const e=T();if(!e)return;const t=document.querySelector(".bar-ticker-track");t&&e.collection("orders").orderBy("createdAt","desc").limit(6).get().then(function(n){const a=[];if(n.forEach(function(i){const s=i.data(),l=s.items&&s.items[0]&&s.items[0].name?s.items[0].name:null,f=(s.customerName||s.userName||"").split(" ")[0]||"Someone";l&&a.push({firstName:f,itemName:l})}),a.length<3)return;function o(i,s){return'<div class="bar-ticker-item"><span>'.concat(i,"</span><span>").concat(s,'</span></div><span class="bar-dot"></span>')}const r=a.map(function(i){return o("üçõ","".concat(i.firstName," just ordered ").concat(i.itemName))}).join("");t.innerHTML=r+r}).catch(function(){})}window.initLiveOrderTicker=rt;function Wn(){const e=document.getElementById("catering-modal");e&&(e.classList.add("active"),X())}window.openCateringModal=Wn;function it(){const e=document.getElementById("catering-modal");e&&(e.classList.remove("active"),P())}window.closeCateringModal=it;function Gn(){var c,f,g,b,h,L;const e=T(),t=(c=document.getElementById("catering-name"))==null?void 0:c.value.trim(),n=(f=document.getElementById("catering-phone"))==null?void 0:f.value.trim(),a=(g=document.getElementById("catering-event"))==null?void 0:g.value,o=(b=document.getElementById("catering-guests"))==null?void 0:b.value,r=(h=document.getElementById("catering-date"))==null?void 0:h.value,i=(L=document.getElementById("catering-message"))==null?void 0:L.value.trim(),s=document.getElementById("catering-submit-btn");if(!t||!n||!a||!o||!r){alert("Please fill in all required fields.");return}s&&(s.disabled=!0,s.textContent="Submitting‚Ä¶");const l={name:t,phone:n,eventType:a,guestCount:parseInt(o)||0,date:r,message:i||"",createdAt:new Date().toISOString()};(e?e.collection("cateringInquiries").add(l):Promise.reject("no db")).then(function(){it();const C=document.createElement("div");C.className="catering-toast",C.textContent="‚úÖ Catering enquiry received! We'll contact you within 24 hours.",document.body.appendChild(C),setTimeout(function(){C.classList.add("show")},10),setTimeout(function(){C.classList.remove("show"),setTimeout(function(){C.remove()},400)},4e3)}).catch(function(){alert("Could not submit. Please call us at +91 91210 04999."),s&&(s.disabled=!1,s.textContent="Submit Enquiry")})}window.submitCateringEnquiry=Gn;dn();cn();rn();sn();Ct();St();It();At();ge();Dt();on();wn();vn();gn();_n();at();ot();rt();setTimeout(function(){var e=null;try{e=JSON.parse(localStorage.getItem("amoghaUser"))}catch(t){}e&&Un()},2e3);Se();window.displayCart=function(){me(),Me()};window.loadMenuRatings=Zt;export{Vn as __vite_legacy_guard};
//# sourceMappingURL=script.js.map
